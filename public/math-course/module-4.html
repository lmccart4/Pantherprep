<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Module 4: Functions & Properties ‚Äî SAT Math ‚Äî PantherPrep</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=Source+Sans+3:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root{--ink:#f0f0f0;--paper:#121212;--accent:#C8102E;--accent-light:rgba(200,16,46,.15);--border:#2a2a2a;--muted:#999;--surface:#1a1a1a;--math:#60a5fa;--math-bg:rgba(96,165,250,.1);--algebra:#34d399;--algebra-bg:rgba(52,211,153,.1);--advanced:#a78bfa;--adv-bg:rgba(167,139,250,.1);--psda:#fbbf24;--geotrig:#f87171;--correct:#22c55e;--correct-bg:rgba(34,197,94,.12);--wrong:#ef4444;--wrong-bg:rgba(239,68,68,.12);--danger:#ef4444;--danger-bg:rgba(239,68,68,.08)}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Source Sans 3',sans-serif;background:var(--paper);color:var(--ink);line-height:1.65;overflow-x:hidden}
.top-stripe{height:4px;background:linear-gradient(90deg,#C8102E 0%,#C8102E 50%,#fff 50%,#fff 100%);position:fixed;top:0;left:0;right:0;z-index:100}

/* ‚îÄ‚îÄ Screen System ‚îÄ‚îÄ */
.screen{display:none;opacity:0;transition:opacity .4s ease;min-height:100vh}
.screen.active{display:block;opacity:1}
.screen.fade-in{animation:fadeIn .4s ease forwards}
.screen.fade-out{animation:fadeOut .3s ease forwards}
@keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeOut{from{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-12px)}}

/* ‚îÄ‚îÄ Progress Dots ‚îÄ‚îÄ */
.screen-progress{position:fixed;top:12px;left:50%;transform:translateX(-50%);display:flex;gap:8px;z-index:101;padding:6px 14px;background:rgba(18,18,18,.85);backdrop-filter:blur(8px);border-radius:20px;border:1px solid var(--border)}
.screen-dot{width:8px;height:8px;border-radius:50%;background:var(--border);transition:all .3s;cursor:pointer}
.screen-dot.completed{background:var(--advanced)}
.screen-dot.current{background:var(--accent);box-shadow:0 0 8px rgba(200,16,46,.5);transform:scale(1.25)}
.screen-dot:hover{transform:scale(1.3)}

/* ‚îÄ‚îÄ Container ‚îÄ‚îÄ */
.container{max-width:800px;margin:0 auto;padding:20px 20px 60px}

/* ‚îÄ‚îÄ Welcome Screen ‚îÄ‚îÄ */
.welcome-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:40px 20px;text-align:center}
.welcome-badge{display:inline-block;background:var(--advanced);color:#fff;font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:5px 14px;border-radius:16px;margin-bottom:18px}
.welcome-screen h1{font-family:'Cormorant Garamond',serif;font-size:clamp(2rem,5vw,3rem);font-weight:700;margin-bottom:8px;max-width:600px}
.welcome-sub{color:var(--muted);font-size:1.05rem;max-width:500px;margin:0 auto 32px}
.welcome-meta{display:flex;gap:24px;justify-content:center;margin-bottom:36px;font-size:.85rem;color:var(--muted)}
.preview-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;max-width:600px;width:100%;margin-bottom:40px}
.preview-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px 14px;text-align:left;transition:all .2s}
.preview-card:hover{border-color:var(--advanced);transform:translateY(-2px)}
.preview-icon{font-size:1.4rem;margin-bottom:8px}
.preview-title{font-size:.82rem;font-weight:700;margin-bottom:3px}
.preview-desc{font-size:.72rem;color:var(--muted);line-height:1.4}
.start-btn{padding:14px 36px;background:var(--advanced);color:#fff;border:none;border-radius:10px;font-size:1rem;font-weight:700;cursor:pointer;transition:all .2s;font-family:'Source Sans 3',sans-serif}
.start-btn:hover{filter:brightness(1.15);transform:translateY(-1px);box-shadow:0 6px 20px rgba(167,139,250,.3)}

/* ‚îÄ‚îÄ Retrieval Warm-Up ‚îÄ‚îÄ */
.warmup-container{max-width:600px;margin:0 auto;padding:60px 20px}
.warmup-header{text-align:center;margin-bottom:32px}
.warmup-badge{display:inline-block;background:var(--advanced);color:#fff;font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:4px 12px;border-radius:12px;margin-bottom:12px}
.warmup-dots{display:flex;gap:8px;justify-content:center;margin-top:16px}
.warmup-dot{width:10px;height:10px;border-radius:50%;background:var(--border);transition:all .3s}
.warmup-dot.done-correct{background:var(--correct)}
.warmup-dot.done-wrong{background:var(--wrong)}
.warmup-dot.active{background:var(--advanced);box-shadow:0 0 8px rgba(167,139,250,.4)}
.warmup-q{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:24px;margin-bottom:16px}
.warmup-q .source-tag{font-size:.7rem;color:var(--advanced);font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:8px}
.warmup-q .q-text{font-size:.95rem;line-height:1.7;margin-bottom:14px}
.warmup-choices{display:flex;flex-direction:column;gap:8px}
.warmup-choice{display:flex;align-items:center;gap:10px;padding:11px 14px;background:var(--paper);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.88rem;transition:all .15s}
.warmup-choice:hover:not(.wu-dis){border-color:var(--advanced);background:rgba(167,139,250,.05)}
.warmup-choice.wu-correct{border-color:var(--correct);background:var(--correct-bg)}
.warmup-choice.wu-wrong{border-color:var(--wrong);background:var(--wrong-bg)}
.warmup-choice.wu-dis{pointer-events:none;opacity:.7}
.warmup-choice.wu-correct{opacity:1}
.warmup-fb{font-size:.85rem;color:var(--muted);line-height:1.6;margin-top:12px;padding:10px;background:var(--paper);border-radius:8px;border-left:3px solid var(--correct)}
.warmup-next{padding:10px 24px;background:var(--advanced);color:#fff;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:.88rem;margin-top:12px;font-family:'Source Sans 3',sans-serif}
.warmup-next:hover{filter:brightness(1.1)}
.warmup-summary{text-align:center;padding:40px 20px}
.warmup-score{font-family:'JetBrains Mono',monospace;font-size:2.4rem;font-weight:700;color:var(--advanced);margin:12px 0}
.warmup-continue{padding:12px 28px;background:var(--advanced);color:#fff;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:.95rem;margin-top:20px;font-family:'Source Sans 3',sans-serif}
.warmup-continue:hover{filter:brightness(1.15)}

/* ‚îÄ‚îÄ Lesson Content ‚îÄ‚îÄ */
.back-link{display:inline-flex;align-items:center;gap:8px;color:var(--muted);font-size:.9rem;padding:8px 0;margin-top:8px;cursor:pointer;text-decoration:none}
.back-link:hover{color:var(--accent)}
.mod-header{padding:40px 0 30px;border-bottom:1px solid var(--border);margin-bottom:32px}
.mod-badge{display:inline-block;background:var(--advanced);color:#fff;font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:5px 14px;border-radius:16px;margin-bottom:14px}
.mod-header h1{font-family:'Cormorant Garamond',serif;font-size:clamp(1.8rem,4vw,2.6rem);font-weight:700;margin-bottom:6px}
.mod-header .subtitle{color:var(--muted);font-size:1rem}
.mod-meta{display:flex;gap:20px;margin-top:14px;font-size:.82rem;color:var(--muted)}
.section{margin-bottom:36px}
.section-label{font-size:.7rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--advanced);margin-bottom:6px}
.section h2{font-family:'Cormorant Garamond',serif;font-size:1.6rem;font-weight:700;margin-bottom:12px}
.section p{color:#ccc;font-size:.93rem;margin-bottom:12px;line-height:1.7}
.card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:18px 20px;margin-bottom:12px}
.card-accent{border-left:3px solid var(--accent)}
.callout{background:var(--accent-light);border:1px solid rgba(200,16,46,.3);border-radius:10px;padding:14px 18px;margin-bottom:16px;font-size:.9rem}
.callout strong{color:var(--accent)}
.callout-blue{background:var(--math-bg);border-color:rgba(96,165,250,.3)}
.callout-blue strong{color:var(--math)}
.callout-purple{background:var(--adv-bg);border-color:rgba(167,139,250,.3)}
.callout-purple strong{color:var(--advanced)}
.topic{background:var(--surface);border:1px solid var(--border);border-radius:14px;margin-bottom:10px;overflow:hidden;transition:all .2s}
.topic-header{display:flex;align-items:center;gap:12px;padding:14px 18px;cursor:pointer}
.topic-header:hover{background:rgba(167,139,250,.05)}
.topic-badge{width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.82rem;color:#fff;flex-shrink:0}
.topic-info{flex:1}
.topic-title{font-weight:700;font-size:.95rem}
.topic-sub{font-size:.82rem;color:var(--muted)}
.topic-arrow{color:var(--muted);font-size:.9rem;transition:transform .2s;flex-shrink:0}
.topic.open .topic-arrow{transform:rotate(90deg)}
.topic-body{display:none;padding:0 18px 18px;font-size:.93rem;color:#ccc;line-height:1.7}
.topic.open .topic-body{display:block}
.topic-body h4{color:var(--ink);font-size:.9rem;margin:14px 0 6px;text-transform:uppercase;letter-spacing:.5px}
.topic-body ul{padding-left:18px;margin-bottom:10px}
.topic-body li{margin-bottom:6px}

/* ‚îÄ‚îÄ Formula & Visual ‚îÄ‚îÄ */
.formula-box{background:var(--paper);border:2px solid var(--advanced);border-radius:10px;padding:14px 18px;margin:10px 0 14px;font-family:'JetBrains Mono',monospace;font-size:.88rem;line-height:2}
.formula-box .fn{color:var(--advanced);font-weight:700}
.dr-visual{display:flex;gap:20px;align-items:center;justify-content:center;margin-bottom:14px;flex-wrap:wrap}
.dr-box{background:var(--paper);border:2px solid var(--border);border-radius:12px;padding:16px 24px;text-align:center;min-width:140px}
.dr-box-label{font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:4px}
.dr-box-val{font-family:'JetBrains Mono',monospace;font-size:1.1rem;font-weight:700}
.dr-arrow{font-size:1.8rem;color:var(--advanced)}

/* ‚îÄ‚îÄ Transformation Table ‚îÄ‚îÄ */
.tf-table{width:100%;border-collapse:collapse;font-size:.86rem;margin-bottom:14px}
.tf-table th,.tf-table td{padding:9px 12px;border:1px solid var(--border);text-align:left;vertical-align:top}
.tf-table th{background:var(--surface);font-weight:700;font-size:.76rem;text-transform:uppercase;letter-spacing:.5px;color:var(--muted)}
.tf-table code{background:var(--adv-bg);color:var(--advanced);padding:1px 6px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:.84rem}
.tf-table .tf-arrow{color:var(--psda);font-weight:700}

/* ‚îÄ‚îÄ Intersection Grid ‚îÄ‚îÄ */
.int-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:14px}
.int-card{background:var(--paper);border:2px solid var(--border);border-radius:10px;padding:14px;text-align:center}
.int-count{font-family:'JetBrains Mono',monospace;font-size:1.6rem;font-weight:700;margin-bottom:4px}
.int-label{font-size:.82rem;color:var(--muted)}
.int-icon{font-size:2rem;margin-bottom:6px}

/* ‚îÄ‚îÄ Exercises ‚îÄ‚îÄ */
.exercise{background:var(--surface);border:2px solid var(--advanced);border-radius:14px;padding:22px;margin-bottom:16px}
.exercise h3{font-family:'Cormorant Garamond',serif;font-size:1.15rem;margin-bottom:4px}
.exercise-sub{font-size:.82rem;color:var(--muted);margin-bottom:14px}
.ex-item{background:var(--paper);border-radius:10px;padding:14px;margin-bottom:10px;border:1px solid var(--border)}
.ex-num{font-size:.78rem;font-weight:700;color:var(--muted);margin-bottom:6px}
.ex-prompt{font-size:.93rem;margin-bottom:10px;line-height:1.6;color:#ddd}
.ex-prompt code{background:var(--adv-bg);color:var(--advanced);padding:1px 6px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:.85rem}
.ex-input-row{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.ex-input{padding:8px 12px;background:var(--surface);border:1px solid var(--border);border-radius:6px;color:var(--ink);font-family:'JetBrains Mono',monospace;font-size:.95rem;width:120px}
.ex-input:focus{border-color:var(--advanced);outline:none}
.ex-input.inp-correct{border-color:var(--correct);background:var(--correct-bg)}
.ex-input.inp-wrong{border-color:var(--wrong);background:var(--wrong-bg)}
.ex-btn{padding:8px 16px;background:var(--advanced);color:#fff;border:none;border-radius:6px;cursor:pointer;font-family:inherit;font-size:.85rem;font-weight:600;transition:background .15s}
.ex-btn:hover{background:#8b6fe0}
.ex-options{display:flex;flex-wrap:wrap;gap:6px}
.ex-opt{padding:7px 16px;background:var(--surface);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.85rem;transition:all .15s}
.ex-opt:hover:not(.ex-dis){border-color:var(--advanced);background:var(--adv-bg)}
.ex-opt.ex-correct{border-color:var(--correct);background:var(--correct-bg);color:var(--correct)}
.ex-opt.ex-wrong{border-color:var(--wrong);background:var(--wrong-bg);color:var(--wrong)}
.ex-opt.ex-dis{pointer-events:none;opacity:.6}
.ex-fb{font-size:.85rem;padding:8px 12px;border-radius:6px;margin-top:8px;display:none;line-height:1.5}
.ex-fb.show{display:block}
.ex-fb.correct{background:var(--correct-bg);color:var(--correct);border:1px solid var(--correct)}
.ex-fb.wrong{background:var(--wrong-bg);color:var(--wrong);border:1px solid var(--wrong)}
.ex-score{text-align:center;padding:10px 0;font-size:.88rem;color:var(--muted)}

/* ‚îÄ‚îÄ Score Bar ‚îÄ‚îÄ */
.score-bar{display:flex;align-items:center;gap:10px;margin-top:14px;padding-top:10px;border-top:1px solid var(--border)}
.score-bar-label{font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted)}
.score-bar-track{flex:1;height:6px;border-radius:3px;background:var(--border);overflow:hidden}
.score-bar-fill{height:100%;border-radius:3px;background:var(--correct);transition:width .4s ease}
.score-bar-val{font-family:'JetBrains Mono',monospace;font-size:.85rem;font-weight:700;color:var(--correct);min-width:36px;text-align:right}

/* ‚îÄ‚îÄ Trap Taxonomy ‚îÄ‚îÄ */
.trap-taxonomy{margin-bottom:24px}
.trap-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px 18px;margin-bottom:10px;display:flex;gap:14px;align-items:flex-start;transition:all .2s}
.trap-card:hover{border-color:var(--accent);transform:translateX(3px)}
.trap-number{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.78rem;color:#fff;flex-shrink:0}
.trap-card-body{flex:1}
.trap-card-name{font-weight:700;font-size:.92rem;margin-bottom:3px}
.trap-card-desc{font-size:.82rem;color:var(--muted);line-height:1.5}
.trap-card-example{font-size:.78rem;color:var(--math);font-family:'JetBrains Mono',monospace;margin-top:4px}

/* ‚îÄ‚îÄ Confidence Tags ‚îÄ‚îÄ */
.confidence-row{display:flex;gap:6px;margin-bottom:10px;flex-wrap:wrap}
.conf-tag{padding:5px 12px;border-radius:6px;font-size:.75rem;font-weight:600;cursor:pointer;border:2px solid var(--border);background:var(--surface);transition:all .15s;letter-spacing:.5px}
.conf-tag:hover{border-color:var(--advanced)}
.conf-tag.selected{border-color:var(--advanced);background:rgba(167,139,250,.12);color:var(--advanced)}
.conf-tag[data-conf="guessing"].selected{border-color:var(--psda);background:rgba(251,191,36,.12);color:var(--psda)}
.conf-tag[data-conf="unsure"].selected{border-color:var(--math);background:var(--math-bg);color:var(--math)}
.conf-tag[data-conf="confident"].selected{border-color:var(--advanced);background:rgba(167,139,250,.12);color:var(--advanced)}

/* ‚îÄ‚îÄ Timed Practice ‚îÄ‚îÄ */
.tier{font-size:.68rem;font-weight:700;letter-spacing:1px;text-transform:uppercase;padding:2px 8px;border-radius:4px;margin-right:8px}
.tier-1{background:rgba(52,211,153,.15);color:var(--algebra)}.tier-2{background:var(--math-bg);color:var(--math)}.tier-3{background:var(--adv-bg);color:var(--advanced)}
.mc-choices{display:flex;flex-direction:column;gap:6px}
.mc-choice{padding:10px 14px;background:var(--surface);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.88rem;transition:all .15s;display:flex;align-items:center;gap:10px}
.mc-choice:hover:not(.mc-dis){border-color:var(--advanced);background:var(--adv-bg)}
.mc-letter{font-weight:700;color:var(--muted);min-width:24px;font-family:'JetBrains Mono',monospace}
.mc-choice.mc-correct{border-color:var(--correct);background:var(--correct-bg)}
.mc-choice.mc-wrong{border-color:var(--wrong);background:var(--wrong-bg)}
.mc-choice.mc-dis{pointer-events:none;opacity:.7}
.mc-choice.mc-correct .mc-letter{color:var(--correct)}.mc-choice.mc-wrong .mc-letter{color:var(--wrong)}
.mc-fb{font-size:.85rem;color:var(--muted);line-height:1.6;margin-top:8px;display:none;border-left:3px solid var(--correct);background:var(--paper);padding:8px 12px;border-radius:6px}.mc-fb.show{display:block}
.timer-bar{position:sticky;top:8px;z-index:50;background:rgba(18,18,18,.92);backdrop-filter:blur(8px);border:1px solid var(--border);border-radius:12px;padding:10px 16px;margin-bottom:20px;display:flex;align-items:center;gap:14px}
.timer-display{font-family:'JetBrains Mono',monospace;font-size:1.1rem;font-weight:700;color:var(--advanced);min-width:60px}
.timer-display.warning{color:var(--psda)}
.timer-display.danger{color:var(--wrong);animation:pulse 1s ease infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
.timer-track{flex:1;height:4px;background:var(--border);border-radius:2px;overflow:hidden}
.timer-fill{height:100%;background:var(--advanced);transition:width 1s linear;border-radius:2px}
.timer-fill.warning{background:var(--psda)}
.timer-fill.danger{background:var(--wrong)}
.timer-toggle{padding:5px 12px;background:var(--surface);border:1px solid var(--border);border-radius:6px;font-size:.75rem;color:var(--muted);cursor:pointer;font-family:'Source Sans 3',sans-serif;font-weight:600}
.timer-toggle:hover{border-color:var(--accent);color:var(--ink)}
.timer-toggle.active{background:var(--accent-light);border-color:var(--accent);color:var(--accent)}
.q-dots{display:flex;gap:4px}
.q-dot{width:8px;height:8px;border-radius:50%;background:var(--border)}
.q-dot.correct{background:var(--correct)}
.q-dot.wrong{background:var(--wrong)}

/* ‚îÄ‚îÄ Results ‚îÄ‚îÄ */
.results-section{margin-top:24px;padding:20px;background:var(--surface);border:1px solid var(--border);border-radius:14px}
.results-section h3{font-family:'Cormorant Garamond',serif;font-size:1.3rem;margin-bottom:14px}
.results-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:2px;margin-bottom:16px;background:var(--border);border-radius:10px;overflow:hidden}
.results-grid-header{background:var(--surface);padding:8px;text-align:center;font-size:.68rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted)}
.results-grid-cell{background:var(--paper);padding:10px 8px;text-align:center;font-size:.78rem;min-height:50px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px}
.results-grid-cell.danger-cell{background:var(--danger-bg);border:1px solid rgba(239,68,68,.3)}
.cell-label{font-size:.65rem;color:var(--muted);font-weight:600}
.cell-dots{display:flex;gap:3px;flex-wrap:wrap;justify-content:center}
.cell-dot{width:8px;height:8px;border-radius:50%}
.difficulty-bars{display:flex;flex-direction:column;gap:8px;margin-bottom:16px}
.diff-row{display:flex;align-items:center;gap:10px}
.diff-label{font-size:.78rem;font-weight:600;min-width:60px}
.diff-track{flex:1;height:8px;background:var(--border);border-radius:4px;overflow:hidden}
.diff-fill{height:100%;border-radius:4px;transition:width .5s ease}
.diff-val{font-family:'JetBrains Mono',monospace;font-size:.78rem;font-weight:700;min-width:40px;text-align:right}
.error-category{padding:12px 16px;border-radius:10px;margin-bottom:8px;font-size:.85rem;line-height:1.6}
.error-category .error-label{font-weight:700;margin-bottom:4px}
.error-category .error-items{color:var(--muted);font-size:.82rem}

/* ‚îÄ‚îÄ Module Complete ‚îÄ‚îÄ */
.complete-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:40px 20px;text-align:center}
.complete-icon{font-size:4rem;margin-bottom:16px;animation:celebrateBounce .6s ease}
@keyframes celebrateBounce{0%{transform:scale(0)}50%{transform:scale(1.2)}100%{transform:scale(1)}}
.complete-screen h1{font-family:'Cormorant Garamond',serif;font-size:clamp(1.8rem,4vw,2.4rem);margin-bottom:8px}
.complete-sub{color:var(--muted);font-size:1rem;margin-bottom:28px}
.takeaway-list{text-align:left;max-width:500px;width:100%;margin-bottom:32px}
.takeaway-item{display:flex;gap:10px;align-items:flex-start;padding:8px 0;font-size:.88rem;color:#ccc}
.takeaway-check{color:var(--correct);flex-shrink:0;font-weight:700}
.nav-cards{display:grid;grid-template-columns:1fr 1fr;gap:12px;max-width:500px;width:100%}
.nav-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:18px;text-align:center;cursor:pointer;transition:all .2s;text-decoration:none;color:var(--ink)}
.nav-card:hover{border-color:var(--advanced);transform:translateY(-2px)}
.nav-card-label{font-size:.7rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:4px}
.nav-card-title{font-weight:700;font-size:.95rem}

@media(max-width:600px){
  .mod-meta{flex-wrap:wrap;gap:10px}
  .tf-table{font-size:.78rem}
  .int-grid{grid-template-columns:1fr}
  .dr-visual{flex-direction:column}
  .ex-options{flex-direction:column}
  .preview-grid{grid-template-columns:1fr 1fr}
  .welcome-meta{flex-wrap:wrap;gap:12px}
  .results-grid{grid-template-columns:1fr;gap:1px}
  .nav-cards{grid-template-columns:1fr}
  .timer-bar{flex-wrap:wrap;gap:8px}
}
</style>
</head>
<body>
<div class="top-stripe"></div>
<div class="screen-progress" id="screenProgress"></div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- SCREEN 1: WELCOME                             -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen active fade-in" id="screen-welcome">
  <div class="welcome-screen">
    <div class="welcome-badge">Module 4</div>
    <h1>Advanced Math: Functions & Properties</h1>
    <p class="welcome-sub">Functions are the language of Advanced Math. Learn to read, transform, compose, and solve them.</p>
    <div class="welcome-meta">
      <span>‚è± 2‚Äì3 sessions</span>
      <span>üìã 4 topics</span>
      <span>üî® 5 exercises</span>
      <span>üéØ 10 practice Qs</span>
    </div>
    <div class="preview-grid">
      <div class="preview-card"><div class="preview-icon">üîÑ</div><div class="preview-title">Retrieval Warm-Up</div><div class="preview-desc">5 questions from Module 3 to activate prior knowledge</div></div>
      <div class="preview-card"><div class="preview-icon">üìê</div><div class="preview-title">4 Core Topics</div><div class="preview-desc">Notation, domain/range, transformations, composition</div></div>
      <div class="preview-card"><div class="preview-icon">üéØ</div><div class="preview-title">Trap Taxonomy</div><div class="preview-desc">4 named traps that recur in function questions</div></div>
      <div class="preview-card"><div class="preview-icon">üßÆ</div><div class="preview-title">5 Exercises</div><div class="preview-desc">Evaluate, classify, transform, compose, and analyze</div></div>
      <div class="preview-card"><div class="preview-icon">‚è±</div><div class="preview-title">Timed Practice</div><div class="preview-desc">10 SAT-style questions with optional timer</div></div>
      <div class="preview-card"><div class="preview-icon">üìä</div><div class="preview-title">Error Analysis</div><div class="preview-desc">Difficulty breakdown + confidence matrix + trap patterns</div></div>
    </div>
    <button class="start-btn" onclick="goScreen(1)">Start Learning ‚Üí</button>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- SCREEN 2: RETRIEVAL WARM-UP                   -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen" id="screen-warmup">
  <div class="warmup-container">
    <div class="warmup-header">
      <div class="warmup-badge">Retrieval Warm-Up</div>
      <h2 style="font-family:'Cormorant Garamond',serif;font-size:1.6rem">Module 3 Review</h2>
      <p style="color:var(--muted);font-size:.9rem;margin-top:4px">Quick recall from what you learned last time.</p>
      <div class="warmup-dots" id="warmupDots"></div>
    </div>
    <div id="warmupContent"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- SCREEN 3: LESSON CONTENT                      -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen" id="screen-lesson">
<div class="container">
<a class="back-link" href="index.html">‚Üê Back to SAT Math Course</a>
<div class="mod-header">
  <div class="mod-badge">Module 4</div>
  <h1>Functions & Their Properties</h1>
  <p class="subtitle">Functions are the language of Advanced Math. Learn to read, transform, compose, and solve them.</p>
  <div class="mod-meta"><span>‚è± 2‚Äì3 sessions</span><span>üìã 4 topics</span><span>üî® Phase 2: Build</span></div>
</div>

<div class="callout-purple callout"><strong>Functions are everywhere in Advanced Math.</strong> Almost every Advanced Math question involves functions in some form. The SAT tests whether you can evaluate them, transform them, compose them, and find where they intersect. This module builds the skills that connect everything in Modules 2‚Äì3 into a unified toolkit.</div>

<!-- ‚îÄ‚îÄ Big Picture ‚îÄ‚îÄ -->
<div class="section">
  <div class="section-label">Big Picture</div>
  <h2>Why Functions Matter</h2>
  <div class="dr-visual">
    <div class="dr-box"><div class="dr-box-label">Input (Domain)</div><div class="dr-box-val" style="color:var(--algebra)">x</div></div>
    <div class="dr-arrow">‚Üí f ‚Üí</div>
    <div class="dr-box"><div class="dr-box-label">Output (Range)</div><div class="dr-box-val" style="color:var(--advanced)">f(x)</div></div>
  </div>
  <p>A function is a machine: you put in an input (x), it runs a rule, and you get an output (f(x)). <strong>Domain</strong> = all allowed inputs. <strong>Range</strong> = all possible outputs.</p>
</div>

<!-- ‚ïê‚ïê TOPIC 4A ‚ïê‚ïê -->
<div class="section">
  <div class="section-label">Topic 4A</div>
  <h2>Function Notation & Evaluation</h2>
  <div class="topic open" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
    <div class="topic-header">
      <div class="topic-badge" style="background:var(--advanced)">4A</div>
      <div class="topic-info"><div class="topic-title">Reading f(x) Notation</div><div class="topic-sub">Substitution, evaluation from equations, tables, and graphs</div></div>
      <div class="topic-arrow">‚ñ∏</div>
    </div>
    <div class="topic-body">
      <p><code>f(x) = 2x + 3</code> is NOT f times x. It means "the function f, applied to input x."</p>
      <p><strong>f(5)</strong> means: substitute 5 for x ‚Üí 2(5) + 3 = 13</p>
      <p><strong>f(a + 1)</strong> means: substitute (a + 1) for every x ‚Üí 2(a + 1) + 3 = 2a + 5</p>
      <p><strong>f(x) = 0</strong> means: find which x values make the output zero (the zeros/roots)</p>
      <p>You can evaluate functions from equations, tables, or graphs. On a graph, f(3) means "go to x = 3 and read the y-value."</p>
    </div>
  </div>
  <div class="topic" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
    <div class="topic-header">
      <div class="topic-badge" style="background:var(--advanced)">4A</div>
      <div class="topic-info"><div class="topic-title">Domain & Range</div><div class="topic-sub">Restrictions, contextual domains, identifying range</div></div>
      <div class="topic-arrow">‚ñ∏</div>
    </div>
    <div class="topic-body">
      <p><strong>Domain:</strong> All x-values for which the function is defined.</p>
      <p><strong>Range:</strong> All y-values the function actually outputs.</p>
      <p>Common domain restrictions on the SAT:</p>
      <ul>
        <li><strong>Fractions:</strong> Denominator ‚â† 0</li>
        <li><strong>Square roots:</strong> Expression under radical ‚â• 0</li>
        <li><strong>Context:</strong> If x represents time or quantity, x ‚â• 0</li>
      </ul>
      <p>For range, think about what y-values are possible. A parabola opening up with vertex at (2, ‚àí3) has range y ‚â• ‚àí3.</p>
    </div>
  </div>
  <div class="topic" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
    <div class="topic-header">
      <div class="topic-badge" style="background:var(--advanced)">4A</div>
      <div class="topic-info"><div class="topic-title">Interpreting Function Values in Context</div><div class="topic-sub">Initial values, rates, and what constants represent</div></div>
      <div class="topic-arrow">‚ñ∏</div>
    </div>
    <div class="topic-body">
      <p>The SAT loves word problems where functions model real situations. Key translations:</p>
      <ul>
        <li><strong>f(0)</strong> = the initial/starting value</li>
        <li><strong>The slope (or rate of change)</strong> = the "per" value (per hour, per item, etc.)</li>
        <li><strong>f(x) = 0</strong> = when does the quantity reach zero?</li>
        <li><strong>"What does the 12 represent in f(t) = 12 + 3t?"</strong> ‚Üí The initial value of 12 (the y-intercept)</li>
        <li><strong>"What does the 3 represent?"</strong> ‚Üí The rate of change: it increases by 3 per unit of t</li>
      </ul>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê EXERCISE 1: FUNCTION EVALUATOR ‚ïê‚ïê -->
<div class="section">
  <div class="section-label">Interactive Exercise 1</div>
  <h2>Function Evaluator</h2>
  <p>Evaluate each function at the given input. Type your numerical answer.</p>
  <div class="exercise" id="evalExercise"></div>
</div>

<!-- ‚ïê‚ïê EXERCISE 2: DOMAIN/RANGE CLASSIFIER ‚ïê‚ïê -->
<div class="section">
  <div class="section-label">Interactive Exercise 2</div>
  <h2>Domain & Range Classifier</h2>
  <p>For each function description, identify the correct domain or range. This is one of the most common conceptual question types on the SAT.</p>
  <div class="exercise" style="border-color:var(--psda)" id="drExercise"></div>
</div>

<!-- ‚ïê‚ïê TOPIC 4B ‚ïê‚ïê -->
<div class="section">
  <div class="section-label">Topic 4B</div>
  <h2>Function Transformations</h2>
  <p>The SAT tests whether you can predict how a graph changes when the equation changes. Memorize this table ‚Äî it covers every transformation the SAT tests.</p>
  <table class="tf-table">
    <tr><th>Transformation</th><th>Equation Change</th><th>Graph Effect</th></tr>
    <tr><td>Shift UP k</td><td><code>f(x) + k</code></td><td class="tf-arrow">‚Üë Moves graph UP k units</td></tr>
    <tr><td>Shift DOWN k</td><td><code>f(x) ‚àí k</code></td><td class="tf-arrow">‚Üì Moves graph DOWN k units</td></tr>
    <tr><td>Shift RIGHT h</td><td><code>f(x ‚àí h)</code></td><td class="tf-arrow">‚Üí Moves graph RIGHT h units</td></tr>
    <tr><td>Shift LEFT h</td><td><code>f(x + h)</code></td><td class="tf-arrow">‚Üê Moves graph LEFT h units</td></tr>
    <tr><td>Vertical stretch</td><td><code>a¬∑f(x)</code>, a &gt; 1</td><td class="tf-arrow">‚Üï Steeper / taller</td></tr>
    <tr><td>Vertical compress</td><td><code>a¬∑f(x)</code>, 0 &lt; a &lt; 1</td><td class="tf-arrow">‚Üî Flatter / shorter</td></tr>
    <tr><td>Reflect over x-axis</td><td><code>‚àíf(x)</code></td><td class="tf-arrow">‚áÖ Flips upside down</td></tr>
    <tr><td>Reflect over y-axis</td><td><code>f(‚àíx)</code></td><td class="tf-arrow">‚áÑ Flips left-right</td></tr>
  </table>
  <div class="callout"><strong>The #1 Trap:</strong> Horizontal transformations work <em>backward</em>. <code>f(x ‚àí 3)</code> shifts <strong>RIGHT</strong> 3, not left. Think of it as: the input needs to be 3 bigger to get the same output, so the graph moves right.</div>
  <div class="callout-blue callout"><strong>Desmos Tip:</strong> Graph <code>f(x) = x¬≤</code> on line 1, then type <code>(x ‚àí 3)¬≤</code> on line 2. Watch the parabola shift right. Change numbers to build intuition for every transformation type.</div>
</div>

<!-- ‚ïê‚ïê EXERCISE 3: TRANSFORMATION IDENTIFIER ‚ïê‚ïê -->
<div class="section">
  <div class="section-label">Interactive Exercise 3</div>
  <h2>Transformation Identifier</h2>
  <p>Given the original function f(x), identify what transformation was applied.</p>
  <div class="exercise" id="tfExercise"></div>
</div>

<!-- ‚ïê‚ïê TOPIC 4C ‚ïê‚ïê -->
<div class="section">
  <div class="section-label">Topic 4C</div>
  <h2>Composition of Functions</h2>
  <div class="topic open" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
    <div class="topic-header">
      <div class="topic-badge" style="background:var(--advanced)">4C</div>
      <div class="topic-info"><div class="topic-title">f(g(x)) ‚Äî The Inside-Out Rule</div><div class="topic-sub">Evaluating, composing algebraically, order matters</div></div>
      <div class="topic-arrow">‚ñ∏</div>
    </div>
    <div class="topic-body">
      <p><strong>f(g(x))</strong> means: apply g first, then apply f to the result.</p>
      <p>Think of it as two machines in sequence: x goes into g, the output goes into f.</p>
      <p><strong>Example:</strong> If f(x) = x¬≤ and g(x) = x + 3:</p>
      <p>f(g(2)) ‚Üí g(2) = 2 + 3 = 5 ‚Üí f(5) = 5¬≤ = <strong>25</strong></p>
      <p>g(f(2)) ‚Üí f(2) = 2¬≤ = 4 ‚Üí g(4) = 4 + 3 = <strong>7</strong></p>
      <p>Notice: f(g(x)) ‚â† g(f(x)) in general! Order matters.</p>
      <p><strong>To find f(g(x)) algebraically:</strong> Replace every x in f's formula with the entire expression for g(x).</p>
      <p>f(g(x)) = f(x + 3) = (x + 3)¬≤ = x¬≤ + 6x + 9</p>
    </div>
  </div>
  <div class="callout-purple callout"><strong>SAT Pattern:</strong> Composition questions usually give you two simple functions and ask for f(g(specific number)). Work inside-out: evaluate g first, then plug the result into f. Don't overthink it.</div>
</div>

<!-- ‚ïê‚ïê EXERCISE 4: COMPOSITION WORKSHOP ‚ïê‚ïê -->
<div class="section">
  <div class="section-label">Interactive Exercise 4</div>
  <h2>Composition Workshop</h2>
  <p>Given f(x) and g(x), evaluate the composition. Includes absolute value and nested functions ‚Äî matching real SAT difficulty.</p>
  <div class="exercise" id="compExercise"></div>
</div>

<!-- ‚ïê‚ïê EXERCISE 5: FUNCTION BEHAVIOR CLASSIFIER ‚ïê‚ïê -->
<div class="section">
  <div class="section-label">Interactive Exercise 5</div>
  <h2>Function Behavior Classifier</h2>
  <p>The SAT tests conceptual understanding of functions ‚Äî not just computation. For each description, classify the function's behavior.</p>
  <div class="exercise" style="border-color:var(--algebra)" id="behaviorEx"></div>
</div>

<!-- ‚ïê‚ïê TOPIC 4D ‚ïê‚ïê -->
<div class="section">
  <div class="section-label">Topic 4D</div>
  <h2>Nonlinear Systems</h2>
  <p>When the SAT gives you a system where one equation is linear and one is quadratic (or both nonlinear), you can solve by substitution ‚Äî or graph both in Desmos.</p>
  <div class="int-grid">
    <div class="int-card" style="border-color:var(--correct)"><div class="int-icon">‚úï‚úï</div><div class="int-count" style="color:var(--correct)">2</div><div class="int-label">Line crosses parabola at 2 points</div></div>
    <div class="int-card" style="border-color:var(--psda)"><div class="int-icon">‚úï</div><div class="int-count" style="color:var(--psda)">1</div><div class="int-label">Line is tangent to parabola</div></div>
    <div class="int-card" style="border-color:var(--wrong)"><div class="int-icon">‚àÖ</div><div class="int-count" style="color:var(--wrong)">0</div><div class="int-label">Line doesn't touch parabola</div></div>
  </div>
  <div class="topic" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
    <div class="topic-header">
      <div class="topic-badge" style="background:var(--advanced)">4D</div>
      <div class="topic-info"><div class="topic-title">Solving Nonlinear Systems</div><div class="topic-sub">Substitution, graphing, discriminant for intersection count</div></div>
      <div class="topic-arrow">‚ñ∏</div>
    </div>
    <div class="topic-body">
      <p><strong>Method 1: Substitution</strong></p>
      <ul>
        <li>Set the two equations equal: if y = x + 1 and y = x¬≤, then x + 1 = x¬≤</li>
        <li>Rearrange to standard form: x¬≤ ‚àí x ‚àí 1 = 0</li>
        <li>Solve the resulting equation</li>
        <li>Plug solutions back in to find y-values</li>
      </ul>
      <p><strong>Method 2: Desmos (faster!)</strong></p>
      <p>Graph both equations. Click the intersection points for exact coordinates.</p>
      <p><strong>Key insight:</strong> The discriminant of the resulting equation tells you how many intersection points exist.</p>
    </div>
  </div>
  <div class="topic" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
    <div class="topic-header">
      <div class="topic-badge" style="background:var(--advanced)">4D</div>
      <div class="topic-info"><div class="topic-title">Systems with a Parameter</div><div class="topic-sub">Finding k for one solution, tangent lines</div></div>
      <div class="topic-arrow">‚ñ∏</div>
    </div>
    <div class="topic-body">
      <p>A harder SAT question type: "For what value of k does the system have exactly one solution?"</p>
      <p><strong>Strategy:</strong> Set the equations equal, rearrange to standard form, then set the discriminant = 0.</p>
      <p><strong>Desmos Power Move:</strong> Use a slider for k and watch the line move until it's tangent to the parabola.</p>
    </div>
  </div>
  <div class="callout-blue callout"><strong>Desmos Bridge:</strong> For every nonlinear system problem, try solving it BOTH algebraically and by graphing in Desmos. In Module 7, you'll learn when Desmos is faster ‚Äî but building the habit of verifying starts here.</div>
</div>

<!-- ‚îÄ‚îÄ Trap Taxonomy ‚îÄ‚îÄ -->
<div class="section">
  <div class="section-label">Math Trap Taxonomy</div>
  <h2>Four Traps That Recur in Function Questions</h2>
  <p>Learn these by name. When you spot one in a problem, you'll know exactly what to watch for.</p>
  <div class="trap-taxonomy">
    <div class="trap-card"><div class="trap-number" style="background:var(--wrong)">1</div><div class="trap-card-body"><div class="trap-card-name">üîÑ Horizontal Flip</div><div class="trap-card-desc">Confused the direction of a horizontal transformation. f(x ‚àí 3) shifts RIGHT, not left. The sign is opposite to what most students expect.</div><div class="trap-card-example">f(x ‚àí 3) ‚Üí shifts RIGHT 3, f(x + 3) ‚Üí shifts LEFT 3</div></div></div>
    <div class="trap-card"><div class="trap-number" style="background:var(--psda)">2</div><div class="trap-card-body"><div class="trap-card-name">üéØ Wrong Target</div><div class="trap-card-desc">Solved for x when they asked for f(x), or found f(x) when they asked for x. Always underline exactly what the question asks for.</div><div class="trap-card-example">Asked: "What is f(3)?" You found x = 3, picked 3. Answer: f(3) = 7</div></div></div>
    <div class="trap-card"><div class="trap-number" style="background:var(--advanced)">3</div><div class="trap-card-body"><div class="trap-card-name">üé≠ Imposter Domain</div><div class="trap-card-desc">Forgot a domain restriction. Especially dangerous with fractions (denominator ‚â† 0) and square roots (radicand ‚â• 0).</div><div class="trap-card-example">f(x) = 1/(x‚àí3): domain is all reals except x = 3, not all reals</div></div></div>
    <div class="trap-card"><div class="trap-number" style="background:var(--geotrig)">4</div><div class="trap-card-body"><div class="trap-card-name">üìê Composition Swap</div><div class="trap-card-desc">Evaluated f(g(x)) as g(f(x)) ‚Äî or the reverse. Order matters in composition. Always work inside-out.</div><div class="trap-card-example">f(g(2)) ‚â† g(f(2)) in general. Check which function is inside.</div></div></div>
  </div>
</div>

<div style="text-align:center;padding:24px 0">
  <button class="start-btn" onclick="goScreen(3)">Continue to Practice ‚Üí</button>
</div>
</div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- SCREEN 4: TIMED PRACTICE                      -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen" id="screen-practice">
<div class="container">
  <div class="section-label">SAT Practice</div>
  <h2 style="font-family:'Cormorant Garamond',serif;font-size:1.6rem;margin-bottom:4px">Practice Questions</h2>
  <p style="color:var(--muted);font-size:.9rem;margin-bottom:16px">10 questions across all topics. Tag your confidence before answering.</p>
  <div class="timer-bar" id="timerBar">
    <div class="timer-display" id="timerDisplay">--:--</div>
    <div class="timer-track"><div class="timer-fill" id="timerFill"></div></div>
    <div class="q-dots" id="qDots"></div>
    <button class="timer-toggle" id="timerToggle" onclick="toggleTimer()">‚è± Timer OFF</button>
  </div>
  <div id="psatPractice"></div>
  <div id="practiceResults" style="display:none"></div>
  <div id="practiceNav" style="display:none;text-align:center;padding:24px 0">
    <button class="start-btn" onclick="goScreen(4)">View Summary & Complete Module ‚Üí</button>
  </div>
</div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- SCREEN 5: MODULE COMPLETE                     -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen" id="screen-complete">
  <div class="complete-screen">
    <div class="complete-icon">üéâ</div>
    <h1>Module 4 Complete!</h1>
    <p class="complete-sub">You've mastered functions ‚Äî evaluation, transformations, composition, and nonlinear systems.</p>
    <div class="takeaway-list">
      <div style="font-weight:700;margin-bottom:12px;font-size:.85rem;color:var(--advanced);text-transform:uppercase;letter-spacing:1px">Key Takeaways</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> f(x) means "apply function f to input x" ‚Äî substitute x everywhere in the formula.</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> Domain = allowed inputs, Range = possible outputs. Watch for division by zero and negative square roots.</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> Horizontal transformations work backward: f(x ‚àí 3) shifts RIGHT, f(x + 3) shifts LEFT.</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> Composition f(g(x)): work inside-out. Evaluate g first, then plug into f.</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> Increasing functions go up as x increases; decreasing functions go down. The SAT tests this conceptually.</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> For nonlinear systems: set equations equal, rearrange, and use the discriminant to count solutions.</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> In context questions, identify what the constants and coefficients REPRESENT.</div>
    </div>
    <div id="completePracticeStats"></div>
    <div class="nav-cards">
      <a class="nav-card" href="module-3.html"><div class="nav-card-label">‚Üê Previous</div><div class="nav-card-title">Module 3: Quadratics & Polynomials</div></a>
      <a class="nav-card" href="module-5.html" style="border-color:var(--advanced)"><div class="nav-card-label">Next ‚Üí</div><div class="nav-card-title">Module 5: Data Analysis</div></a>
    </div>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SCREEN NAVIGATION SYSTEM
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const SCREENS = ['screen-welcome','screen-warmup','screen-lesson','screen-practice','screen-complete'];
let currentScreen = 0;

function goScreen(idx) {
  if (idx < 0 || idx >= SCREENS.length) return;
  const cur = document.getElementById(SCREENS[currentScreen]);
  const nxt = document.getElementById(SCREENS[idx]);
  cur.classList.remove('fade-in');
  cur.classList.add('fade-out');
  setTimeout(() => {
    cur.classList.remove('active','fade-out');
    nxt.classList.add('active','fade-in');
    currentScreen = idx;
    updateProgressDots();
    window.scrollTo(0, 0);
    if (idx === 3 && timerEnabled) startTimer();
  }, 300);
}

function updateProgressDots() {
  document.getElementById('screenProgress').innerHTML = SCREENS.map((s, i) => {
    let cls = 'screen-dot';
    if (i < currentScreen) cls += ' completed';
    if (i === currentScreen) cls += ' current';
    return `<div class="${cls}" onclick="${i <= currentScreen ? 'goScreen('+i+')' : ''}" title="${['Welcome','Warm-Up','Lesson','Practice','Complete'][i]}"></div>`;
  }).join('');
}
updateProgressDots();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RETRIEVAL WARM-UP (Module 3 content)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const WARMUP_QS = [
  {source:'Module 3 ‚Äî Quadratic Forms', q:'The three forms of a quadratic are standard, vertex, and ___?',
   ch:['Linear','Factored','Simplified','Expanded'], c:1,
   fb:'The three forms are standard (ax¬≤ + bx + c), vertex (a(x‚àíh)¬≤ + k), and factored (a(x‚àír)(x‚àís)). Each reveals different information.'},
  {source:'Module 3 ‚Äî Discriminant', q:'The discriminant b¬≤ ‚àí 4ac = 0 means the equation has how many solutions?',
   ch:['0 solutions','1 solution','2 solutions','Infinite solutions'], c:1,
   fb:'When the discriminant equals zero, the quadratic has exactly one real solution (a double root). The parabola touches the x-axis at its vertex.'},
  {source:'Module 3 ‚Äî Vertex', q:'The x-coordinate of the vertex of y = ax¬≤ + bx + c is given by?',
   ch:['x = b/2a','x = ‚àíb/(2a)','x = ‚àíc/b','x = 2a/b'], c:1,
   fb:'The vertex x-coordinate is x = ‚àíb/(2a). Plug this back into the equation to find the y-coordinate (the min or max value).'},
  {source:'Module 3 ‚Äî Exponents', q:'Simplify: x‚Åµ ¬∑ x¬≥',
   ch:['x¬≤','x‚Å∏','x¬π‚Åµ','8x'], c:1,
   fb:'Product rule: when multiplying same bases, ADD the exponents. x‚Åµ ¬∑ x¬≥ = x‚Åµ‚Å∫¬≥ = x‚Å∏.'},
  {source:'Module 3 ‚Äî Growth/Decay', q:'A population that doubles every year follows which type of function?',
   ch:['Linear growth','Linear decay','Exponential growth','Exponential decay'], c:2,
   fb:'Doubling = multiplying by 2 each period. Constant multiplier = exponential growth. Linear would be adding a fixed amount each time.'}
];

let warmupIdx = 0, warmupAnswers = [], warmupAnswered = false;

function renderWarmup() {
  document.getElementById('warmupDots').innerHTML = WARMUP_QS.map((_, i) => {
    let cls = 'warmup-dot';
    if (i < warmupIdx) cls += warmupAnswers[i] ? ' done-correct' : ' done-wrong';
    if (i === warmupIdx && warmupIdx < WARMUP_QS.length) cls += ' active';
    return `<div class="${cls}"></div>`;
  }).join('');
  const cont = document.getElementById('warmupContent');
  if (warmupIdx >= WARMUP_QS.length) {
    const cor = warmupAnswers.filter(Boolean).length;
    cont.innerHTML = `<div class="warmup-summary"><div class="warmup-badge">Warm-Up Complete</div><div class="warmup-score">${cor} / ${WARMUP_QS.length}</div><p style="color:var(--muted);font-size:.9rem;margin-bottom:8px">${cor===5?'Perfect recall! Module 3 knowledge is locked in.':cor>=3?'Good recall! A couple topics to revisit.':'Some gaps from Module 3 ‚Äî consider a quick review.'}</p><button class="warmup-continue" onclick="goScreen(2)">Continue to Lesson ‚Üí</button></div>`;
    return;
  }
  const q = WARMUP_QS[warmupIdx];
  warmupAnswered = false;
  cont.innerHTML = `<div class="warmup-q"><div class="source-tag">From ${q.source}</div><div class="q-text">${q.q}</div><div class="warmup-choices" id="warmupChoices">${q.ch.map((ch, ci) => `<div class="warmup-choice" onclick="answerWarmup(${ci})">${ch}</div>`).join('')}</div><div id="warmupFb" style="display:none"></div></div>`;
}

function answerWarmup(ci) {
  if (warmupAnswered) return;
  warmupAnswered = true;
  const q = WARMUP_QS[warmupIdx], correct = ci === q.c;
  warmupAnswers.push(correct);
  document.querySelectorAll('.warmup-choice').forEach((ch, i) => {
    ch.classList.add('wu-dis');
    if (i === q.c) ch.classList.add('wu-correct');
    else if (i === ci && !correct) ch.classList.add('wu-wrong');
  });
  const fb = document.getElementById('warmupFb');
  fb.style.display = 'block';
  fb.innerHTML = `<div class="warmup-fb">${correct ? '‚úì ' : '‚úó '}${q.fb}</div><button class="warmup-next" onclick="warmupIdx++;renderWarmup()">${warmupIdx < WARMUP_QS.length - 1 ? 'Next Question ‚Üí' : 'See Results ‚Üí'}</button>`;
  document.getElementById('warmupDots').innerHTML = WARMUP_QS.map((_, i) => {
    let cls = 'warmup-dot';
    if (i < warmupAnswers.length) cls += warmupAnswers[i] ? ' done-correct' : ' done-wrong';
    else if (i === warmupIdx + 1) cls += ' active';
    return `<div class="${cls}"></div>`;
  }).join('');
}
renderWarmup();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HELPERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function mkScore(id, correct, total) {
  return `<div class="score-bar"><div class="score-bar-label">Score</div><div class="score-bar-track"><div class="score-bar-fill" style="width:${total ? correct/total*100 : 0}%"></div></div><div class="score-bar-val">${correct}/${total}</div></div>`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// EXERCISE 1: FUNCTION EVALUATOR
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const EVALS=[
  {prompt:'f(x) = 3x ‚àí 7. Find f(4).',answer:5,solution:'3(4) ‚àí 7 = 12 ‚àí 7 = 5'},
  {prompt:'g(x) = x¬≤ + 1. Find g(‚àí3).',answer:10,solution:'(‚àí3)¬≤ + 1 = 9 + 1 = 10'},
  {prompt:'h(x) = 2x¬≤ ‚àí x. Find h(5).',answer:45,solution:'2(5¬≤) ‚àí 5 = 50 ‚àí 5 = 45'},
  {prompt:'f(x) = x¬≥ ‚àí 2x. Find f(‚àí2).',answer:-4,solution:'(‚àí2)¬≥ ‚àí 2(‚àí2) = ‚àí8 + 4 = ‚àí4'},
  {prompt:'p(x) = 4x + 10. Find p(0).',answer:10,solution:'4(0) + 10 = 10. This is the y-intercept!'},
  {prompt:'f(x) = (x + 1)(x ‚àí 3). Find f(3).',answer:0,solution:'(3+1)(3‚àí3) = (4)(0) = 0. x = 3 is a zero of f!'},
  {prompt:'g(x) = |2x ‚àí 8|. Find g(1).',answer:6,solution:'|2(1) ‚àí 8| = |‚àí6| = 6'},
  {prompt:'f(x) = 100(0.5)À£. Find f(3).',answer:12.5,solution:'100(0.5)¬≥ = 100(0.125) = 12.5. Exponential decay!'},
];
let evalAns={};
function renderEvals(){
  const total=EVALS.length;const correct=Object.entries(evalAns).filter(([i,v])=>v===true).length;
  document.getElementById('evalExercise').innerHTML=`<h3>üî¢ Evaluate These Functions</h3><div class="exercise-sub">Type the numerical answer.</div>`+EVALS.map((e,i)=>{
    const ans=evalAns[i];const has=ans!==undefined;
    return `<div class="ex-item"><div class="ex-num">Problem ${i+1}</div><div class="ex-prompt">${e.prompt}</div><div class="ex-input-row"><input class="ex-input${has?(ans?' inp-correct':' inp-wrong'):''}" id="eInp${i}" placeholder="?" ${has?'disabled':''} onkeydown="if(event.key==='Enter')checkEval(${i})"><button class="ex-btn" onclick="checkEval(${i})" ${has?'disabled':''}>Check</button></div><div class="ex-fb${has?' show':''}${has?(ans?' correct':' wrong'):''}">${has?(ans?'‚úì Correct! ':'‚úó Incorrect. ')+e.solution:''}</div></div>`;
  }).join('')+mkScore('ev',correct,total);
}
function checkEval(i){var v=parseFloat(document.getElementById('eInp'+i).value);evalAns[i]=Math.abs(v-EVALS[i].answer)<0.01;renderEvals();}
renderEvals();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// EXERCISE 2: DOMAIN/RANGE CLASSIFIER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const DR_QS=[
  {q:'f(x) = 1/(x ‚àí 3). What is the domain?',correct:'All real numbers except x = 3',opts:['All real numbers','All real numbers except x = 3','x ‚â• 3','x > 0'],fb:'Denominator can\'t be 0. x ‚àí 3 = 0 when x = 3, so exclude x = 3.'},
  {q:'f(x) = ‚àö(x ‚àí 5). What is the domain?',correct:'x ‚â• 5',opts:['All real numbers','x > 5','x ‚â• 5','x ‚â• 0'],fb:'Expression under square root must be ‚â• 0. x ‚àí 5 ‚â• 0 ‚Üí x ‚â• 5.'},
  {q:'f(x) = x¬≤ + 1. What is the range?',correct:'y ‚â• 1',opts:['All real numbers','y ‚â• 0','y ‚â• 1','y > 1'],fb:'x¬≤ is always ‚â• 0, so x¬≤ + 1 ‚â• 1. Minimum output is 1 (when x = 0).'},
  {q:'f(x) = ‚àí(x ‚àí 2)¬≤ + 9. What is the range?',correct:'y ‚â§ 9',opts:['y ‚â• 9','y ‚â§ 9','All real numbers','y ‚â• ‚àí9'],fb:'Vertex at (2, 9), opens downward (a = ‚àí1). Maximum output is 9.'},
  {q:'A function models the height of a ball: h(t) = ‚àí16t¬≤ + 64t. What is a reasonable domain?',correct:'t ‚â• 0',opts:['All real numbers','t ‚â• 0','0 ‚â§ t ‚â§ 4','t > 0'],fb:'In context, time can\'t be negative. The ball hits the ground at t = 4, so 0 ‚â§ t ‚â§ 4 is the most precise domain (but t ‚â• 0 is the contextual minimum).'},
  {q:'f(x) = |x|. What is the range?',correct:'y ‚â• 0',opts:['All real numbers','y ‚â• 0','y > 0','y ‚â• 1'],fb:'Absolute value is always non-negative. |x| ‚â• 0 for all x. Range is y ‚â• 0.'},
];
let drAns={};
function ansDR(i,oi){if(drAns[i]!==undefined)return;drAns[i]=DR_QS[i].opts[oi];renderDR();}
function renderDR(){
  const total=DR_QS.length;const correct=Object.entries(drAns).filter(([i,v])=>v===DR_QS[i].correct).length;
  document.getElementById('drExercise').innerHTML=`<h3>üéØ Domain & Range</h3><div class="exercise-sub">Select the correct domain or range for each function.</div>`+DR_QS.map((q,i)=>{
    const ans=drAns[i];const has=ans!==undefined;
    return `<div class="ex-item"><div class="ex-num">Problem ${i+1}</div><div class="ex-prompt">${q.q}</div><div class="ex-options">${q.opts.map((o,oi)=>{let cls='ex-opt';if(has){cls+=' ex-dis';if(o===q.correct)cls+=' ex-correct';else if(o===ans&&o!==q.correct)cls+=' ex-wrong';}return `<div class="${cls}" onclick="ansDR(${i},${oi})">${o}</div>`;}).join('')}</div><div class="ex-fb${has?' show':''}${has?(ans===q.correct?' correct':' wrong'):''}">${has?(ans===q.correct?'‚úì Correct! ':'‚úó Incorrect. ')+q.fb:''}</div></div>`;
  }).join('')+mkScore('dr',correct,total);
}
renderDR();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// EXERCISE 3: TRANSFORMATION IDENTIFIER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const TFS=[
  {orig:'f(x)',transformed:'f(x) + 5',correct:'Shift UP 5',opts:['Shift UP 5','Shift RIGHT 5','Shift DOWN 5','Vertical stretch by 5']},
  {orig:'f(x)',transformed:'f(x ‚àí 4)',correct:'Shift RIGHT 4',opts:['Shift LEFT 4','Shift RIGHT 4','Shift DOWN 4','Shift UP 4']},
  {orig:'f(x)',transformed:'‚àíf(x)',correct:'Reflect over x-axis',opts:['Reflect over y-axis','Reflect over x-axis','Shift DOWN 1','Vertical compress']},
  {orig:'f(x)',transformed:'f(x + 2) ‚àí 3',correct:'Shift LEFT 2, DOWN 3',opts:['Shift RIGHT 2, DOWN 3','Shift LEFT 2, UP 3','Shift LEFT 2, DOWN 3','Shift RIGHT 2, UP 3']},
  {orig:'f(x)',transformed:'3f(x)',correct:'Vertical stretch by 3',opts:['Shift UP 3','Horizontal stretch by 3','Vertical stretch by 3','Shift RIGHT 3']},
  {orig:'f(x)',transformed:'f(‚àíx)',correct:'Reflect over y-axis',opts:['Reflect over x-axis','Reflect over y-axis','Shift LEFT','No change']},
  {orig:'f(x) = x¬≤',transformed:'g(x) = (x ‚àí 1)¬≤ + 6',correct:'Shift RIGHT 1, UP 6',opts:['Shift LEFT 1, UP 6','Shift RIGHT 1, UP 6','Shift RIGHT 1, DOWN 6','Shift LEFT 1, DOWN 6']},
  {orig:'f(x) = x¬≤',transformed:'g(x) = ¬Ωx¬≤',correct:'Vertical compression (flatter)',opts:['Vertical stretch (steeper)','Vertical compression (flatter)','Horizontal stretch','Shift DOWN ¬Ω']},
];
let tfAns={};
function ansTF(i,oi){if(tfAns[i]!==undefined)return;tfAns[i]=TFS[i].opts[oi];renderTFs();}
function renderTFs(){
  const total=TFS.length;const correct=Object.entries(tfAns).filter(([i,v])=>v===TFS[i].correct).length;
  document.getElementById('tfExercise').innerHTML=`<h3>üîÑ Name That Transformation</h3><div class="exercise-sub">How does the transformed function differ from the original?</div>`+TFS.map((t,i)=>{
    const ans=tfAns[i];const has=ans!==undefined;
    return `<div class="ex-item"><div class="ex-num">Problem ${i+1}</div><div class="ex-prompt">Original: <code>${t.orig}</code> ‚Üí Transformed: <code>${t.transformed}</code></div><div class="ex-options">${t.opts.map((o,oi)=>{let cls='ex-opt';if(has){cls+=' ex-dis';if(o===t.correct)cls+=' ex-correct';else if(o===ans&&o!==t.correct)cls+=' ex-wrong';}return `<div class="${cls}" onclick="ansTF(${i},${oi})">${o}</div>`;}).join('')}</div><div class="ex-fb${has?' show':''}${has?(ans===t.correct?' correct':' wrong'):''}">${has?(ans===t.correct?'‚úì Correct!':'‚úó Incorrect. The answer is: '+t.correct+'.')+(has&&i===1?' Remember: f(x ‚àí h) shifts RIGHT, not left!':'')+(has&&i===3?' Two transformations combined: +2 inside shifts LEFT, ‚àí3 outside shifts DOWN.':''):''}</div></div>`;
  }).join('')+mkScore('tf',correct,total);
}
renderTFs();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// EXERCISE 4: COMPOSITION WORKSHOP
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const COMPS=[
  {setup:'f(x) = 2x + 1, g(x) = x ‚àí 3',prompt:'Find f(g(5)).',answer:5,solution:'g(5) = 5 ‚àí 3 = 2. Then f(2) = 2(2) + 1 = 5.'},
  {setup:'f(x) = x¬≤, g(x) = x + 4',prompt:'Find f(g(1)).',answer:25,solution:'g(1) = 1 + 4 = 5. Then f(5) = 5¬≤ = 25.'},
  {setup:'f(x) = x¬≤, g(x) = x + 4',prompt:'Find g(f(1)).',answer:5,solution:'f(1) = 1¬≤ = 1. Then g(1) = 1 + 4 = 5. Note: g(f(1)) ‚â† f(g(1))!'},
  {setup:'f(x) = 3x, g(x) = x¬≤ ‚àí 1',prompt:'Find f(g(3)).',answer:24,solution:'g(3) = 9 ‚àí 1 = 8. Then f(8) = 3(8) = 24.'},
  {setup:'f(x) = x + 7, g(x) = 2x',prompt:'Find g(f(‚àí4)).',answer:6,solution:'f(‚àí4) = ‚àí4 + 7 = 3. Then g(3) = 2(3) = 6.'},
  {setup:'f(x) = |x|, g(x) = x ‚àí 10',prompt:'Find f(g(3)).',answer:7,solution:'g(3) = 3 ‚àí 10 = ‚àí7. Then f(‚àí7) = |‚àí7| = 7. Absolute value makes it positive!'},
  {setup:'f(x) = x¬≤ ‚àí 1, g(x) = |x ‚àí 5|',prompt:'Find f(g(2)).',answer:8,solution:'g(2) = |2 ‚àí 5| = |‚àí3| = 3. Then f(3) = 9 ‚àí 1 = 8. Nested with absolute value!'},
  {setup:'f(x) = 2x + 1, g(x) = f(x)',prompt:'Find f(f(3)). (Composing f with itself!)',answer:15,solution:'f(3) = 2(3) + 1 = 7. Then f(7) = 2(7) + 1 = 15. Self-composition!'},
];
let compAns={};
function renderComps(){
  const total=COMPS.length;const correct=Object.entries(compAns).filter(([i,v])=>v===true).length;
  document.getElementById('compExercise').innerHTML=`<h3>üîó Composition Practice</h3><div class="exercise-sub">Work inside-out: evaluate the inner function first. Includes absolute value and self-composition.</div>`+COMPS.map((c,i)=>{
    const ans=compAns[i];const has=ans!==undefined;
    return `<div class="ex-item"><div class="ex-num">Problem ${i+1}</div><div style="font-size:.85rem;color:var(--advanced);margin-bottom:6px">${c.setup}</div><div class="ex-prompt">${c.prompt}</div><div class="ex-input-row"><input class="ex-input${has?(ans?' inp-correct':' inp-wrong'):''}" id="cInp${i}" placeholder="?" ${has?'disabled':''} onkeydown="if(event.key==='Enter')checkComp(${i})"><button class="ex-btn" onclick="checkComp(${i})" ${has?'disabled':''}>Check</button></div><div class="ex-fb${has?' show':''}${has?(ans?' correct':' wrong'):''}">${has?(ans?'‚úì Correct! ':'‚úó Incorrect. ')+c.solution:''}</div></div>`;
  }).join('')+mkScore('co',correct,total);
}
function checkComp(i){var v=parseFloat(document.getElementById('cInp'+i).value);compAns[i]=Math.abs(v-COMPS[i].answer)<0.01;renderComps();}
renderComps();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// EXERCISE 5: FUNCTION BEHAVIOR CLASSIFIER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const BEH_QS=[
  {q:'f(x) = 3x + 5. As x increases, f(x)‚Ä¶',correct:'Always increases (positive slope)',opts:['Always increases (positive slope)','Always decreases','Increases then decreases','Stays constant'],fb:'Linear with positive slope (m = 3). Always increasing.'},
  {q:'f(x) = ‚àíx¬≤ + 4. On the interval x > 0, f(x)‚Ä¶',correct:'Decreases',opts:['Increases','Decreases','Stays constant','Increases then decreases'],fb:'This is a downward parabola with vertex at (0, 4). For x > 0, we\'re on the right side of the vertex ‚Üí decreasing.'},
  {q:'f(x) = 2À£. As x ‚Üí ‚àí‚àû, f(x) approaches‚Ä¶',correct:'0 (but never reaches it)',opts:['‚àí‚àû','0 (but never reaches it)','1','2'],fb:'Exponential growth: as x gets very negative, 2À£ gets tiny (0.5, 0.25, 0.125‚Ä¶) ‚Üí approaches 0. The x-axis is a horizontal asymptote.'},
  {q:'f(x) = 1/x. The graph has‚Ä¶',correct:'A vertical asymptote at x = 0',opts:['No asymptotes','A horizontal asymptote at y = 1','A vertical asymptote at x = 0','A hole at x = 0'],fb:'Can\'t divide by 0, so x = 0 is a vertical asymptote. The graph approaches but never touches the y-axis.'},
  {q:'f(x) = |x ‚àí 3|. The minimum value of f(x) is‚Ä¶',correct:'0, occurring at x = 3',opts:['3, occurring at x = 0','0, occurring at x = 3','‚àí3, occurring at x = 0','No minimum'],fb:'|x ‚àí 3| ‚â• 0 always. It equals 0 when x = 3. The vertex of the V-shape is at (3, 0).'},
  {q:'f(x) = x¬≥. The end behavior is‚Ä¶',correct:'As x ‚Üí ‚àí‚àû, f ‚Üí ‚àí‚àû; as x ‚Üí +‚àû, f ‚Üí +‚àû',opts:['Both ends go up','Both ends go down','As x ‚Üí ‚àí‚àû, f ‚Üí ‚àí‚àû; as x ‚Üí +‚àû, f ‚Üí +‚àû','As x ‚Üí ‚àí‚àû, f ‚Üí +‚àû; as x ‚Üí +‚àû, f ‚Üí ‚àí‚àû'],fb:'Odd degree, positive leading coefficient ‚Üí left goes down, right goes up.'},
];
let behAns={};
function ansBeh(i,oi){if(behAns[i]!==undefined)return;behAns[i]=BEH_QS[i].opts[oi];renderBeh();}
function renderBeh(){
  const total=BEH_QS.length;const correct=Object.entries(behAns).filter(([i,v])=>v===BEH_QS[i].correct).length;
  document.getElementById('behaviorEx').innerHTML=`<h3>üìä How Does It Behave?</h3><div class="exercise-sub">Classify each function's behavior without graphing.</div>`+BEH_QS.map((q,i)=>{
    const ans=behAns[i];const has=ans!==undefined;
    return `<div class="ex-item"><div class="ex-num">Problem ${i+1}</div><div class="ex-prompt">${q.q}</div><div class="ex-options">${q.opts.map((o,oi)=>{let cls='ex-opt';if(has){cls+=' ex-dis';if(o===q.correct)cls+=' ex-correct';else if(o===ans&&o!==q.correct)cls+=' ex-wrong';}return `<div class="${cls}" onclick="ansBeh(${i},${oi})">${o}</div>`;}).join('')}</div><div class="ex-fb${has?' show':''}${has?(ans===q.correct?' correct':' wrong'):''}">${has?(ans===q.correct?'‚úì Correct! ':'‚úó Incorrect. ')+q.fb:''}</div></div>`;
  }).join('')+mkScore('bh',correct,total);
}
renderBeh();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TIMED PRACTICE WITH CONFIDENCE & ERROR ANALYSIS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const PST=[
  {t:1,tp:'4A',q:'If f(x) = 4x ‚àí 9, what is the value of f(3)?',ch:['3','12','‚àí9','21'],c:0,fb:'f(3) = 4(3) ‚àí 9 = 12 ‚àí 9 = 3.',
   trap:null,trapAnswer:1,trapDesc:'Evaluated 4(3) but forgot to subtract 9'},
  {t:1,tp:'4B',q:'The graph of g(x) = x¬≤ is shifted 5 units to the right. Which equation represents the new graph?',ch:['g(x) = x¬≤ + 5','g(x) = (x + 5)¬≤','g(x) = (x ‚àí 5)¬≤','g(x) = x¬≤ ‚àí 5'],c:2,fb:'Shifting right h units: f(x ‚àí h). So (x ‚àí 5)¬≤. Horizontal shifts work backward!',
   trap:'horizontal_flip',trapAnswer:1,trapDesc:'Confused direction of horizontal shift ‚Äî Horizontal Flip'},
  {t:1,tp:'4C',q:'If f(x) = x + 2 and g(x) = 3x, what is g(f(4))?',ch:['14','18','10','6'],c:1,fb:'f(4) = 4 + 2 = 6. Then g(6) = 3(6) = 18.',
   trap:'composition_swap',trapAnswer:0,trapDesc:'Evaluated f(g(4)) instead of g(f(4)) ‚Äî Composition Swap'},
  {t:2,tp:'4B',q:'The function f(x) = ‚àí2(x + 3)¬≤ + 8 has a vertex at:',ch:['(3, 8)','(‚àí3, 8)','(‚àí3, ‚àí8)','(3, ‚àí8)'],c:1,fb:'f(x) = ‚àí2(x ‚àí (‚àí3))¬≤ + 8. Vertex: (‚àí3, 8).',
   trap:'horizontal_flip',trapAnswer:0,trapDesc:'Took the sign of h at face value ‚Äî Horizontal Flip'},
  {t:2,tp:'4A',q:'If f(x) = x¬≤ ‚àí 4 and the domain is restricted to x ‚â• 0, what is the range?',ch:['y ‚â• ‚àí4','y ‚â• 0','y ‚â• 4','All real numbers'],c:0,fb:'When x = 0, f(0) = ‚àí4 (minimum). As x increases, f(x) increases. Range: y ‚â• ‚àí4.',
   trap:'imposter_domain',trapAnswer:1,trapDesc:'Ignored that f(0) = ‚àí4 because x ‚â• 0 includes 0 ‚Äî Imposter Domain'},
  {t:2,tp:'4B',q:'y = f(x) is reflected over the x-axis and shifted up 3. The result is:',ch:['y = ‚àíf(x) + 3','y = f(‚àíx) + 3','y = ‚àíf(x + 3)','y = f(‚àíx + 3)'],c:0,fb:'Reflect over x-axis: ‚àíf(x). Then shift up 3: ‚àíf(x) + 3.',
   trap:'horizontal_flip',trapAnswer:1,trapDesc:'Used f(‚àíx) instead of ‚àíf(x) for x-axis reflection ‚Äî Horizontal Flip'},
  {t:2,tp:'4A',q:'f(x) = ‚àö(2x ‚àí 6). What is the domain?',ch:['x ‚â• 0','x ‚â• 3','x ‚â• 6','All real numbers'],c:1,fb:'Need 2x ‚àí 6 ‚â• 0 ‚Üí 2x ‚â• 6 ‚Üí x ‚â• 3.',
   trap:'imposter_domain',trapAnswer:2,trapDesc:'Set 2x ‚àí 6 = 6 instead of 2x ‚àí 6 ‚â• 0 ‚Äî Imposter Domain'},
  {t:3,tp:'4D',q:'The system y = x¬≤ + 2 and y = 4x ‚àí 1 has how many real solutions?',ch:['0','1','2','Infinitely many'],c:2,fb:'Set equal: x¬≤ + 2 = 4x ‚àí 1 ‚Üí x¬≤ ‚àí 4x + 3 = 0 ‚Üí (x‚àí1)(x‚àí3) = 0. Two solutions: x = 1 and x = 3.',
   trap:null,trapAnswer:1,trapDesc:'Miscalculated the discriminant'},
  {t:3,tp:'4C',q:'If f(x) = 2x + 3, what is f(f(2))?',ch:['7','17','37','14'],c:1,fb:'f(2) = 2(2) + 3 = 7. Then f(7) = 2(7) + 3 = 17.',
   trap:'wrong_target',trapAnswer:0,trapDesc:'Stopped after computing f(2) instead of f(f(2)) ‚Äî Wrong Target'},
  {t:3,tp:'4B',q:'The graph of y = f(x) passes through (2, 5). After the transformation y = 3f(x ‚àí 1) + 2, what point must be on the new graph?',ch:['(3, 17)','(1, 17)','(3, 15)','(2, 17)'],c:0,fb:'x ‚àí 1 = 2 ‚Üí x = 3. y = 3¬∑f(2) + 2 = 3(5) + 2 = 17. The point (3, 17) is on the new graph.',
   trap:'horizontal_flip',trapAnswer:1,trapDesc:'Subtracted 1 from x instead of adding ‚Äî Horizontal Flip'},
];

const TRAP_NAMES = {'horizontal_flip':'üîÑ Horizontal Flip','wrong_target':'üéØ Wrong Target','imposter_domain':'üé≠ Imposter Domain','composition_swap':'üìê Composition Swap'};

let pstA = {}, pstConf = {}, pstTime = {}, pstStartTime = null;

// Timer system
let timerEnabled = false;
let timerInterval = null;
let timerSeconds = 0;
const SECS_PER_Q = 95;
let totalTimerSecs = PST.length * SECS_PER_Q; // 95 √ó 10 = 950 seconds = 15:50

function toggleTimer() {
  timerEnabled = !timerEnabled;
  const btn = document.getElementById('timerToggle');
  btn.textContent = timerEnabled ? '‚è± Timer ON' : '‚è± Timer OFF';
  btn.classList.toggle('active', timerEnabled);
  if (!timerEnabled && timerInterval) {
    clearInterval(timerInterval); timerInterval = null;
    document.getElementById('timerDisplay').textContent = '--:--';
    document.getElementById('timerFill').style.width = '100%';
  } else if (timerEnabled && currentScreen === 3) { startTimer(); }
}

function startTimer() {
  if (timerInterval) clearInterval(timerInterval);
  timerSeconds = totalTimerSecs;
  updateTimerDisplay();
  timerInterval = setInterval(() => {
    timerSeconds--;
    updateTimerDisplay();
    if (timerSeconds <= 0) { clearInterval(timerInterval); timerInterval = null; }
  }, 1000);
  pstStartTime = Date.now();
}

function updateTimerDisplay() {
  const disp = document.getElementById('timerDisplay');
  const fill = document.getElementById('timerFill');
  const mins = Math.floor(timerSeconds / 60), secs = timerSeconds % 60;
  disp.textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
  const pct = (timerSeconds / totalTimerSecs) * 100;
  fill.style.width = pct + '%';
  disp.className = 'timer-display'; fill.className = 'timer-fill';
  if (pct < 15) { disp.classList.add('danger'); fill.classList.add('danger'); }
  else if (pct < 35) { disp.classList.add('warning'); fill.classList.add('warning'); }
}

function renderPST() {
  const answered = Object.keys(pstA).length;
  document.getElementById('qDots').innerHTML = PST.map((_, i) => {
    let cls = 'q-dot';
    if (pstA[i] !== undefined) cls += pstA[i] === PST[i].c ? ' correct' : ' wrong';
    return `<div class="${cls}"></div>`;
  }).join('');

  document.getElementById('psatPractice').innerHTML = PST.map((q, i) => {
    const a = pstA[i], h = a !== undefined;
    const conf = pstConf[i];
    const tierLabel = q.t === 1 ? 'Easy' : q.t === 2 ? 'Medium' : 'Hard';
    const trapName = q.trap ? TRAP_NAMES[q.trap] || '' : '';
    return `<div class="ex-item" style="border-color:${q.t===1?'var(--algebra)':q.t===2?'var(--math)':'var(--advanced)'}">
      <div style="margin-bottom:6px;display:flex;align-items:center;gap:8px;flex-wrap:wrap">
        <span class="tier tier-${q.t}">${tierLabel}</span>
        <span style="font-size:.75rem;color:var(--muted)">Topic ${q.tp}</span>
        ${trapName && h ? `<span style="font-size:.72rem;color:var(--accent)">Trap: ${trapName}</span>` : ''}
      </div>
      <div class="ex-prompt">${q.q}</div>
      ${!h ? `<div class="confidence-row">
        <div class="conf-tag ${conf==='guessing'?'selected':''}" data-conf="guessing" onclick="setConf(${i},'guessing')">Guessing</div>
        <div class="conf-tag ${conf==='unsure'?'selected':''}" data-conf="unsure" onclick="setConf(${i},'unsure')">Unsure</div>
        <div class="conf-tag ${conf==='confident'?'selected':''}" data-conf="confident" onclick="setConf(${i},'confident')">Confident</div>
      </div>` : `<div style="font-size:.72rem;color:var(--muted);margin-bottom:6px">Confidence: ${conf || 'not tagged'}</div>`}
      <div class="mc-choices">${q.ch.map((ch, ci) => {
        let c = 'mc-choice';
        if (h) { c += ' mc-dis'; if (ci === q.c) c += ' mc-correct'; else if (ci === a) c += ' mc-wrong'; }
        return `<div class="${c}" onclick="aPST(${i},${ci})"><div class="mc-letter">${'ABCD'[ci]}</div><div>${ch}</div></div>`;
      }).join('')}</div>
      <div class="mc-fb${h ? ' show' : ''}">${h ? (a === q.c ? '‚úì Correct! ' : '‚úó Incorrect. ') + q.fb + (a !== q.c && q.trapAnswer === a ? '<br><span style="color:var(--psda)">‚ö†Ô∏è ' + q.trapDesc + '</span>' : '') : ''}</div>
    </div>`;
  }).join('');

  if (answered === PST.length) {
    if (timerInterval) { clearInterval(timerInterval); timerInterval = null; }
    document.getElementById('practiceNav').style.display = 'block';
    showPracticeResults();
  }
}

function setConf(i, level) { if (pstA[i] !== undefined) return; pstConf[i] = level; renderPST(); }

function aPST(i, v) {
  if (pstA[i] !== undefined) return;
  pstA[i] = v;
  if (pstStartTime) { pstTime[i] = Date.now() - pstStartTime; pstStartTime = Date.now(); }
  renderPST();
}

function showPracticeResults() {
  const total = PST.length;
  const correct = Object.entries(pstA).filter(([i, v]) => v === PST[i].c).length;
  const byDiff = {1:{cor:0,tot:0},2:{cor:0,tot:0},3:{cor:0,tot:0}};
  PST.forEach((q, i) => { byDiff[q.t].tot++; if (pstA[i] === q.c) byDiff[q.t].cor++; });
  const matrix = {};
  ['guessing','unsure','confident'].forEach(conf => { matrix[conf] = {correct:[], wrong:[]}; });
  PST.forEach((q, i) => { const conf = pstConf[i] || 'unsure'; matrix[conf][pstA[i] === q.c ? 'correct' : 'wrong'].push(i); });
  const errors = {content_gap:[], trap_answer:[], careless:[], calibration:[]};
  PST.forEach((q, i) => {
    if (pstA[i] === q.c) return;
    const conf = pstConf[i] || 'unsure';
    if (pstA[i] === q.trapAnswer) errors.trap_answer.push({i, desc:q.trapDesc, topic:q.tp});
    else errors.content_gap.push({i, topic:q.tp});
    if (conf === 'confident') { if (q.t === 1) errors.careless.push({i, topic:q.tp}); errors.calibration.push({i, topic:q.tp}); }
  });

  let html = `<div class="results-section"><h3>üìä Practice Results: ${correct}/${total}</h3>
    <div style="margin-bottom:20px"><div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:8px">By Difficulty</div>
    <div class="difficulty-bars">
      <div class="diff-row"><span class="diff-label" style="color:var(--algebra)">Easy</span><div class="diff-track"><div class="diff-fill" style="width:${byDiff[1].tot?byDiff[1].cor/byDiff[1].tot*100:0}%;background:var(--algebra)"></div></div><span class="diff-val" style="color:var(--algebra)">${byDiff[1].cor}/${byDiff[1].tot}</span></div>
      <div class="diff-row"><span class="diff-label" style="color:var(--math)">Medium</span><div class="diff-track"><div class="diff-fill" style="width:${byDiff[2].tot?byDiff[2].cor/byDiff[2].tot*100:0}%;background:var(--math)"></div></div><span class="diff-val" style="color:var(--math)">${byDiff[2].cor}/${byDiff[2].tot}</span></div>
      <div class="diff-row"><span class="diff-label" style="color:var(--advanced)">Hard</span><div class="diff-track"><div class="diff-fill" style="width:${byDiff[3].tot?byDiff[3].cor/byDiff[3].tot*100:0}%;background:var(--advanced)"></div></div><span class="diff-val" style="color:var(--advanced)">${byDiff[3].cor}/${byDiff[3].tot}</span></div>
    </div></div>`;

  html += `<div style="margin-bottom:20px"><div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:8px">Confidence √ó Accuracy Matrix</div>
    <div class="results-grid">
      <div class="results-grid-header"></div><div class="results-grid-header">Guessing</div><div class="results-grid-header">Unsure</div><div class="results-grid-header">Confident</div>
      <div class="results-grid-header" style="writing-mode:horizontal-tb">‚úì Correct</div>
      <div class="results-grid-cell"><div class="cell-label">Lucky</div><div class="cell-dots">${matrix.guessing.correct.map(()=>'<div class="cell-dot" style="background:var(--psda)"></div>').join('')}</div><div style="font-size:.7rem;color:var(--muted)">${matrix.guessing.correct.length}</div></div>
      <div class="results-grid-cell"><div class="cell-label">Developing</div><div class="cell-dots">${matrix.unsure.correct.map(()=>'<div class="cell-dot" style="background:var(--math)"></div>').join('')}</div><div style="font-size:.7rem;color:var(--muted)">${matrix.unsure.correct.length}</div></div>
      <div class="results-grid-cell"><div class="cell-label">Solid</div><div class="cell-dots">${matrix.confident.correct.map(()=>'<div class="cell-dot" style="background:var(--correct)"></div>').join('')}</div><div style="font-size:.7rem;color:var(--muted)">${matrix.confident.correct.length}</div></div>
      <div class="results-grid-header" style="writing-mode:horizontal-tb">‚úó Wrong</div>
      <div class="results-grid-cell"><div class="cell-label">Expected</div><div class="cell-dots">${matrix.guessing.wrong.map(()=>'<div class="cell-dot" style="background:var(--muted)"></div>').join('')}</div><div style="font-size:.7rem;color:var(--muted)">${matrix.guessing.wrong.length}</div></div>
      <div class="results-grid-cell"><div class="cell-label">Needs work</div><div class="cell-dots">${matrix.unsure.wrong.map(()=>'<div class="cell-dot" style="background:var(--psda)"></div>').join('')}</div><div style="font-size:.7rem;color:var(--muted)">${matrix.unsure.wrong.length}</div></div>
      <div class="results-grid-cell danger-cell"><div class="cell-label" style="color:var(--wrong);font-weight:700">‚ö†Ô∏è DANGER</div><div class="cell-dots">${matrix.confident.wrong.map(()=>'<div class="cell-dot" style="background:var(--wrong)"></div>').join('')}</div><div style="font-size:.7rem;color:var(--wrong)">${matrix.confident.wrong.length}</div></div>
    </div>
    ${matrix.confident.wrong.length > 0 ? '<div class="callout" style="border-color:var(--wrong);background:var(--wrong-bg)"><strong style="color:var(--wrong)">Confident + Wrong</strong> is the most dangerous category. These errors persist into test day because you won\'t self-correct what you think you already know.</div>' : ''}
  </div>`;

  const hasErrors = errors.trap_answer.length + errors.content_gap.length > 0;
  if (hasErrors) {
    html += `<div style="margin-bottom:16px"><div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:8px">Error Pattern Analysis</div>`;
    if (errors.trap_answer.length > 0) html += `<div class="error-category" style="background:rgba(251,191,36,.08);border:1px solid rgba(251,191,36,.3)"><div class="error-label" style="color:var(--psda)">üü° Trap Answers (${errors.trap_answer.length})</div><div class="error-items">${errors.trap_answer.map(e => e.desc).join(' ¬∑ ')}</div></div>`;
    if (errors.content_gap.length > 0) html += `<div class="error-category" style="background:rgba(239,68,68,.08);border:1px solid rgba(239,68,68,.3)"><div class="error-label" style="color:var(--wrong)">üî¥ Content Gaps (${errors.content_gap.length})</div><div class="error-items">Topics: ${[...new Set(errors.content_gap.map(e=>e.topic))].join(', ')}</div></div>`;
    if (errors.careless.length > 0) html += `<div class="error-category" style="background:rgba(96,165,250,.08);border:1px solid rgba(96,165,250,.3)"><div class="error-label" style="color:var(--math)">üîµ Possible Careless Errors (${errors.careless.length})</div><div class="error-items">Confident + wrong on easy questions ‚Äî likely arithmetic mistakes</div></div>`;
    if (errors.calibration.length > 0) html += `<div class="error-category" style="background:rgba(239,68,68,.08);border:1px solid rgba(239,68,68,.3)"><div class="error-label" style="color:var(--wrong)">‚ö†Ô∏è Calibration Issues (${errors.calibration.length})</div><div class="error-items">You were confident but wrong ‚Äî review these topics carefully</div></div>`;
    html += `</div>`;
  }
  html += `</div>`;
  document.getElementById('practiceResults').style.display = 'block';
  document.getElementById('practiceResults').innerHTML = html;

  document.getElementById('completePracticeStats').innerHTML = `
    <div style="background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px 20px;margin-bottom:24px;max-width:500px;width:100%;text-align:left">
      <div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:8px">Practice Results</div>
      <div style="font-family:'JetBrains Mono',monospace;font-size:1.4rem;font-weight:700;color:var(--correct);margin-bottom:8px">${correct}/${total} correct</div>
      <div style="font-size:.82rem;color:var(--muted)">Easy: ${byDiff[1].cor}/${byDiff[1].tot} ¬∑ Medium: ${byDiff[2].cor}/${byDiff[2].tot} ¬∑ Hard: ${byDiff[3].cor}/${byDiff[3].tot}</div>
    </div>`;
}

renderPST();
</script>
<script src="/translate.js"></script>
</body>
</html>
