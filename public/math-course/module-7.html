<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Module 7: Desmos Mastery ‚Äî SAT Math ‚Äî PantherPrep</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=Source+Sans+3:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root{--ink:#f0f0f0;--paper:#121212;--accent:#C8102E;--accent-light:rgba(200,16,46,.15);--border:#2a2a2a;--muted:#999;--surface:#1a1a1a;--math:#60a5fa;--math-bg:rgba(96,165,250,.1);--algebra:#34d399;--algebra-bg:rgba(52,211,153,.1);--advanced:#a78bfa;--adv-bg:rgba(167,139,250,.1);--psda:#fbbf24;--psda-bg:rgba(251,191,36,.1);--geotrig:#f87171;--geotrig-bg:rgba(248,113,113,.1);--des:#2bc4a9;--des-bg:rgba(43,196,169,.1);--correct:#22c55e;--correct-bg:rgba(34,197,94,.12);--wrong:#ef4444;--wrong-bg:rgba(239,68,68,.12);--danger:#ef4444;--danger-bg:rgba(239,68,68,.08);--grad:linear-gradient(135deg,var(--des),#60a5fa)}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Source Sans 3',sans-serif;background:var(--paper);color:var(--ink);line-height:1.65;overflow-x:hidden}
.top-stripe{height:4px;background:linear-gradient(90deg,#C8102E 0%,#C8102E 50%,#fff 50%,#fff 100%);position:fixed;top:0;left:0;right:0;z-index:100}

.screen{display:none;opacity:0;transition:opacity .4s ease;min-height:100vh}
.screen.active{display:block;opacity:1}
.screen.fade-in{animation:fadeIn .4s ease forwards}
.screen.fade-out{animation:fadeOut .3s ease forwards}
@keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeOut{from{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-12px)}}

.screen-progress{position:fixed;top:12px;left:50%;transform:translateX(-50%);display:flex;gap:8px;z-index:101;padding:6px 14px;background:rgba(18,18,18,.85);backdrop-filter:blur(8px);border-radius:20px;border:1px solid var(--border)}
.screen-dot{width:8px;height:8px;border-radius:50%;background:var(--border);transition:all .3s;cursor:pointer}
.screen-dot.completed{background:var(--des)}
.screen-dot.current{background:var(--accent);box-shadow:0 0 8px rgba(200,16,46,.5);transform:scale(1.25)}
.screen-dot:hover{transform:scale(1.3)}

.container{max-width:800px;margin:0 auto;padding:20px 20px 60px}

.welcome-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:40px 20px;text-align:center}
.welcome-badge{display:inline-block;background:var(--des);color:#111;font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:5px 14px;border-radius:16px;margin-bottom:18px}
.welcome-screen h1{font-family:'Cormorant Garamond',serif;font-size:clamp(2rem,5vw,3rem);font-weight:700;margin-bottom:8px;max-width:600px;background:var(--grad);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.welcome-sub{color:var(--muted);font-size:1.05rem;max-width:500px;margin:0 auto 32px}
.welcome-meta{display:flex;gap:24px;justify-content:center;margin-bottom:36px;font-size:.85rem;color:var(--muted)}
.preview-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;max-width:600px;width:100%;margin-bottom:40px}
.preview-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px 14px;text-align:left;transition:all .2s}
.preview-card:hover{border-color:var(--des);transform:translateY(-2px)}
.preview-icon{font-size:1.4rem;margin-bottom:8px}
.preview-title{font-size:.82rem;font-weight:700;margin-bottom:3px}
.preview-desc{font-size:.72rem;color:var(--muted);line-height:1.4}
.start-btn{padding:14px 36px;background:var(--grad);color:#111;border:none;border-radius:10px;font-size:1rem;font-weight:700;cursor:pointer;transition:all .2s;font-family:'Source Sans 3',sans-serif}
.start-btn:hover{filter:brightness(1.15);transform:translateY(-1px);box-shadow:0 6px 20px rgba(43,196,169,.3)}

.warmup-container{max-width:600px;margin:0 auto;padding:60px 20px}
.warmup-header{text-align:center;margin-bottom:32px}
.warmup-badge{display:inline-block;background:var(--geotrig);color:#fff;font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:4px 12px;border-radius:12px;margin-bottom:12px}
.warmup-dots{display:flex;gap:8px;justify-content:center;margin-top:16px}
.warmup-dot{width:10px;height:10px;border-radius:50%;background:var(--border);transition:all .3s}
.warmup-dot.done-correct{background:var(--correct)}
.warmup-dot.done-wrong{background:var(--wrong)}
.warmup-dot.active{background:var(--geotrig);box-shadow:0 0 8px rgba(248,113,113,.4)}
.warmup-q{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:24px;margin-bottom:16px}
.warmup-q .source-tag{font-size:.7rem;color:var(--geotrig);font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:8px}
.warmup-q .q-text{font-size:.95rem;line-height:1.7;margin-bottom:14px}
.warmup-choices{display:flex;flex-direction:column;gap:8px}
.warmup-choice{display:flex;align-items:center;gap:10px;padding:11px 14px;background:var(--paper);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.88rem;transition:all .15s}
.warmup-choice:hover:not(.wu-dis){border-color:var(--geotrig);background:rgba(248,113,113,.05)}
.warmup-choice.wu-correct{border-color:var(--correct);background:var(--correct-bg)}
.warmup-choice.wu-wrong{border-color:var(--wrong);background:var(--wrong-bg)}
.warmup-choice.wu-dis{pointer-events:none;opacity:.7}
.warmup-choice.wu-correct{opacity:1}
.warmup-fb{font-size:.85rem;color:var(--muted);line-height:1.6;margin-top:12px;padding:10px;background:var(--paper);border-radius:8px;border-left:3px solid var(--correct)}
.warmup-next{padding:10px 24px;background:var(--geotrig);color:#fff;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:.88rem;margin-top:12px;font-family:'Source Sans 3',sans-serif}
.warmup-next:hover{filter:brightness(1.1)}
.warmup-summary{text-align:center;padding:40px 20px}
.warmup-score{font-family:'JetBrains Mono',monospace;font-size:2.4rem;font-weight:700;color:var(--geotrig);margin:12px 0}
.warmup-continue{padding:12px 28px;background:var(--des);color:#111;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:.95rem;margin-top:20px;font-family:'Source Sans 3',sans-serif}
.warmup-continue:hover{filter:brightness(1.15)}

.back-link{display:inline-flex;align-items:center;gap:8px;color:var(--muted);font-size:.9rem;padding:8px 0;margin-top:8px;cursor:pointer;text-decoration:none}
.back-link:hover{color:var(--accent)}
.mod-header{padding:40px 0 30px;border-bottom:1px solid var(--border);margin-bottom:32px}
.mod-badge{display:inline-block;background:var(--des);color:#111;font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:5px 14px;border-radius:16px;margin-bottom:14px}
.mod-header h1{font-family:'Cormorant Garamond',serif;font-size:clamp(1.8rem,4vw,2.6rem);font-weight:700;margin-bottom:6px}
.mod-header .subtitle{color:var(--muted);font-size:1rem}
.mod-meta{display:flex;gap:20px;margin-top:14px;font-size:.82rem;color:var(--muted)}
.section{margin-bottom:36px}
.section-label{font-size:.7rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--des);margin-bottom:6px}
.section h2{font-family:'Cormorant Garamond',serif;font-size:1.6rem;font-weight:700;margin-bottom:12px}
.section p{color:#ccc;font-size:.93rem;margin-bottom:12px;line-height:1.7}
.card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:18px 20px;margin-bottom:12px}
.card-accent{border-left:3px solid var(--accent)}
.callout{background:var(--accent-light);border:1px solid rgba(200,16,46,.3);border-radius:10px;padding:14px 18px;margin-bottom:16px;font-size:.9rem}
.callout strong{color:var(--accent)}
.callout-des{background:var(--des-bg);border-color:rgba(43,196,169,.3)}
.callout-des strong{color:var(--des)}
.topic{background:var(--surface);border:1px solid var(--border);border-radius:14px;margin-bottom:10px;overflow:hidden;transition:all .2s}
.topic-header{display:flex;align-items:center;gap:12px;padding:14px 18px;cursor:pointer}
.topic-header:hover{background:rgba(43,196,169,.05)}
.topic-badge{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:700;color:#111;flex-shrink:0}
.topic-info{flex:1}
.topic-title{font-weight:700;font-size:.95rem}
.topic-sub{font-size:.78rem;color:var(--muted)}
.topic-arrow{color:var(--muted);font-size:.9rem;transition:transform .2s;flex-shrink:0}
.topic.open .topic-arrow{transform:rotate(90deg)}
.topic-body{display:none;padding:0 18px 18px;font-size:.93rem;color:#ccc;line-height:1.7}
.topic.open .topic-body{display:block}
.topic-body h4{color:var(--ink);font-size:.9rem;margin:14px 0 6px;text-transform:uppercase;letter-spacing:.5px}
.topic-body ul{padding-left:18px;margin-bottom:10px}
.topic-body li{margin-bottom:6px}

/* SKILL TABLE */
.skill-table{width:100%;border-collapse:collapse;font-size:.85rem;margin-bottom:16px}
.skill-table th,.skill-table td{padding:10px 12px;border:1px solid var(--border);text-align:left;vertical-align:top}
.skill-table th{background:var(--surface);font-weight:700;font-size:.75rem;text-transform:uppercase;letter-spacing:.5px;color:var(--muted)}
.skill-table code{background:var(--des-bg);color:var(--des);padding:1px 6px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:.82rem}
.skill-num{display:inline-block;width:20px;height:20px;border-radius:50%;background:var(--des);color:#111;text-align:center;font-size:.72rem;font-weight:700;line-height:20px;margin-right:6px}

/* SHORTCUT GRID */
.sc-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:16px}
.sc-card{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center}
.sc-card:hover{border-color:var(--des)}
.sc-key{font-family:'JetBrains Mono',monospace;font-size:1.1rem;font-weight:700;color:var(--des);margin-bottom:4px}
.sc-desc{font-size:.78rem;color:var(--muted)}

/* DO / DON'T */
.do-dont{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px}
.do-card,.dont-card{background:var(--surface);border-radius:12px;padding:16px;font-size:.88rem}
.do-card{border:2px solid var(--correct)}
.dont-card{border:2px solid var(--wrong)}
.do-card h4{color:var(--correct);margin-bottom:8px}
.dont-card h4{color:var(--wrong);margin-bottom:8px}
.do-card li,.dont-card li{color:#ccc;margin-bottom:4px;line-height:1.5}

/* EXERCISES */
.exercise{background:var(--surface);border:2px solid var(--des);border-radius:14px;padding:22px;margin-bottom:16px}
.exercise h3{font-family:'Cormorant Garamond',serif;font-size:1.15rem;margin-bottom:4px}
.exercise-sub{font-size:.82rem;color:var(--muted);margin-bottom:14px}
.ex-item{background:var(--paper);border-radius:10px;padding:14px;margin-bottom:10px;border:1px solid var(--border)}
.ex-prompt{font-size:.93rem;margin-bottom:10px;line-height:1.6;color:#ddd}
.ex-prompt code{background:var(--des-bg);color:var(--des);padding:1px 6px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:.85rem}

/* CLASSIFY OPTIONS */
.classify-opts{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:4px}
.classify-opt{padding:6px 14px;background:var(--surface);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.82rem;transition:all .15s}
.classify-opt:hover:not(.cl-dis){border-color:var(--des);background:var(--des-bg)}
.classify-opt.cl-correct{border-color:var(--correct);background:var(--correct-bg);color:var(--correct)}
.classify-opt.cl-wrong{border-color:var(--wrong);background:var(--wrong-bg);color:var(--wrong)}
.classify-opt.cl-dis{pointer-events:none;opacity:.7}
.ex-fb{font-size:.85rem;padding:8px 12px;border-radius:6px;margin-top:8px;display:none;line-height:1.5}
.ex-fb.show{display:block}
.ex-fb.correct{background:var(--correct-bg);color:var(--correct);border:1px solid var(--correct)}
.ex-fb.wrong{background:var(--wrong-bg);color:var(--wrong);border:1px solid var(--wrong)}

/* DD BUTTONS (Desmos vs Algebra) */
.dd-btns{display:flex;gap:8px}
.dd-btn{padding:8px 20px;border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.88rem;font-weight:600;transition:all .15s}
.dd-btn:first-child{color:var(--des)}
.dd-btn:last-child{color:var(--psda)}
.dd-btn:hover:not(.dd-dis){border-color:var(--des);background:var(--des-bg)}
.dd-btn.dd-correct{border-color:var(--correct);background:var(--correct-bg);color:var(--correct)}
.dd-btn.dd-wrong{border-color:var(--wrong);background:var(--wrong-bg);color:var(--wrong)}
.dd-btn.dd-dis{pointer-events:none;opacity:.7}

/* MC CHOICES */
.mc-choices{display:flex;flex-direction:column;gap:6px}
.mc-choice{padding:10px 14px;background:var(--surface);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.88rem;transition:all .15s;display:flex;align-items:center;gap:10px}
.mc-choice:hover:not(.mc-dis){border-color:var(--des);background:var(--des-bg)}
.mc-letter{font-weight:700;color:var(--muted);min-width:24px;font-family:'JetBrains Mono',monospace}
.mc-choice.mc-correct{border-color:var(--correct);background:var(--correct-bg)}
.mc-choice.mc-wrong{border-color:var(--wrong);background:var(--wrong-bg)}
.mc-choice.mc-dis{pointer-events:none;opacity:.7}
.mc-choice.mc-correct .mc-letter{color:var(--correct)}.mc-choice.mc-wrong .mc-letter{color:var(--wrong)}
.mc-fb{font-size:.85rem;color:var(--muted);line-height:1.6;margin-top:8px;display:none;border-left:3px solid var(--correct);background:var(--paper);padding:8px 12px;border-radius:6px}.mc-fb.show{display:block}

/* SCORE BAR */
.score-bar{display:flex;align-items:center;gap:10px;margin-top:14px;padding-top:10px;border-top:1px solid var(--border)}
.score-bar-label{font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted)}
.score-bar-track{flex:1;height:6px;border-radius:3px;background:var(--border);overflow:hidden}
.score-bar-fill{height:100%;border-radius:3px;background:var(--correct);transition:width .4s ease}
.score-bar-val{font-family:'JetBrains Mono',monospace;font-size:.85rem;font-weight:700;color:var(--correct);min-width:36px;text-align:right}
.tier{font-size:.68rem;font-weight:700;letter-spacing:1px;text-transform:uppercase;padding:2px 8px;border-radius:4px;margin-right:8px}
.tier-1{background:rgba(52,211,153,.15);color:var(--algebra)}.tier-2{background:var(--math-bg);color:var(--math)}.tier-3{background:var(--adv-bg);color:var(--advanced)}

/* DRILL TIMER (for DD exercise ‚Äî uses ddStart/ddTimer, NOT timerInterval/timerSeconds) */
.drill-timer{font-family:'JetBrains Mono',monospace;font-size:1.1rem;text-align:center;padding:8px;border-radius:8px;margin-bottom:14px;background:var(--paper);color:var(--muted)}
.drill-timer.running{color:var(--psda)}
.drill-timer.done{color:var(--correct)}

/* TRAP TAXONOMY */
.trap-taxonomy{margin-bottom:24px}
.trap-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px 18px;margin-bottom:10px;display:flex;gap:14px;align-items:flex-start;transition:all .2s}
.trap-card:hover{border-color:var(--accent);transform:translateX(3px)}
.trap-number{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.78rem;color:#fff;flex-shrink:0}
.trap-card-body{flex:1}
.trap-card-name{font-weight:700;font-size:.92rem;margin-bottom:3px}
.trap-card-desc{font-size:.82rem;color:var(--muted);line-height:1.5}
.trap-card-example{font-size:.78rem;color:var(--math);font-family:'JetBrains Mono',monospace;margin-top:4px}

/* CONFIDENCE / TIMER / PRACTICE */
.confidence-row{display:flex;gap:6px;margin-bottom:10px;flex-wrap:wrap}
.conf-tag{padding:5px 12px;border-radius:6px;font-size:.75rem;font-weight:600;cursor:pointer;border:2px solid var(--border);background:var(--surface);transition:all .15s;letter-spacing:.5px}
.conf-tag:hover{border-color:var(--des)}
.conf-tag.selected{border-color:var(--des);background:rgba(43,196,169,.12);color:var(--des)}
.conf-tag[data-conf="guessing"].selected{border-color:var(--psda);background:rgba(251,191,36,.12);color:var(--psda)}
.conf-tag[data-conf="unsure"].selected{border-color:var(--math);background:var(--math-bg);color:var(--math)}
.conf-tag[data-conf="confident"].selected{border-color:var(--des);background:rgba(43,196,169,.12);color:var(--des)}

.timer-bar{position:sticky;top:8px;z-index:50;background:rgba(18,18,18,.92);backdrop-filter:blur(8px);border:1px solid var(--border);border-radius:12px;padding:10px 16px;margin-bottom:20px;display:flex;align-items:center;gap:14px}
.timer-display{font-family:'JetBrains Mono',monospace;font-size:1.1rem;font-weight:700;color:var(--des);min-width:60px}
.timer-display.warning{color:var(--psda)}
.timer-display.danger{color:var(--wrong);animation:pulse 1s ease infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
.timer-track{flex:1;height:4px;background:var(--border);border-radius:2px;overflow:hidden}
.timer-fill{height:100%;background:var(--grad);transition:width 1s linear;border-radius:2px}
.timer-fill.warning{background:var(--psda)}
.timer-fill.danger{background:var(--wrong)}
.timer-toggle{padding:5px 12px;background:var(--surface);border:1px solid var(--border);border-radius:6px;font-size:.75rem;color:var(--muted);cursor:pointer;font-family:'Source Sans 3',sans-serif;font-weight:600}
.timer-toggle:hover{border-color:var(--accent);color:var(--ink)}
.timer-toggle.active{background:var(--accent-light);border-color:var(--accent);color:var(--accent)}
.q-dots{display:flex;gap:4px}
.q-dot{width:8px;height:8px;border-radius:50%;background:var(--border)}
.q-dot.correct{background:var(--correct)}
.q-dot.wrong{background:var(--wrong)}

/* RESULTS */
.results-section{margin-top:24px;padding:20px;background:var(--surface);border:1px solid var(--border);border-radius:14px}
.results-section h3{font-family:'Cormorant Garamond',serif;font-size:1.3rem;margin-bottom:14px}
.results-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:2px;margin-bottom:16px;background:var(--border);border-radius:10px;overflow:hidden}
.results-grid-header{background:var(--surface);padding:8px;text-align:center;font-size:.68rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted)}
.results-grid-cell{background:var(--paper);padding:10px 8px;text-align:center;font-size:.78rem;min-height:50px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px}
.results-grid-cell.danger-cell{background:var(--danger-bg);border:1px solid rgba(239,68,68,.3)}
.cell-label{font-size:.65rem;color:var(--muted);font-weight:600}
.cell-dots{display:flex;gap:3px;flex-wrap:wrap;justify-content:center}
.cell-dot{width:8px;height:8px;border-radius:50%}
.difficulty-bars{display:flex;flex-direction:column;gap:8px;margin-bottom:16px}
.diff-row{display:flex;align-items:center;gap:10px}
.diff-label{font-size:.78rem;font-weight:600;min-width:60px}
.diff-track{flex:1;height:8px;background:var(--border);border-radius:4px;overflow:hidden}
.diff-fill{height:100%;border-radius:4px;transition:width .5s ease}
.diff-val{font-family:'JetBrains Mono',monospace;font-size:.78rem;font-weight:700;min-width:40px;text-align:right}
.error-category{padding:12px 16px;border-radius:10px;margin-bottom:8px;font-size:.85rem;line-height:1.6}
.error-category .error-label{font-weight:700;margin-bottom:4px}
.error-category .error-items{color:var(--muted);font-size:.82rem}

/* COMPLETE */
.complete-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:40px 20px;text-align:center}
.complete-icon{font-size:4rem;margin-bottom:16px;animation:celebrateBounce .6s ease}
@keyframes celebrateBounce{0%{transform:scale(0)}50%{transform:scale(1.2)}100%{transform:scale(1)}}
.complete-screen h1{font-family:'Cormorant Garamond',serif;font-size:clamp(1.8rem,4vw,2.4rem);margin-bottom:8px;background:var(--grad);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.complete-sub{color:var(--muted);font-size:1rem;margin-bottom:28px}
.takeaway-list{text-align:left;max-width:500px;width:100%;margin-bottom:32px}
.takeaway-item{display:flex;gap:10px;align-items:flex-start;padding:8px 0;font-size:.88rem;color:#ccc}
.takeaway-check{color:var(--correct);flex-shrink:0;font-weight:700}
.nav-cards{display:grid;grid-template-columns:1fr 1fr;gap:12px;max-width:500px;width:100%}
.nav-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:18px;text-align:center;cursor:pointer;transition:all .2s;text-decoration:none;color:var(--ink)}
.nav-card:hover{border-color:var(--des);transform:translateY(-2px)}
.nav-card-label{font-size:.7rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:4px}
.nav-card-title{font-weight:700;font-size:.95rem}

@media(max-width:600px){.mod-meta{flex-wrap:wrap;gap:10px}.sc-grid{grid-template-columns:repeat(2,1fr)}.do-dont{grid-template-columns:1fr}.classify-opts{flex-direction:column}.dd-btns{flex-direction:column}.preview-grid{grid-template-columns:1fr 1fr}.welcome-meta{flex-wrap:wrap;gap:12px}.results-grid{grid-template-columns:1fr;gap:1px}.nav-cards{grid-template-columns:1fr}.timer-bar{flex-wrap:wrap;gap:8px}}
</style>
</head>
<body>
<div class="top-stripe"></div>
<div class="screen-progress" id="screenProgress"></div>

<!-- SCREEN 1: WELCOME -->
<div class="screen active fade-in" id="screen-welcome">
  <div class="welcome-screen">
    <div class="welcome-badge">Module 7</div>
    <h1>Desmos Mastery</h1>
    <p class="welcome-sub">~1/3 of SAT math questions can be solved or verified with Desmos. This is not optional.</p>
    <div class="welcome-meta"><span>‚è± 1-2 sessions</span><span>üìä 10 essential skills</span><span>üî® 3 exercises</span><span>üéØ 10 practice Qs</span></div>
    <div class="preview-grid">
      <div class="preview-card"><div class="preview-icon">üîÑ</div><div class="preview-title">Retrieval Warm-Up</div><div class="preview-desc">5 questions from Module 6 to activate prior knowledge</div></div>
      <div class="preview-card"><div class="preview-icon">üìä</div><div class="preview-title">10 Essential Skills</div><div class="preview-desc">Graphing, intersections, sliders, tables, regression & more</div></div>
      <div class="preview-card"><div class="preview-icon">üéØ</div><div class="preview-title">Trap Taxonomy</div><div class="preview-desc">4 named traps that recur in Desmos problems</div></div>
      <div class="preview-card"><div class="preview-icon">üßÆ</div><div class="preview-title">3 Exercises</div><div class="preview-desc">Skill matcher, Desmos vs algebra speed drill, shortcut quiz</div></div>
      <div class="preview-card"><div class="preview-icon">‚è±</div><div class="preview-title">Timed Practice</div><div class="preview-desc">10 SAT-style questions with optional timer</div></div>
      <div class="preview-card"><div class="preview-icon">üìà</div><div class="preview-title">Error Analysis</div><div class="preview-desc">Difficulty breakdown + confidence matrix + trap patterns</div></div>
    </div>
    <button class="start-btn" onclick="goScreen(1)">Start Learning ‚Üí</button>
  </div>
</div>

<!-- SCREEN 2: RETRIEVAL WARM-UP -->
<div class="screen" id="screen-warmup">
  <div class="warmup-container">
    <div class="warmup-header">
      <div class="warmup-badge">Retrieval Warm-Up</div>
      <h2 style="font-family:'Cormorant Garamond',serif;font-size:1.6rem">Module 6 Review</h2>
      <p style="color:var(--muted);font-size:.9rem;margin-top:4px">Quick recall from Geometry & Trig.</p>
      <div class="warmup-dots" id="warmupDots"></div>
    </div>
    <div id="warmupContent"></div>
  </div>
</div>

<!-- SCREEN 3: LESSON CONTENT -->
<div class="screen" id="screen-lesson">
<div class="container">
<a class="back-link" href="index.html">‚Üê Back to SAT Math Course</a>
<div class="mod-header">
  <div class="mod-badge">Module 7</div>
  <h1>Desmos Mastery</h1>
  <p class="subtitle">~1/3 of SAT math questions can be solved or verified with Desmos. This is not optional.</p>
  <div class="mod-meta"><span>‚è± 1-2 sessions</span><span>üìä 10 essential skills</span><span>üéØ Phase 3: Strategize</span></div>
</div>

<!-- INTRO -->
<div class="callout-des callout"><strong>Approximately one-third of all SAT math questions can be solved or verified using Desmos.</strong> Students who are fluent with Desmos solve problems faster, catch errors more often, and feel more confident on test day.</div>

<div class="section">
  <p>Desmos is not just a calculator ‚Äî it's a graphing, regression, and equation-solving engine built into every Digital SAT. But knowing it exists isn't enough. You need to be <strong>fast</strong>, <strong>deliberate</strong>, and know exactly when to use it versus when algebra is faster.</p>
  <p>Practice at <a href="https://desmos.com/practice" target="_blank" style="color:var(--des);font-weight:600">desmos.com/practice</a> for the exact interface you'll see on test day.</p>
  <div class="callout"><strong>CAS calculators are banned</strong> on the Digital SAT starting August 2025 (weekend) and October 2025 (in-school). This makes Desmos proficiency more critical than ever ‚Äî it is now the most powerful calculator every student has access to.</div>
  <div class="callout-des callout"><strong>New: Calculator Mode Toggle.</strong> Starting Fall 2025, you can switch between <strong>scientific mode</strong> (quick arithmetic, no graphing) and <strong>graphing mode</strong> (full Desmos). Use scientific for simple calculations to avoid accidentally opening a graph. Switch to graphing when you need visualization.</div>
</div>

<!-- 10 ESSENTIAL SKILLS -->
<div class="section">
  <div class="section-label">Core Content</div>
  <h2>The 10 Essential Desmos Skills</h2>
  <table class="skill-table">
    <tr><th>Skill</th><th>How To Do It</th><th>SAT Application</th></tr>
    <tr><td><span class="skill-num">1</span>Graph a function</td><td>Type equation: <code>y = x¬≤ ‚àí 4</code></td><td>Visualize functions, find intercepts and vertex</td></tr>
    <tr><td><span class="skill-num">2</span>Find intersections</td><td>Graph two equations; click the dot</td><td>Solve systems, find where f(x) = g(x)</td></tr>
    <tr><td><span class="skill-num">3</span>Use sliders</td><td>Type a parameter like <code>a</code>; click the slider button</td><td>Find unknown constants, explore transformations</td></tr>
    <tr><td><span class="skill-num">4</span>Enter a table</td><td>Click <code>+</code> ‚Üí Table; enter x, y values</td><td>Set up data for regression, verify function values</td></tr>
    <tr><td><span class="skill-num">5</span>Run a regression</td><td><code>y‚ÇÅ ~ mx‚ÇÅ + b</code> OR use <strong>Autoregression</strong> (click the wrench icon after entering a table ‚Üí Desmos auto-fits linear, quadratic, and exponential models)</td><td>Find line/curve of best fit. Autoregression is faster for exploring multiple model types.</td></tr>
    <tr><td><span class="skill-num">6</span>Graph inequalities</td><td>Type the inequality: <code>y > 2x + 1</code></td><td>Visualize solution regions</td></tr>
    <tr><td><span class="skill-num">7</span>Calculate statistics</td><td><code>mean(L)</code>, <code>median(L)</code>, <code>stdev(L)</code>, <code>total(L)</code> where L is a list</td><td>Quick stats on any data set. Define a list: <code>L = [12, 15, 18, 22]</code></td></tr>
    <tr><td><span class="skill-num">8</span>Use the % key</td><td>Type <code>20% of 350</code></td><td>Percentage calculations</td></tr>
    <tr><td><span class="skill-num">9</span>Graph circles</td><td><code>(x‚àí2)¬≤+(y+3)¬≤=25</code></td><td>Verify center, radius; find tangent points</td></tr>
    <tr><td><span class="skill-num">10</span>Keyboard shortcuts</td><td><code>^</code> exponents, <code>_</code> subscripts, <code>~</code> regression, <code>|</code> absolute value</td><td>Speed up data entry</td></tr>
  </table>
</div>

<!-- KEYBOARD SHORTCUTS -->
<div class="section">
  <div class="section-label">Reference</div>
  <h2>Keyboard Shortcuts</h2>
  <p>Memorize these before test day. They save 2-3 seconds per entry ‚Äî which adds up fast over 44 questions.</p>
  <div class="sc-grid">
    <div class="sc-card"><div class="sc-key">^</div><div class="sc-desc">Exponents: x^2 ‚Üí x¬≤</div></div>
    <div class="sc-card"><div class="sc-key">_</div><div class="sc-desc">Subscripts: y_1 ‚Üí y‚ÇÅ</div></div>
    <div class="sc-card"><div class="sc-key">~</div><div class="sc-desc">Regression: y‚ÇÅ ~ mx‚ÇÅ+b</div></div>
    <div class="sc-card"><div class="sc-key">Shift+\</div><div class="sc-desc">Absolute value: |x‚àí3|</div></div>
    <div class="sc-card"><div class="sc-key">sqrt</div><div class="sc-desc">Square root: sqrt(x)</div></div>
    <div class="sc-card"><div class="sc-key">pi</div><div class="sc-desc">œÄ constant: pi ‚Üí œÄ</div></div>
    <div class="sc-card"><div class="sc-key">/</div><div class="sc-desc">Fractions: 3/7</div></div>
    <div class="sc-card"><div class="sc-key">üîß</div><div class="sc-desc">Wrench: degrees ‚Üî radians</div></div>
  </div>
</div>

<!-- GRAPHING vs SCIENTIFIC MODE -->
<div class="section">
  <div class="section-label">Calculator Modes</div>
  <h2>Graphing vs. Scientific Mode</h2>
</div>
<div class="topic open" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
  <div class="topic-header">
    <div class="topic-badge" style="background:var(--des)">‚öô</div>
    <div class="topic-info"><div class="topic-title">When to Use Each Mode</div><div class="topic-sub">Graphing for visuals, scientific for quick calculations</div></div>
    <div class="topic-arrow">‚ñ∏</div>
  </div>
  <div class="topic-body">
    <ul>
      <li><strong>Graphing mode (default):</strong> Use 95% of the time. Graphs equations, finds intersections, runs regressions, handles tables. This is your power tool.</li>
      <li><strong>Scientific mode:</strong> Switch for pure arithmetic. Cleaner interface for calculations that don't need graphs ‚Äî unit conversions, complex fractions.</li>
      <li><strong>CAS ban:</strong> Computer Algebra Systems (like TI-Nspire CAS) are NOT allowed on the SAT. The built-in Desmos does NOT have CAS ‚Äî it won't simplify algebraic expressions or factor for you. It only evaluates numerically and graphs.</li>
    </ul>
    <div class="callout"><strong>Practical tip:</strong> Even for arithmetic, the graphing calculator works fine ‚Äî type the expression on a blank line and Desmos evaluates it. No need to switch modes unless the interface feels cluttered.</div>
  </div>
</div>

<!-- WHEN TO USE / NOT USE -->
<div class="section">
  <div class="section-label">Calculator Discipline</div>
  <h2>When to Use Desmos ‚Äî and When Not To</h2>
  <div class="do-dont">
    <div class="do-card">
      <h4>‚úÖ USE Desmos</h4>
      <ul style="padding-left:16px">
        <li>Systems of equations (graph & click intersection)</li>
        <li>Quadratic questions (vertex, zeros, graph shape)</li>
        <li>Finding where f(x) = g(x)</li>
        <li>Data tables & regression</li>
        <li>Inequality solution regions</li>
        <li>Circle equations (center, radius)</li>
        <li>Unknown constant with slider</li>
        <li>Verifying your algebraic answer</li>
      </ul>
    </div>
    <div class="dont-card">
      <h4>‚ùå DON'T Use Desmos</h4>
      <ul style="padding-left:16px">
        <li>Simple arithmetic (7 √ó 8)</li>
        <li>Single-step calculations</li>
        <li>Questions testing setup, not solving</li>
        <li>When you see the answer immediately</li>
        <li>Unit conversions</li>
        <li>Probability from tables</li>
        <li>If setup takes >15 seconds</li>
        <li>Study design / conceptual questions</li>
      </ul>
    </div>
  </div>
  <div class="callout"><strong>The 5-Second Rule:</strong> If you can't figure out how to set it up in Desmos within 5 seconds, switch to algebra. Desmos is a tool, not a crutch.</div>
</div>

<!-- WORKED EXAMPLES -->
<div class="section">
  <div class="section-label">Worked Examples</div>
  <h2>Desmos in Action ‚Äî 5 Common SAT Scenarios</h2>
  <p>These step-by-step walkthroughs show exactly what to type and click. Practice each one in Desmos before moving to the exercises.</p>
</div>

<div class="topic open" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
  <div class="topic-header">
    <div class="topic-badge" style="background:var(--algebra)">Ex</div>
    <div class="topic-info"><div class="topic-title">Scenario 1: Solve a System of Equations</div><div class="topic-sub">y = 2x + 1 and y = ‚àíx + 7</div></div>
    <div class="topic-arrow">‚ñ∏</div>
  </div>
  <div class="topic-body">
    <p><strong>Step 1:</strong> Type <code>y = 2x + 1</code> on line 1.</p>
    <p><strong>Step 2:</strong> Type <code>y = ‚àíx + 7</code> on line 2.</p>
    <p><strong>Step 3:</strong> Click the gray intersection dot ‚Üí (2, 5).</p>
    <p><strong>Answer:</strong> x = 2, y = 5. Done in under 10 seconds.</p>
    <p style="color:var(--muted);font-size:.85rem"><em>Algebraically, this would take 30+ seconds with substitution or elimination.</em></p>
  </div>
</div>

<div class="topic" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
  <div class="topic-header">
    <div class="topic-badge" style="background:var(--advanced)">Ex</div>
    <div class="topic-info"><div class="topic-title">Scenario 2: Find the Vertex of a Quadratic</div><div class="topic-sub">f(x) = x¬≤ ‚àí 6x + 5</div></div>
    <div class="topic-arrow">‚ñ∏</div>
  </div>
  <div class="topic-body">
    <p><strong>Step 1:</strong> Type <code>y = x^2 ‚àí 6x + 5</code></p>
    <p><strong>Step 2:</strong> Click the bottom of the parabola ‚Üí Desmos shows (3, ‚àí4).</p>
    <p><strong>Answer:</strong> Vertex at (3, ‚àí4). You also see zeros at x = 1 and x = 5 (click those dots too).</p>
  </div>
</div>

<div class="topic" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
  <div class="topic-header">
    <div class="topic-badge" style="background:var(--psda)">Ex</div>
    <div class="topic-info"><div class="topic-title">Scenario 3: Regression & Autoregression</div><div class="topic-sub">Data: (1,3), (2,5), (3,8), (4,11), (5,14)</div></div>
    <div class="topic-arrow">‚ñ∏</div>
  </div>
  <div class="topic-body">
    <p><strong>Step 1:</strong> Click <strong>+</strong> ‚Üí Table. Enter x values: 1,2,3,4,5 and y values: 3,5,8,11,14.</p>
    <p><strong>Step 2:</strong> On a new line, type <code>y‚ÇÅ ~ mx‚ÇÅ + b</code> (use _ for subscript, ~ for regression).</p>
    <p><strong>Step 3:</strong> Desmos shows: m ‚âà 2.8, b ‚âà 0.2. So the line is approximately y = 2.8x + 0.2.</p>
    <p><strong>Autoregression shortcut:</strong> After entering the table, click the wrench icon ‚Üí Desmos auto-fits linear, quadratic, and exponential models. One click instead of typing the regression equation.</p>
    <p style="color:var(--muted);font-size:.85rem"><em>Try <code>y‚ÇÅ ~ ax‚ÇÅ¬≤ + bx‚ÇÅ + c</code> for a quadratic fit if the data curves. Or let Autoregression pick the best model.</em></p>
  </div>
</div>

<div class="topic" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
  <div class="topic-header">
    <div class="topic-badge" style="background:var(--geotrig)">Ex</div>
    <div class="topic-info"><div class="topic-title">Scenario 4: Use a Slider to Find an Unknown</div><div class="topic-sub">The line y = ax + 3 passes through (4, 11). Find a.</div></div>
    <div class="topic-arrow">‚ñ∏</div>
  </div>
  <div class="topic-body">
    <p><strong>Step 1:</strong> Type <code>y = ax + 3</code>. Desmos creates a slider for a.</p>
    <p><strong>Step 2:</strong> Plot the point <code>(4, 11)</code> on another line.</p>
    <p><strong>Step 3:</strong> Slide a until the line passes through the point. Or compute: 11 = 4a + 3 ‚Üí a = 2.</p>
    <p style="color:var(--muted);font-size:.85rem"><em>Sliders are especially powerful when the algebra is messy ‚Äî slide until the graph looks right, then read the value.</em></p>
  </div>
</div>

<div class="topic" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
  <div class="topic-header">
    <div class="topic-badge" style="background:var(--des)">Ex</div>
    <div class="topic-info"><div class="topic-title">Scenario 5: Quick Statistics</div><div class="topic-sub">Find the mean of 12, 15, 18, 22, 33</div></div>
    <div class="topic-arrow">‚ñ∏</div>
  </div>
  <div class="topic-body">
    <p><strong>Step 1:</strong> Type <code>mean(12,15,18,22,33)</code> on any line.</p>
    <p><strong>Result:</strong> Desmos shows 20. Instant.</p>
    <p>Also works: <code>median(12,15,18,22,33)</code> ‚Üí 18. And: <code>total(12,15,18,22,33)</code> ‚Üí 100. And: <code>stdev(12,15,18,22,33)</code> for standard deviation.</p>
  </div>
</div>

<!-- EXERCISE 1: SKILL MATCHER -->
<div class="section">
  <div class="section-label">Interactive Exercise 1</div>
  <h2>Which Desmos Skill?</h2>
  <p>For each SAT scenario, choose the best Desmos technique to use.</p>
  <div class="exercise" id="skillEx"></div>
</div>

<!-- EXERCISE 2: DESMOS VS ALGEBRA -->
<div class="section">
  <div class="section-label">Interactive Exercise 2</div>
  <h2>Desmos or Algebra? ‚Äî Speed Decision Drill</h2>
  <p>For each question type, decide instantly: would Desmos be faster, or algebra? Timer starts on first answer.</p>
  <div class="exercise" style="border-color:var(--psda)" id="ddEx"></div>
</div>

<!-- EXERCISE 3: SHORTCUT QUIZ -->
<div class="section">
  <div class="section-label">Interactive Exercise 3</div>
  <h2>Keyboard Shortcut Quiz</h2>
  <p>Match each action to the correct Desmos keyboard shortcut.</p>
  <div class="exercise" style="border-color:var(--advanced)" id="scEx"></div>
</div>

<!-- PRACTICE PROTOCOL -->
<div class="section">
  <div class="section-label">Homework</div>
  <h2>Desmos Practice Protocol</h2>
  <div class="card card-accent" style="font-size:.93rem;color:#ccc">
    <p><strong style="color:var(--ink)">1. Go to <a href="https://desmos.com/calculator" target="_blank" style="color:var(--des)">desmos.com/calculator</a></strong> ‚Äî Practice each of the 10 skills at least once.</p>
    <p><strong style="color:var(--ink)">2. Complete 20 practice questions using Desmos intentionally</strong> ‚Äî Even on problems you could solve by hand. Build fluency.</p>
    <p><strong style="color:var(--ink)">3. Practice the 5-second decision</strong> ‚Äî For each problem, ask: "Desmos or algebra?" before starting.</p>
    <p><strong style="color:var(--ink)">4. Master the keyboard shortcuts</strong> ‚Äî Time yourself entering 10 expressions. Aim for under 5 seconds each.</p>
    <p style="margin:0"><strong style="color:var(--ink)">5. Try <a href="https://desmos.com/practice" target="_blank" style="color:var(--des)">desmos.com/practice</a></strong> ‚Äî Select College Board tests for the exact calculator interface.</p>
  </div>
</div>

<!-- TRAP TAXONOMY -->
<div class="section">
  <div class="section-label">Math Trap Taxonomy</div>
  <h2>Four Traps That Recur in Desmos Problems</h2>
  <p>Learn these by name. When you spot one in a problem, you'll know exactly what to watch for.</p>
  <div class="trap-taxonomy">
    <div class="trap-card"><div class="trap-number" style="background:var(--wrong)">1</div><div class="trap-card-body"><div class="trap-card-name">‚è± The Setup Trap</div><div class="trap-card-desc">Spent too long setting up Desmos when algebra would have been faster. The 5-second rule exists for a reason ‚Äî if you can't see how to enter it quickly, switch methods.</div><div class="trap-card-example">Simple probability from a table ‚Üí Desmos can't help. Read the table directly.</div></div></div>
    <div class="trap-card"><div class="trap-number" style="background:var(--des)">2</div><div class="trap-card-body"><div class="trap-card-name">üßÆ The Mental Math Trap</div><div class="trap-card-desc">Used Desmos for something you could do in your head. Every second spent opening and typing into the calculator is a second wasted on easy questions.</div><div class="trap-card-example">Using Desmos for 25% of 400 ‚Üí Just do 400/4 = 100 mentally.</div></div></div>
    <div class="trap-card"><div class="trap-number" style="background:var(--psda)">3</div><div class="trap-card-body"><div class="trap-card-name">üîç The CAS Illusion</div><div class="trap-card-desc">Expected Desmos to factor, simplify, or solve algebraically. Desmos is NOT a CAS ‚Äî it graphs and evaluates numerically, but won't simplify x¬≤‚àí4 into (x‚àí2)(x+2) for you.</div><div class="trap-card-example">Asking Desmos to simplify (x¬≤+3x)/(x+3) ‚Üí It only graphs. Factor by hand.</div></div></div>
    <div class="trap-card"><div class="trap-number" style="background:var(--math)">4</div><div class="trap-card-body"><div class="trap-card-name">üéØ The Intersection Misread</div><div class="trap-card-desc">Read the wrong intersection point, or clicked a different point on the graph. Always verify which intersection you need, and zoom in if the points are close together.</div><div class="trap-card-example">Two parabolas with 2 intersections ‚Üí clicked the wrong one. Check both!</div></div></div>
  </div>
</div>

<div style="text-align:center;padding:24px 0">
  <button class="start-btn" onclick="goScreen(3)">Continue to Practice Questions ‚Üí</button>
</div>
</div>
</div>

<!-- SCREEN 4: TIMED PRACTICE -->
<div class="screen" id="screen-practice">
<div class="container">
  <div class="section-label">SAT Practice</div>
  <h2 style="font-family:'Cormorant Garamond',serif;font-size:1.6rem;margin-bottom:4px">Practice Questions</h2>
  <p style="color:var(--muted);font-size:.9rem;margin-bottom:16px">10 questions at three difficulty tiers. Tag your confidence before answering.</p>
  <div class="timer-bar" id="timerBar">
    <div class="timer-display" id="timerDisplay">--:--</div>
    <div class="timer-track"><div class="timer-fill" id="timerFill"></div></div>
    <div class="q-dots" id="qDots"></div>
    <button class="timer-toggle" id="timerToggle" onclick="toggleTimer()">‚è± Timer OFF</button>
  </div>
  <div id="satPractice"></div>
  <div id="practiceResults" style="display:none"></div>
  <div id="practiceNav" style="display:none;text-align:center;padding:24px 0">
    <button class="start-btn" onclick="goScreen(4)">View Summary & Complete Module ‚Üí</button>
  </div>
</div>
</div>

<!-- SCREEN 5: MODULE COMPLETE -->
<div class="screen" id="screen-complete">
  <div class="complete-screen">
    <div class="complete-icon">üéâ</div>
    <h1>Module 7 Complete!</h1>
    <p class="complete-sub">You've mastered Desmos ‚Äî now you have a powerful tool advantage on test day.</p>
    <div class="takeaway-list">
      <div style="font-weight:700;margin-bottom:12px;font-size:.85rem;color:var(--des);text-transform:uppercase;letter-spacing:1px">Key Takeaways</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> ~1/3 of SAT math can be solved or verified with Desmos. With CAS calculators banned, Desmos fluency is now essential.</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> Master the 10 essential skills ‚Äî graphing, intersections, sliders, tables, regression, inequalities, stats, %, circles, shortcuts.</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> Calculator discipline: use Desmos when it's faster (systems, quadratics, regression), skip it when it's slower (arithmetic, single-step, conceptual).</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> The 5-second rule: if setup takes more than 5 seconds, switch to algebra.</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> Memorize keyboard shortcuts: <strong>^ _ ~ | sqrt pi</strong></div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> Always verify your answer when time allows ‚Äî graph your equation and check it makes sense.</div>
    </div>
    <div id="completePracticeStats"></div>
    <div class="nav-cards">
      <a class="nav-card" href="module-6.html"><div class="nav-card-label">‚Üê Previous</div><div class="nav-card-title">Module 6: Geometry & Trig</div></a>
      <a class="nav-card" href="module-8.html" style="border-color:var(--des)"><div class="nav-card-label">Next ‚Üí</div><div class="nav-card-title">Module 8: Strategy & Time Management</div></a>
    </div>
  </div>
</div>

<script>
// ============ SCREEN NAVIGATION ============
const SCREENS=['screen-welcome','screen-warmup','screen-lesson','screen-practice','screen-complete'];
let currentScreen=0;
function goScreen(idx){
  if(idx<0||idx>=SCREENS.length)return;
  const cur=document.getElementById(SCREENS[currentScreen]),nxt=document.getElementById(SCREENS[idx]);
  cur.classList.remove('fade-in');cur.classList.add('fade-out');
  setTimeout(()=>{cur.classList.remove('active','fade-out');nxt.classList.add('active','fade-in');currentScreen=idx;updateProgressDots();window.scrollTo(0,0);if(idx===3&&timerEnabled)startTimer();},300);
}
function updateProgressDots(){
  document.getElementById('screenProgress').innerHTML=SCREENS.map((s,i)=>{let cls='screen-dot';if(i<currentScreen)cls+=' completed';if(i===currentScreen)cls+=' current';return `<div class="${cls}" onclick="${i<=currentScreen?'goScreen('+i+')':''}" title="${['Welcome','Warm-Up','Lesson','Practice','Complete'][i]}"></div>`;}).join('');
}
updateProgressDots();

// ============ WARM-UP (Module 6 ‚Äî Geometry & Trig) ============
const WARMUP_QS=[
  {source:'Module 6 ‚Äî Special Triangles',q:'In a 30-60-90 triangle, what is the ratio of sides?',
   ch:['1 : 1 : ‚àö2','1 : ‚àö2 : 2','1 : ‚àö3 : 2','‚àö3 : ‚àö3 : 2'],c:2,
   fb:'The 30-60-90 ratio is always 1 : ‚àö3 : 2. The short leg is opposite 30¬∞, the long leg opposite 60¬∞ (√ó‚àö3), and the hypotenuse is double the short leg.'},
  {source:'Module 6 ‚Äî Circles',q:'The equation (x‚àí3)¬≤ + (y+1)¬≤ = 25 has center at?',
   ch:['(‚àí3, 1)','(3, 1)','(3, ‚àí1)','(‚àí3, ‚àí1)'],c:2,
   fb:'Standard form: (x‚àíh)¬≤ + (y‚àík)¬≤ = r¬≤. Here h=3, k=‚àí1. Center is (3, ‚àí1). The signs flip inside the parentheses!'},
  {source:'Module 6 ‚Äî Volume',q:'Volume of a cone with radius r and height h?',
   ch:['V = œÄr¬≤h','V = ‚ÖìœÄr¬≤h','V = ¬ΩœÄr¬≤h','V = 2œÄr¬≤h'],c:1,
   fb:'Cone volume = ‚ÖìœÄr¬≤h. A cone is always one-third the volume of the cylinder with the same base and height.'},
  {source:'Module 6 ‚Äî Trigonometry',q:'sin(30¬∞) = ?',
   ch:['¬Ω','‚àö2/2','‚àö3/2','1'],c:0,
   fb:'sin(30¬∞) = ¬Ω. From the 30-60-90 triangle: opposite/hypotenuse = 1/2. This is a must-memorize value.'},
  {source:'Module 6 ‚Äî Complementary Angles',q:'If two angles are complementary and one is 35¬∞, the other is?',
   ch:['145¬∞','65¬∞','55¬∞','35¬∞'],c:2,
   fb:'Complementary angles sum to 90¬∞. So 90¬∞ ‚àí 35¬∞ = 55¬∞. Don\'t confuse with supplementary (sum to 180¬∞).'}
];
let warmupIdx=0,warmupAnswers=[],warmupAnswered=false;
function renderWarmup(){
  document.getElementById('warmupDots').innerHTML=WARMUP_QS.map((_,i)=>{let cls='warmup-dot';if(i<warmupIdx)cls+=warmupAnswers[i]?' done-correct':' done-wrong';if(i===warmupIdx&&warmupIdx<WARMUP_QS.length)cls+=' active';return `<div class="${cls}"></div>`;}).join('');
  const cont=document.getElementById('warmupContent');
  if(warmupIdx>=WARMUP_QS.length){const cor=warmupAnswers.filter(Boolean).length;cont.innerHTML=`<div class="warmup-summary"><div class="warmup-badge">Warm-Up Complete</div><div class="warmup-score">${cor} / ${WARMUP_QS.length}</div><p style="color:var(--muted);font-size:.9rem;margin-bottom:8px">${cor===5?'Perfect recall! Module 6 knowledge is locked in.':cor>=3?'Good recall! A couple topics to revisit from Geometry & Trig.':'Some gaps from Module 6 ‚Äî consider a quick review of Geometry & Trig.'}</p><button class="warmup-continue" onclick="goScreen(2)">Continue to Lesson ‚Üí</button></div>`;return;}
  const q=WARMUP_QS[warmupIdx];warmupAnswered=false;
  cont.innerHTML=`<div class="warmup-q"><div class="source-tag">From ${q.source}</div><div class="q-text">${q.q}</div><div class="warmup-choices" id="warmupChoices">${q.ch.map((ch,ci)=>`<div class="warmup-choice" onclick="answerWarmup(${ci})">${ch}</div>`).join('')}</div><div id="warmupFb" style="display:none"></div></div>`;
}
function answerWarmup(ci){
  if(warmupAnswered)return;warmupAnswered=true;
  const q=WARMUP_QS[warmupIdx],correct=ci===q.c;warmupAnswers.push(correct);
  document.querySelectorAll('.warmup-choice').forEach((ch,i)=>{ch.classList.add('wu-dis');if(i===q.c)ch.classList.add('wu-correct');else if(i===ci&&!correct)ch.classList.add('wu-wrong');});
  const fb=document.getElementById('warmupFb');fb.style.display='block';
  fb.innerHTML=`<div class="warmup-fb">${correct?'‚úì ':'‚úó '}${q.fb}</div><button class="warmup-next" onclick="warmupIdx++;renderWarmup()">${warmupIdx<WARMUP_QS.length-1?'Next Question ‚Üí':'See Results ‚Üí'}</button>`;
  document.getElementById('warmupDots').innerHTML=WARMUP_QS.map((_,i)=>{let cls='warmup-dot';if(i<warmupAnswers.length)cls+=warmupAnswers[i]?' done-correct':' done-wrong';else if(i===warmupIdx+1)cls+=' active';return `<div class="${cls}"></div>`;}).join('');
}
renderWarmup();

// ============ HELPERS ============
function mkScore(id,correct,total){return `<div class="score-bar"><div class="score-bar-label">Score</div><div class="score-bar-track"><div class="score-bar-fill" style="width:${total?correct/total*100:0}%"></div></div><div class="score-bar-val">${correct}/${total}</div></div>`;}

// ============ EXERCISE 1: SKILL MATCHER ============
const SKILL_QS=[
  {scenario:'Find the solutions of <code>2x¬≤ ‚àí 5x ‚àí 3 = 0</code>.',correct:0,
   opts:['Graph the function','Use a slider','Run a regression','Calculate statistics'],
   fb:'Graph y = 2x¬≤ ‚àí 5x ‚àí 3 and click the x-intercepts. Desmos gives exact solutions.'},
  {scenario:'A data table shows 8 points. Find the best-fit line equation.',correct:2,
   opts:['Graph the function','Use a slider','Enter table + regression','Graph an inequality'],
   fb:'Click + ‚Üí Table, enter data, then type y‚ÇÅ ~ mx‚ÇÅ + b. Or use Autoregression for auto-fit.'},
  {scenario:'For what value of k does <code>kx + 2 = x¬≤</code> have exactly one solution?',correct:1,
   opts:['Graph the function','Use a slider','Run a regression','Calculate statistics'],
   fb:'Graph y = x¬≤ and y = kx + 2 with a slider for k. Adjust until the line is tangent to the parabola.'},
  {scenario:'Graph the solution region for <code>y &lt; 3x ‚àí 1</code> AND <code>y ‚â• ‚àíx + 4</code>.',correct:1,
   opts:['Find intersections','Graph inequalities','Use a slider','Run a regression'],
   fb:'Type both inequalities. Desmos shades each region. The overlap is the solution.'},
  {scenario:'Find the center and radius of <code>(x + 3)¬≤ + (y ‚àí 1)¬≤ = 36</code>.',correct:0,
   opts:['Graph the circle','Use a slider','Run a regression','Calculate statistics'],
   fb:'Type the equation directly. Desmos draws the circle. Center (‚àí3, 1), radius 6.'},
  {scenario:'Where do <code>y = 2x + 1</code> and <code>y = x¬≤ ‚àí 3</code> intersect?',correct:0,
   opts:['Find intersections','Use a slider','Graph inequalities','Calculate statistics'],
   fb:'Graph both equations. Click the intersection dots for exact coordinates.'},
  {scenario:'Find the mean and median of: 12, 15, 18, 22, 95.',correct:3,
   opts:['Enter table + regression','Find intersections','Graph the function','Calculate statistics'],
   fb:'Type mean(12,15,18,22,95) and median(12,15,18,22,95). Or define L=[12,15,18,22,95] then mean(L). Instant results.'},
  {scenario:'What is 15% of 840?',correct:1,
   opts:['Graph the function','Use the % key','Run a regression','Use a slider'],
   fb:'Type "15% of 840" directly into Desmos. It computes 126 instantly.'},
  {scenario:'How many x-intercepts does <code>f(x) = x¬≥ ‚àí 4x¬≤ + x + 6</code> have?',correct:0,
   opts:['Graph the function','Calculate statistics','Use a slider','Run a regression'],
   fb:'Graph it and count x-axis crossings. Click each intercept for exact values.'},
  {scenario:'Verify that x = 7 is a solution to <code>3(x ‚àí 2) + 4 = 2x + 3</code>.',correct:0,
   opts:['Graph the function','Use a slider','Find intersections','Calculate statistics'],
   fb:'Graph both sides as separate equations. Check if they intersect at x = 7.'},
];
let skillAns={};
function renderSkills(){
  const total=SKILL_QS.length;const correct=Object.entries(skillAns).filter(([i,v])=>v===SKILL_QS[i].correct).length;
  document.getElementById('skillEx').innerHTML=`<h3>üéØ Match the Skill</h3><div class="exercise-sub">Which Desmos technique solves each problem fastest?</div>`+
    SKILL_QS.map((q,i)=>{
      const a=skillAns[i];const has=a!==undefined;
      return `<div class="ex-item">
        <div class="ex-prompt">${q.scenario}</div>
        <div class="classify-opts">${q.opts.map((o,oi)=>{
          let cls='classify-opt';
          if(has){cls+=' cl-dis';if(oi===q.correct)cls+=' cl-correct';else if(oi===a&&oi!==q.correct)cls+=' cl-wrong';}
          return `<div class="${cls}" onclick="ansSkill(${i},${oi})">${o}</div>`;
        }).join('')}</div>
        <div class="ex-fb${has?' show':''}${has?(a===q.correct?' correct':' wrong'):''}">${has?(a===q.correct?'‚úì ':'‚úó ')+q.fb:''}</div>
      </div>`;
    }).join('')+mkScore('s',correct,total);
}
function ansSkill(i,v){if(skillAns[i]!==undefined)return;skillAns[i]=v;renderSkills();}
renderSkills();

// ============ EXERCISE 2: DESMOS VS ALGEBRA DRILL ============
// NOTE: ddStart and ddTimer are the drill's own timer vars ‚Äî distinct from the practice timer (timerInterval/timerSeconds)
const DD_QS=[
  {q:'What is 8 √ó 7?',correct:'Algebra',fb:'Mental math: 56. Opening Desmos is slower.'},
  {q:'Find the vertex of f(x) = 3x¬≤ ‚àí 12x + 7.',correct:'Desmos',fb:'Graph it ‚Üí Desmos labels the vertex. Faster than computing ‚àíb/2a and plugging in.'},
  {q:'Solve the system: y = 2x ‚àí 1, y = ‚àíx + 5.',correct:'Desmos',fb:'Graph both, click intersection. 3 seconds.'},
  {q:'What is 25% of 400?',correct:'Algebra',fb:'25% = ¬º. 400/4 = 100. Instant mental math.'},
  {q:'How many solutions does x¬≤ + 4x + 5 = 0 have?',correct:'Desmos',fb:'Graph it. Parabola above x-axis ‚Üí 0 solutions. Faster than discriminant.'},
  {q:'Find the best-fit line for 6 data points.',correct:'Desmos',fb:'Table + regression. No human can do this by hand during a test.'},
  {q:'Simplify 3x¬≤ + 5x ‚àí 2x¬≤ + x.',correct:'Algebra',fb:'Combine like terms: x¬≤ + 6x. No calculator needed.'},
  {q:'Where do y = |x ‚àí 3| and y = 2 intersect?',correct:'Desmos',fb:'Absolute value intersections are messy. Graph both and click.'},
  {q:'If f(x) = x + 3, find f(7).',correct:'Algebra',fb:'7 + 3 = 10. Don\'t even open the calculator.'},
  {q:'For what value of a does y = ax¬≤ pass through (3, 18)?',correct:'Desmos',fb:'Type y = ax¬≤ with slider. Adjust until curve hits (3, 18). Or algebra: 18 = 9a ‚Üí a = 2.'},
];
let ddAns={};let ddStart=null;let ddTimer=null;
function renderDD(){
  const elapsed=ddStart?((Date.now()-ddStart)/1000).toFixed(1):'0.0';
  const allDone=Object.keys(ddAns).length===DD_QS.length;
  const correct=Object.entries(ddAns).filter(([i,v])=>v===DD_QS[i].correct).length;
  if(allDone&&ddTimer){clearInterval(ddTimer);ddTimer=null;}
  document.getElementById('ddEx').innerHTML=
    `<h3>‚ö° Speed Decision Drill</h3><div class="exercise-sub">Desmos or Algebra? Decide instantly!</div>
    <div class="drill-timer ${ddStart&&!allDone?'running':''}${allDone?' done':''}">${allDone?elapsed+'s ‚Äî '+correct+'/'+DD_QS.length+(correct>=8?' üî•':''):ddStart?elapsed+'s':'Ready ‚Äî click to start'}</div>`+
    DD_QS.map((d,i)=>{
      const a=ddAns[i];const has=a!==undefined;
      return `<div class="ex-item" style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;padding:10px 14px">
        <div style="flex:1;min-width:200px;font-size:.9rem">${d.q}</div>
        <div class="dd-btns">${['Desmos','Algebra'].map(o=>{
          let cls='dd-btn';
          if(has){cls+=' dd-dis';if(o===d.correct)cls+=' dd-correct';else if(o===a&&o!==d.correct)cls+=' dd-wrong';}
          return `<div class="${cls}" onclick="ansDD(${i},'${o}')">${o==='Desmos'?'üìä Desmos':'‚úèÔ∏è Algebra'}</div>`;
        }).join('')}</div>
        ${has?`<div style="width:100%;font-size:.8rem;color:var(--muted)">${a===d.correct?'‚úì ':'‚úó '}${d.fb}</div>`:''}</div>`;
    }).join('');
}
function ansDD(i,v){
  if(ddAns[i]!==undefined)return;
  if(!ddStart){ddStart=Date.now();ddTimer=setInterval(()=>renderDD(),100);}
  ddAns[i]=v;renderDD();
}
renderDD();

// ============ EXERCISE 3: SHORTCUT QUIZ ============
const SC_QS=[
  {q:'Type an exponent (e.g., x¬≤)',correct:0,opts:['^','_','~','|']},
  {q:'Type a subscript (e.g., y‚ÇÅ)',correct:1,opts:['^','_','~','|']},
  {q:'Start a regression equation',correct:2,opts:['^','_','~','|']},
  {q:'Type absolute value (e.g., |x|)',correct:1,opts:['^','Shift+\\','~','sqrt']},
  {q:'Type a square root',correct:1,opts:['root','sqrt','sqr','rt']},
  {q:'Type the œÄ constant',correct:1,opts:['p','pi','3.14','PI']},
  {q:'Switch between degrees and radians',correct:1,opts:['Settings menu','Wrench icon','Gear icon','Keyboard shortcut']},
  {q:'Create a fraction like 3/7',correct:0,opts:['/','frac','√∑','fraction']},
];
let scAns={};
function renderSC(){
  const total=SC_QS.length;const correct=Object.entries(scAns).filter(([i,v])=>v===SC_QS[i].correct).length;
  document.getElementById('scEx').innerHTML=`<h3>‚å®Ô∏è Shortcut Quiz</h3><div class="exercise-sub">What key or action do you use?</div>`+
    SC_QS.map((q,i)=>{
      const a=scAns[i];const has=a!==undefined;
      return `<div class="ex-item">
        <div class="ex-prompt">${q.q}</div>
        <div class="classify-opts">${q.opts.map((o,oi)=>{
          let cls='classify-opt';
          if(has){cls+=' cl-dis';if(oi===q.correct)cls+=' cl-correct';else if(oi===a&&oi!==q.correct)cls+=' cl-wrong';}
          return `<div class="${cls}" onclick="ansSC(${i},${oi})"><code>${o}</code></div>`;
        }).join('')}</div>
        <div class="ex-fb${has?' show':''}${has?(a===q.correct?' correct':' wrong'):''}">${has?(a===q.correct?'‚úì Correct!':'‚úó The correct shortcut is: '+q.opts[q.correct]):''}</div>
      </div>`;
    }).join('')+mkScore('sc',correct,total);
}
function ansSC(i,v){if(scAns[i]!==undefined)return;scAns[i]=v;renderSC();}
renderSC();

// ============ TIMED PRACTICE ============
const PST=[
  {t:1,tp:'6A',q:'What are the solutions of <code>x¬≤ ‚àí 3x ‚àí 10 = 0</code>?',
   ch:['x = ‚àí2 and x = 5','x = 2 and x = ‚àí5','x = ‚àí2 and x = ‚àí5','x = 2 and x = 5'],c:0,
   fb:'<strong>Desmos:</strong> Graph y = x¬≤ ‚àí 3x ‚àí 10, click x-intercepts ‚Üí (‚àí2, 0) and (5, 0). <strong>Algebra:</strong> Factor (x‚àí5)(x+2) = 0.',
   trap:'intersection_misread',trapAnswer:3,trapDesc:'Misread the signs of the x-intercepts ‚Äî Intersection Misread'},
  {t:1,tp:'6A',q:'At what point do <code>y = 3x ‚àí 2</code> and <code>y = ‚àíx + 6</code> intersect?',
   ch:['(1, 1)','(2, 4)','(4, 2)','(3, 7)'],c:1,
   fb:'<strong>Desmos:</strong> Graph both, click intersection ‚Üí (2, 4). <strong>Algebra:</strong> 3x‚àí2 = ‚àíx+6 ‚Üí 4x = 8 ‚Üí x=2, y=4.',
   trap:null,trapAnswer:0,trapDesc:'Graphing both lines finds the intersection instantly'},
  {t:1,tp:'6D',q:'What is the vertex of <code>f(x) = ‚àí2x¬≤ + 8x ‚àí 3</code>?',
   ch:['(2, 5)','(‚àí2, ‚àí27)','(4, ‚àí3)','(2, ‚àí3)'],c:0,
   fb:'<strong>Desmos:</strong> Graph it, click vertex ‚Üí (2, 5). <strong>Algebra:</strong> x = ‚àí8/(2¬∑‚àí2) = 2, f(2) = ‚àí8+16‚àí3 = 5.',
   trap:'setup_trap',trapAnswer:3,trapDesc:'Tried algebra and made a sign error ‚Äî Setup Trap: Desmos was faster here'},
  {t:2,tp:'6A',q:'How many real solutions does <code>2x¬≤ ‚àí 4x + 5 = 0</code> have?',
   ch:['0','1','2','Cannot determine'],c:0,
   fb:'<strong>Desmos:</strong> Graph y = 2x¬≤ ‚àí 4x + 5. Parabola stays above x-axis ‚Üí 0 solutions. <strong>Algebra:</strong> Discriminant = 16 ‚àí 40 = ‚àí24 < 0.',
   trap:'mental_math',trapAnswer:2,trapDesc:'Assumed 2 solutions without checking ‚Äî Mental Math Trap'},
  {t:2,tp:'6B',q:'The data points (1,3), (2,5), (3,8), (4,10), (5,13) are best modeled by:',
   ch:['y = 2x + 1','y = 2.5x + 0.5','y = 3x ‚àí 1','y = x¬≤ + 2'],c:1,
   fb:'<strong>Desmos:</strong> Enter as table, run y‚ÇÅ ~ mx‚ÇÅ + b ‚Üí m ‚âà 2.5, b ‚âà 0.5. Always use regression for best-fit. Or use Autoregression.',
   trap:'cas_illusion',trapAnswer:0,trapDesc:'Tried to eyeball the slope instead of using regression ‚Äî CAS Illusion'},
  {t:2,tp:'6A',q:'What is the center of <code>x¬≤ + y¬≤ ‚àí 6x + 4y ‚àí 12 = 0</code>?',
   ch:['(3, ‚àí2)','(‚àí3, 2)','(6, ‚àí4)','(‚àí6, 4)'],c:0,
   fb:'<strong>Desmos:</strong> Type the equation, Desmos draws the circle. Click center ‚Üí (3, ‚àí2). <strong>Algebra:</strong> Complete square ‚Üí (x‚àí3)¬≤+(y+2)¬≤=25.',
   trap:'intersection_misread',trapAnswer:1,trapDesc:'Misread the sign from the completed square ‚Äî Intersection Misread'},
  {t:2,tp:'6C',q:'What is <code>mean(4, 8, 15, 16, 23, 42)</code>?',
   ch:['18','15.5','16','14'],c:0,
   fb:'<strong>Desmos:</strong> Type mean(4,8,15,16,23,42) ‚Üí 18. <strong>Algebra:</strong> Sum = 108, count = 6, 108/6 = 18.',
   trap:'mental_math',trapAnswer:2,trapDesc:'Guessed 16 (the median-ish value) without calculating ‚Äî Mental Math Trap'},
  {t:3,tp:'6C',q:'If <code>f(x) = x¬≥ ‚àí 6x¬≤ + 11x ‚àí 6</code>, how many positive x-intercepts?',
   ch:['0','1','2','3'],c:3,
   fb:'<strong>Desmos:</strong> Graph it. Three crossings at x = 1, 2, 3. All positive. <strong>Algebra:</strong> Factor (x‚àí1)(x‚àí2)(x‚àí3) = 0.',
   trap:'intersection_misread',trapAnswer:1,trapDesc:'Only zoomed in enough to see one crossing ‚Äî Intersection Misread'},
  {t:3,tp:'6A',q:'For what value of b does <code>y = 2x + b</code> pass through (3, 11)?',
   ch:['b = 5','b = 6','b = 17','b = ‚àí5'],c:0,
   fb:'<strong>Desmos:</strong> Slider for b, or type y = 2x + b and point (3, 11). Adjust until line hits point. <strong>Algebra:</strong> 11 = 6 + b ‚Üí b = 5.',
   trap:'setup_trap',trapAnswer:2,trapDesc:'Forgot to subtract and added 2(3)+11 = 17 ‚Äî Setup Trap'},
  {t:3,tp:'6B',q:'Data: (0,100), (1,80), (2,64), (3,51.2). Which model fits best?',
   ch:['Linear: y = ‚àí16x + 100','Quadratic: y = x¬≤ ‚àí 16x + 100','Exponential: y = 100(0.8)À£','None of the above'],c:2,
   fb:'<strong>Desmos:</strong> Use Autoregression ‚Äî enter table, compare R¬≤ values. Exponential decay (√ó0.8 each step) fits perfectly: 100 ‚Üí 80 ‚Üí 64 ‚Üí 51.2.',
   trap:'cas_illusion',trapAnswer:0,trapDesc:'Assumed linear because the first drop is ‚àí20 ‚Äî CAS Illusion: the drop rate changes'},
];

const TRAP_NAMES={'setup_trap':'‚è± Setup Trap','mental_math':'üßÆ Mental Math Trap','cas_illusion':'üîç CAS Illusion','intersection_misread':'üéØ Intersection Misread'};

let pstA={},pstConf={},pstTime={},pstStartTime=null;
let timerEnabled=false,timerInterval=null,timerSeconds=0;
const SECS_PER_Q=95;let totalTimerSecs=PST.length*SECS_PER_Q; // 10 √ó 95 = 950s = 15:50

function toggleTimer(){
  timerEnabled=!timerEnabled;const btn=document.getElementById('timerToggle');
  btn.textContent=timerEnabled?'‚è± Timer ON':'‚è± Timer OFF';btn.classList.toggle('active',timerEnabled);
  if(!timerEnabled&&timerInterval){clearInterval(timerInterval);timerInterval=null;document.getElementById('timerDisplay').textContent='--:--';document.getElementById('timerFill').style.width='100%';}
  else if(timerEnabled&&currentScreen===3){startTimer();}
}
function startTimer(){
  if(timerInterval)clearInterval(timerInterval);timerSeconds=totalTimerSecs;updateTimerDisplay();
  timerInterval=setInterval(()=>{timerSeconds--;updateTimerDisplay();if(timerSeconds<=0){clearInterval(timerInterval);timerInterval=null;}},1000);pstStartTime=Date.now();
}
function updateTimerDisplay(){
  const disp=document.getElementById('timerDisplay'),fill=document.getElementById('timerFill');
  const mins=Math.floor(timerSeconds/60),secs=timerSeconds%60;
  disp.textContent=`${mins}:${secs.toString().padStart(2,'0')}`;
  const pct=(timerSeconds/totalTimerSecs)*100;fill.style.width=pct+'%';
  disp.className='timer-display';fill.className='timer-fill';
  if(pct<15){disp.classList.add('danger');fill.classList.add('danger');}
  else if(pct<35){disp.classList.add('warning');fill.classList.add('warning');}
}

function renderPST(){
  const answered=Object.keys(pstA).length;
  document.getElementById('qDots').innerHTML=PST.map((_,i)=>{let cls='q-dot';if(pstA[i]!==undefined)cls+=pstA[i]===PST[i].c?' correct':' wrong';return `<div class="${cls}"></div>`;}).join('');
  document.getElementById('satPractice').innerHTML=PST.map((q,i)=>{
    const a=pstA[i],h=a!==undefined;const conf=pstConf[i];
    const tierLabel=q.t===1?'Easy':q.t===2?'Medium':'Hard';
    const trapName=q.trap?TRAP_NAMES[q.trap]||'':'';
    return `<div class="ex-item" style="border-color:${q.t===1?'var(--algebra)':q.t===2?'var(--math)':'var(--advanced)'}">
      <div style="margin-bottom:6px;display:flex;align-items:center;gap:8px;flex-wrap:wrap">
        <span class="tier tier-${q.t}">${tierLabel}</span><span style="font-size:.75rem;color:var(--muted)">Topic ${q.tp}</span>
        ${trapName&&h?`<span style="font-size:.72rem;color:var(--accent)">Trap: ${trapName}</span>`:''}
      </div>
      <div class="ex-prompt">${q.q}</div>
      ${!h?`<div class="confidence-row">
        <div class="conf-tag ${conf==='guessing'?'selected':''}" data-conf="guessing" onclick="setConf(${i},'guessing')">Guessing</div>
        <div class="conf-tag ${conf==='unsure'?'selected':''}" data-conf="unsure" onclick="setConf(${i},'unsure')">Unsure</div>
        <div class="conf-tag ${conf==='confident'?'selected':''}" data-conf="confident" onclick="setConf(${i},'confident')">Confident</div>
      </div>`:`<div style="font-size:.72rem;color:var(--muted);margin-bottom:6px">Confidence: ${conf||'not tagged'}</div>`}
      <div class="mc-choices">${q.ch.map((ch,ci)=>{let c='mc-choice';if(h){c+=' mc-dis';if(ci===q.c)c+=' mc-correct';else if(ci===a)c+=' mc-wrong';}return `<div class="${c}" onclick="aPST(${i},${ci})"><div class="mc-letter">${'ABCD'[ci]}</div><div>${ch}</div></div>`;}).join('')}</div>
      <div class="mc-fb${h?' show':''}">${h?(a===q.c?'‚úì Correct! ':'‚úó Incorrect. ')+q.fb+(a!==q.c&&q.trapAnswer===a?'<br><span style="color:var(--psda)">‚ö†Ô∏è '+q.trapDesc+'</span>':''):''}</div>
    </div>`;
  }).join('');
  if(answered===PST.length){if(timerInterval){clearInterval(timerInterval);timerInterval=null;}document.getElementById('practiceNav').style.display='block';showPracticeResults();}
}
function setConf(i,level){if(pstA[i]!==undefined)return;pstConf[i]=level;renderPST();}
function aPST(i,v){if(pstA[i]!==undefined)return;pstA[i]=v;if(pstStartTime){pstTime[i]=Date.now()-pstStartTime;pstStartTime=Date.now();}renderPST();}

function showPracticeResults(){
  const total=PST.length,correct=Object.entries(pstA).filter(([i,v])=>v===PST[i].c).length;
  const byDiff={1:{cor:0,tot:0},2:{cor:0,tot:0},3:{cor:0,tot:0}};
  PST.forEach((q,i)=>{byDiff[q.t].tot++;if(pstA[i]===q.c)byDiff[q.t].cor++;});
  const matrix={};['guessing','unsure','confident'].forEach(c=>{matrix[c]={correct:[],wrong:[]};});
  PST.forEach((q,i)=>{const conf=pstConf[i]||'unsure';matrix[conf][pstA[i]===q.c?'correct':'wrong'].push(i);});
  const errors={content_gap:[],trap_answer:[],careless:[],calibration:[]};
  PST.forEach((q,i)=>{if(pstA[i]===q.c)return;const conf=pstConf[i]||'unsure';if(pstA[i]===q.trapAnswer)errors.trap_answer.push({i,desc:q.trapDesc,topic:q.tp});else errors.content_gap.push({i,topic:q.tp});if(conf==='confident'){if(q.t===1)errors.careless.push({i,topic:q.tp});errors.calibration.push({i,topic:q.tp});}});

  let html=`<div class="results-section"><h3>üìä Practice Results: ${correct}/${total}</h3>
    <div style="margin-bottom:20px"><div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:8px">By Difficulty</div>
    <div class="difficulty-bars">
      <div class="diff-row"><span class="diff-label" style="color:var(--algebra)">Easy</span><div class="diff-track"><div class="diff-fill" style="width:${byDiff[1].tot?byDiff[1].cor/byDiff[1].tot*100:0}%;background:var(--algebra)"></div></div><span class="diff-val" style="color:var(--algebra)">${byDiff[1].cor}/${byDiff[1].tot}</span></div>
      <div class="diff-row"><span class="diff-label" style="color:var(--math)">Medium</span><div class="diff-track"><div class="diff-fill" style="width:${byDiff[2].tot?byDiff[2].cor/byDiff[2].tot*100:0}%;background:var(--math)"></div></div><span class="diff-val" style="color:var(--math)">${byDiff[2].cor}/${byDiff[2].tot}</span></div>
      <div class="diff-row"><span class="diff-label" style="color:var(--advanced)">Hard</span><div class="diff-track"><div class="diff-fill" style="width:${byDiff[3].tot?byDiff[3].cor/byDiff[3].tot*100:0}%;background:var(--advanced)"></div></div><span class="diff-val" style="color:var(--advanced)">${byDiff[3].cor}/${byDiff[3].tot}</span></div>
    </div></div>`;
  html+=`<div style="margin-bottom:20px"><div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:8px">Confidence √ó Accuracy Matrix</div>
    <div class="results-grid">
      <div class="results-grid-header"></div><div class="results-grid-header">Guessing</div><div class="results-grid-header">Unsure</div><div class="results-grid-header">Confident</div>
      <div class="results-grid-header">‚úì Correct</div>
      <div class="results-grid-cell"><div class="cell-label">Lucky</div><div class="cell-dots">${matrix.guessing.correct.map(()=>'<div class="cell-dot" style="background:var(--psda)"></div>').join('')}</div><div style="font-size:.7rem;color:var(--muted)">${matrix.guessing.correct.length}</div></div>
      <div class="results-grid-cell"><div class="cell-label">Developing</div><div class="cell-dots">${matrix.unsure.correct.map(()=>'<div class="cell-dot" style="background:var(--math)"></div>').join('')}</div><div style="font-size:.7rem;color:var(--muted)">${matrix.unsure.correct.length}</div></div>
      <div class="results-grid-cell"><div class="cell-label">Solid</div><div class="cell-dots">${matrix.confident.correct.map(()=>'<div class="cell-dot" style="background:var(--correct)"></div>').join('')}</div><div style="font-size:.7rem;color:var(--muted)">${matrix.confident.correct.length}</div></div>
      <div class="results-grid-header">‚úó Wrong</div>
      <div class="results-grid-cell"><div class="cell-label">Expected</div><div class="cell-dots">${matrix.guessing.wrong.map(()=>'<div class="cell-dot" style="background:var(--muted)"></div>').join('')}</div><div style="font-size:.7rem;color:var(--muted)">${matrix.guessing.wrong.length}</div></div>
      <div class="results-grid-cell"><div class="cell-label">Needs work</div><div class="cell-dots">${matrix.unsure.wrong.map(()=>'<div class="cell-dot" style="background:var(--psda)"></div>').join('')}</div><div style="font-size:.7rem;color:var(--muted)">${matrix.unsure.wrong.length}</div></div>
      <div class="results-grid-cell danger-cell"><div class="cell-label" style="color:var(--wrong);font-weight:700">‚ö†Ô∏è DANGER</div><div class="cell-dots">${matrix.confident.wrong.map(()=>'<div class="cell-dot" style="background:var(--wrong)"></div>').join('')}</div><div style="font-size:.7rem;color:var(--muted)">${matrix.confident.wrong.length}</div></div>
    </div>
    ${matrix.confident.wrong.length>0?'<div class="callout" style="border-color:var(--wrong);background:var(--wrong-bg)"><strong style="color:var(--wrong)">Confident + Wrong</strong> is the most dangerous category. These errors persist because you won\'t self-correct what you think you already know.</div>':''}
  </div>`;
  const hasErrors=errors.trap_answer.length+errors.content_gap.length>0;
  if(hasErrors){
    html+=`<div style="margin-bottom:16px"><div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:8px">Error Pattern Analysis</div>`;
    if(errors.trap_answer.length>0)html+=`<div class="error-category" style="background:rgba(251,191,36,.08);border:1px solid rgba(251,191,36,.3)"><div class="error-label" style="color:var(--psda)">üü° Trap Answers (${errors.trap_answer.length})</div><div class="error-items">${errors.trap_answer.map(e=>e.desc).join(' ¬∑ ')}</div></div>`;
    if(errors.content_gap.length>0)html+=`<div class="error-category" style="background:rgba(239,68,68,.08);border:1px solid rgba(239,68,68,.3)"><div class="error-label" style="color:var(--wrong)">üî¥ Content Gaps (${errors.content_gap.length})</div><div class="error-items">Topics: ${[...new Set(errors.content_gap.map(e=>e.topic))].join(', ')}</div></div>`;
    if(errors.careless.length>0)html+=`<div class="error-category" style="background:rgba(96,165,250,.08);border:1px solid rgba(96,165,250,.3)"><div class="error-label" style="color:var(--math)">üîµ Possible Careless Errors (${errors.careless.length})</div><div class="error-items">Confident + wrong on easy questions ‚Äî likely arithmetic mistakes</div></div>`;
    if(errors.calibration.length>0)html+=`<div class="error-category" style="background:rgba(239,68,68,.08);border:1px solid rgba(239,68,68,.3)"><div class="error-label" style="color:var(--wrong)">‚ö†Ô∏è Calibration Issues (${errors.calibration.length})</div><div class="error-items">You were confident but wrong ‚Äî review these topics carefully</div></div>`;
    html+=`</div>`;
  }
  html+=`</div>`;
  document.getElementById('practiceResults').style.display='block';
  document.getElementById('practiceResults').innerHTML=html;
  document.getElementById('completePracticeStats').innerHTML=`
    <div style="background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px 20px;margin-bottom:24px;max-width:500px;width:100%;text-align:left">
      <div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:8px">Practice Results</div>
      <div style="font-family:'JetBrains Mono',monospace;font-size:1.4rem;font-weight:700;color:var(--correct);margin-bottom:8px">${correct}/${total} correct</div>
      <div style="font-size:.82rem;color:var(--muted)">Easy: ${byDiff[1].cor}/${byDiff[1].tot} ¬∑ Medium: ${byDiff[2].cor}/${byDiff[2].tot} ¬∑ Hard: ${byDiff[3].cor}/${byDiff[3].tot}</div>
    </div>`;
}
renderPST();
</script>
<script src="/translate.js"></script>
</body>
</html>
