<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Module 1: Welcome & Diagnostic ‚Äî PSAT/NMSQT Math ‚Äî PantherPrep</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=Source+Sans+3:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root{--ink:#f0f0f0;--paper:#121212;--accent:#C8102E;--accent-light:rgba(200,16,46,.15);--border:#2a2a2a;--muted:#999;--surface:#1a1a1a;--math:#60a5fa;--math-bg:rgba(96,165,250,.1);--algebra:#34d399;--advanced:#a78bfa;--psda:#fbbf24;--geotrig:#f87171;--correct:#22c55e;--correct-bg:rgba(34,197,94,.12);--wrong:#ef4444;--wrong-bg:rgba(239,68,68,.12);--nm:#d4a017}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Source Sans 3',sans-serif;background:var(--paper);color:var(--ink);line-height:1.65}
.top-stripe{height:4px;background:linear-gradient(90deg,#C8102E 0%,#C8102E 50%,#fff 50%,#fff 100%);position:fixed;top:0;left:0;right:0;z-index:100}

/* PROGRESS BAR */
.progress-bar{position:fixed;top:4px;left:0;right:0;height:3px;background:var(--border);z-index:99}
.progress-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--math));width:0%;transition:width .3s ease}

.container{max-width:800px;margin:0 auto;padding:20px 20px 60px}
.back-link{display:inline-flex;align-items:center;gap:8px;color:var(--muted);font-size:.9rem;padding:8px 0;margin-top:8px;cursor:pointer;text-decoration:none}
.back-link:hover{color:var(--accent)}
.mod-header{padding:40px 0 30px;border-bottom:1px solid var(--border);margin-bottom:32px}
.mod-badge{display:inline-block;background:var(--accent);color:#fff;font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:5px 14px;border-radius:16px;margin-bottom:14px}
.mod-header h1{font-family:'Cormorant Garamond',serif;font-size:clamp(1.8rem,4vw,2.6rem);font-weight:700;margin-bottom:6px}
.mod-header .subtitle{color:var(--muted);font-size:1rem}
.mod-meta{display:flex;gap:20px;margin-top:14px;font-size:.82rem;color:var(--muted)}

.section{margin-bottom:36px}
.section-label{font-size:.7rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--accent);margin-bottom:6px}
.section h2{font-family:'Cormorant Garamond',serif;font-size:1.6rem;font-weight:700;margin-bottom:12px}
.section p{color:#ccc;font-size:.93rem;margin-bottom:12px;line-height:1.7}

.card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:18px 20px;margin-bottom:12px}
.card-accent{border-left:3px solid var(--accent)}
.callout{background:var(--accent-light);border:1px solid rgba(200,16,46,.3);border-radius:10px;padding:14px 18px;margin-bottom:16px;font-size:.9rem}
.callout strong{color:var(--accent)}
.callout-blue{background:var(--math-bg);border-color:rgba(96,165,250,.3)}
.callout-blue strong{color:var(--math)}
.callout-gold{background:rgba(212,160,23,.1);border-color:rgba(212,160,23,.3)}
.callout-gold strong{color:var(--nm)}

/* STRUCTURE TABLE */
.struct-table{width:100%;border-collapse:collapse;font-size:.88rem;margin-bottom:16px}
.struct-table th,.struct-table td{padding:10px 12px;border:1px solid var(--border);text-align:left;vertical-align:top}
.struct-table th{background:var(--surface);font-weight:700;font-size:.78rem;text-transform:uppercase;letter-spacing:.5px;color:var(--muted)}
.struct-table td{color:#ccc}
.struct-table code{background:rgba(96,165,250,.1);color:var(--math);padding:1px 6px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:.82rem}

/* DOMAIN CARDS */
.domain-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:16px}
.domain-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px;transition:all .3s;cursor:pointer;position:relative;overflow:hidden}
.domain-card:hover{transform:translateY(-2px)}
.domain-card.flipped .dc-front{display:none}
.domain-card.flipped .dc-back{display:block}
.dc-header{display:flex;align-items:center;gap:10px;margin-bottom:8px}
.dc-pct{font-family:'JetBrains Mono',monospace;font-size:1.3rem;font-weight:700}
.dc-name{font-weight:700;font-size:.95rem}
.dc-qs{font-size:.82rem;color:var(--muted)}
.dc-topics{font-size:.82rem;color:var(--muted);line-height:1.5;margin-top:4px}
.dc-back{display:none;font-size:.85rem;color:#ccc;line-height:1.6}
.dc-flip{font-size:.68rem;color:var(--muted);text-align:right;margin-top:6px}

/* ADAPTIVE VISUAL */
.adaptive{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:20px;margin-bottom:16px}
.adaptive-flow{display:flex;flex-direction:column;align-items:center;gap:8px}
.adaptive-box{padding:12px 20px;border-radius:10px;text-align:center;font-size:.88rem;font-weight:600;min-width:200px;transition:all .3s}
.adaptive-arrow{color:var(--muted);font-size:1.2rem}
.adaptive-split{display:flex;gap:16px;width:100%}
.adaptive-branch{flex:1;text-align:center}

/* ROUTING SIMULATOR */
.sim-container{background:var(--surface);border:2px solid var(--math);border-radius:14px;padding:22px;margin-bottom:16px}
.sim-slider-row{display:flex;align-items:center;gap:14px;margin-bottom:16px}
.sim-slider{flex:1;-webkit-appearance:none;appearance:none;height:8px;border-radius:4px;background:linear-gradient(90deg,var(--wrong) 0%,var(--psda) 50%,var(--correct) 100%);outline:none}
.sim-slider::-webkit-slider-thumb{-webkit-appearance:none;width:24px;height:24px;border-radius:50%;background:var(--ink);border:3px solid var(--math);cursor:pointer}
.sim-slider::-moz-range-thumb{width:24px;height:24px;border-radius:50%;background:var(--ink);border:3px solid var(--math);cursor:pointer}
.sim-val{font-family:'JetBrains Mono',monospace;font-size:1.4rem;font-weight:700;min-width:60px;text-align:center}
.sim-result{text-align:center;padding:16px;border-radius:10px;transition:all .3s}
.sim-meter{height:12px;border-radius:6px;background:var(--border);margin:10px 0;overflow:hidden}
.sim-meter-fill{height:100%;border-radius:6px;transition:width .4s ease,background .4s ease}

/* SELECTION INDEX CALCULATOR */
.si-calc{background:var(--surface);border:2px solid var(--nm);border-radius:14px;padding:22px;margin-bottom:16px}
.si-inputs{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px}
.si-field label{display:block;font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:6px}
.si-field input{width:100%;padding:10px;background:var(--paper);border:1px solid var(--border);border-radius:8px;color:var(--ink);font-family:'JetBrains Mono',monospace;font-size:1.2rem;text-align:center}
.si-field input:focus{border-color:var(--nm);outline:none}
.si-result{text-align:center;padding:16px;border-radius:10px;background:var(--paper)}
.si-big{font-family:'JetBrains Mono',monospace;font-size:2.4rem;font-weight:700;color:var(--nm)}
.si-label{font-size:.82rem;color:var(--muted);margin-top:4px}

/* STATE CUTOFFS */
.state-select{width:100%;padding:10px 14px;background:var(--paper);border:1px solid var(--border);border-radius:8px;color:var(--ink);font-family:inherit;font-size:.95rem;cursor:pointer;margin-bottom:12px}
.state-select:focus{border-color:var(--nm);outline:none}
.cutoff-result{background:var(--paper);border-radius:10px;padding:16px;text-align:center;display:none}
.cutoff-val{font-family:'JetBrains Mono',monospace;font-size:1.8rem;font-weight:700;color:var(--nm)}
.cutoff-label{font-size:.82rem;color:var(--muted);margin-top:4px}
.cutoff-bar{height:10px;border-radius:5px;background:var(--border);margin:12px 0;overflow:hidden;position:relative}
.cutoff-bar-fill{height:100%;border-radius:5px;background:linear-gradient(90deg,var(--correct),var(--nm));transition:width .5s ease}
.cutoff-bar-marker{position:absolute;top:-4px;width:3px;height:18px;background:var(--ink);border-radius:2px;transition:left .5s ease}

/* ERROR CLASSIFICATION */
.ec-box{background:var(--surface);border:2px solid var(--math);border-radius:14px;padding:22px;margin-bottom:16px}
.ec-item{background:var(--paper);border-radius:10px;padding:14px;margin-bottom:10px;transition:all .3s}
.ec-scenario{font-size:.92rem;line-height:1.6;margin-bottom:10px;color:#ddd}
.ec-options{display:flex;flex-wrap:wrap;gap:6px}
.ec-opt{padding:6px 14px;background:var(--surface);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.82rem;transition:all .15s}
.ec-opt:hover:not(.ec-dis){border-color:var(--accent);background:var(--accent-light)}
.ec-opt.ec-correct{border-color:var(--correct);background:var(--correct-bg);color:var(--correct)}
.ec-opt.ec-wrong{border-color:var(--wrong);background:var(--wrong-bg);color:var(--wrong)}
.ec-opt.ec-dis{pointer-events:none;opacity:.6}
.ec-fb{margin-top:8px;font-size:.82rem;color:var(--muted);display:none;line-height:1.4}
.ec-fb.show{display:block}

/* MINI DIAGNOSTIC */
.diag-q{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:18px;margin-bottom:12px;transition:all .3s}
.diag-q.answered{opacity:.85}
.diag-domain{font-size:.68rem;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;margin-bottom:6px;display:inline-block;padding:2px 8px;border-radius:4px}
.diag-stem{font-size:.93rem;margin-bottom:12px;color:#ddd;line-height:1.7}
.diag-stem code{background:rgba(96,165,250,.1);color:var(--math);padding:1px 6px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:.85rem}
.diag-choices{display:flex;flex-direction:column;gap:6px}
.diag-choice{padding:10px 14px;background:var(--paper);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.88rem;transition:all .15s;display:flex;align-items:center;gap:10px}
.diag-choice:hover:not(.dc-dis){border-color:var(--math);background:var(--math-bg)}
.diag-choice .letter{font-weight:700;color:var(--muted);min-width:20px}
.diag-choice.dc-correct{border-color:var(--correct);background:var(--correct-bg)}
.diag-choice.dc-wrong{border-color:var(--wrong);background:var(--wrong-bg)}
.diag-choice.dc-dis{pointer-events:none;opacity:.7}
.diag-choice.dc-correct .letter{color:var(--correct)}
.diag-choice.dc-wrong .letter{color:var(--wrong)}
.diag-explain{margin-top:10px;padding:12px;background:var(--paper);border-radius:8px;font-size:.85rem;color:var(--muted);line-height:1.6;display:none;border-left:3px solid var(--correct)}
.diag-explain.show{display:block}
.diag-conf{display:flex;gap:6px;margin-top:8px;margin-bottom:4px}
.diag-conf-btn{padding:4px 12px;border-radius:6px;border:1px solid var(--border);background:var(--paper);color:var(--muted);cursor:pointer;font-size:.75rem;transition:all .15s}
.diag-conf-btn:hover{border-color:var(--math)}
.diag-conf-btn.active{border-color:var(--math);background:var(--math-bg);color:var(--math)}

/* RESULTS DASHBOARD */
.results{background:var(--surface);border:2px solid var(--math);border-radius:14px;padding:22px;margin-bottom:16px}
.results-score{text-align:center;margin-bottom:16px}
.results-big{font-family:'JetBrains Mono',monospace;font-size:3rem;font-weight:700}
.results-sub{font-size:.88rem;color:var(--muted)}
.results-domains{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:16px}
.results-domain{padding:12px;background:var(--paper);border-radius:8px;text-align:center}
.results-domain-name{font-size:.75rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:4px}
.results-domain-score{font-family:'JetBrains Mono',monospace;font-size:1.2rem;font-weight:700}
.results-domain-bar{height:6px;border-radius:3px;background:var(--border);margin-top:6px;overflow:hidden}
.results-domain-fill{height:100%;border-radius:3px;transition:width .6s ease}

/* ERROR ANALYSIS WORKSHEET */
.worksheet{background:var(--surface);border:2px solid var(--advanced);border-radius:14px;padding:22px;margin-bottom:16px}
.ws-entry{background:var(--paper);border-radius:10px;padding:14px;margin-bottom:10px;border:1px solid var(--border)}
.ws-row{display:grid;grid-template-columns:auto 1fr;gap:8px 12px;align-items:center;margin-bottom:6px}
.ws-label{font-size:.8rem;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.5px;white-space:nowrap}
.ws-input,.ws-select{padding:6px 10px;background:var(--surface);border:1px solid var(--border);border-radius:6px;color:var(--ink);font-family:inherit;font-size:.85rem}
.ws-input:focus,.ws-select:focus{border-color:var(--math);outline:none}
.ws-textarea{width:100%;padding:6px 10px;background:var(--surface);border:1px solid var(--border);border-radius:6px;color:var(--ink);font-family:inherit;font-size:.85rem;resize:vertical;min-height:40px}
.ws-textarea:focus{border-color:var(--math);outline:none}

/* CHECKLIST */
.checklist{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:20px;margin-bottom:16px}
.cl-item{display:flex;align-items:flex-start;gap:10px;padding:7px 0;border-bottom:1px solid var(--border);font-size:.9rem;color:#ccc;cursor:pointer;transition:all .2s}
.cl-item:last-child{border-bottom:none}
.cl-item.done{opacity:.5;text-decoration:line-through}
.cl-check{flex-shrink:0;width:22px;height:22px;border:2px solid var(--border);border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:.7rem;transition:all .15s}
.cl-item.done .cl-check{background:var(--correct);border-color:var(--correct);color:#fff}
.cl-progress{font-size:.82rem;color:var(--muted);margin-top:8px;text-align:right}

/* PROTOCOL STEPS */
.protocol{background:var(--surface);border:2px solid var(--accent);border-radius:14px;overflow:hidden;margin-bottom:16px}
.protocol-title{background:var(--accent);padding:12px 20px;font-weight:700;font-size:.95rem}
.protocol-step{display:flex;gap:14px;padding:14px 20px;border-bottom:1px solid var(--border);font-size:.9rem;color:#ccc;align-items:flex-start}
.protocol-step:last-child{border-bottom:none}
.step-num{flex-shrink:0;width:28px;height:28px;border-radius:50%;background:var(--accent-light);border:1px solid var(--accent);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.82rem;color:var(--accent);font-family:'JetBrains Mono',monospace}

.btn{display:inline-block;background:var(--accent);color:#fff;font-family:inherit;font-size:.9rem;font-weight:600;padding:10px 24px;border:none;border-radius:8px;cursor:pointer;transition:all .2s}
.btn:hover{background:#a00d24}
.btn-sm{padding:8px 16px;font-size:.82rem}
.btn-blue{background:var(--math)}.btn-blue:hover{background:#4b8fda}
.btn-gold{background:var(--nm)}.btn-gold:hover{background:#b8880f}
.btn-outline{background:transparent;border:2px solid var(--accent);color:var(--accent)}
.btn-outline:hover{background:var(--accent-light)}

/* NAV */
.mod-nav{display:flex;justify-content:space-between;align-items:center;padding:20px 0;border-top:1px solid var(--border);margin-top:40px}
.mod-nav a{color:var(--accent);text-decoration:none;font-weight:600;font-size:.9rem;display:flex;align-items:center;gap:6px}
.mod-nav a:hover{text-decoration:underline}

/* ANIMATIONS */
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.fade-in{animation:fadeIn .4s ease forwards}

@media(max-width:600px){
  .mod-meta{flex-wrap:wrap;gap:10px}
  .domain-grid{grid-template-columns:1fr}
  .adaptive-split{flex-direction:column}
  .si-inputs{grid-template-columns:1fr}
  .results-domains{grid-template-columns:1fr}
  .ec-options{flex-direction:column}
}
</style>
</head>
<body>
<div class="top-stripe"></div>
<div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
<div class="container">
<a class="back-link" href="index.html">‚Üê Back to PSAT Math Course</a>

<div class="mod-header">
  <div class="mod-badge">Module 1</div>
  <h1>Welcome to the PSAT & Diagnostic</h1>
  <p class="subtitle">Understand the test, set your goal, establish your baseline, and build your personalized study plan.</p>
  <div class="mod-meta">
    <span>‚è± ~60 minutes</span>
    <span>üìã 3 sessions</span>
    <span>üîç Phase 1: Orient</span>
  </div>
</div>

<!-- ==================== SECTION 1: TEST STRUCTURE ==================== -->
<div class="section">
  <div class="section-label">Know Your Test</div>
  <h2>Digital PSAT/NMSQT Math: Structure & Format</h2>
  <p>The PSAT/NMSQT Math section is <strong>structurally identical to the Digital SAT Math section</strong> ‚Äî same number of questions, same timing, same adaptive format, same Desmos calculator. The difference? The PSAT caps at a 760 scaled score and excludes the hardest question types.</p>
  <table class="struct-table">
    <tr><th>Feature</th><th>Details</th></tr>
    <tr><td><strong>Total Questions</strong></td><td><code>44</code> (22 per module)</td></tr>
    <tr><td><strong>Total Time</strong></td><td><code>70 minutes</code> (35 per module)</td></tr>
    <tr><td><strong>Time per Question</strong></td><td>~<code>95 seconds</code> average</td></tr>
    <tr><td><strong>Adaptive Format</strong></td><td>Module 2 difficulty adjusts based on Module 1 performance</td></tr>
    <tr><td><strong>Question Types</strong></td><td>~75% multiple choice (4 options) &amp; ~25% student-produced response</td></tr>
    <tr><td><strong>Calculator</strong></td><td>Built-in <strong>Desmos graphing calculator</strong> on ALL questions</td></tr>
    <tr><td><strong>Scoring</strong></td><td><code>160‚Äì760</code> Math section score (no penalty for wrong answers)</td></tr>
    <tr><td><strong>Reference Sheet</strong></td><td>Area, volume, special right triangles, and circle formulas provided</td></tr>
  </table>
  <div class="callout-blue callout"><strong>No wrong-answer penalty</strong> means you should <strong>answer every single question</strong> ‚Äî even if you have to guess. A random guess gives you a 25% chance on multiple choice. Never leave anything blank.</div>
</div>

<!-- ==================== SECTION 2: ADAPTIVE MODULE VISUAL ==================== -->
<div class="section">
  <div class="section-label">How It Works</div>
  <h2>The Adaptive Module System</h2>
  <p>The PSAT uses <strong>multistage adaptive testing (MST)</strong>. You can't skip ahead to Module 2 or go back to Module 1. Your Module 1 performance determines which version of Module 2 you receive.</p>
  <div class="adaptive">
    <div class="adaptive-flow">
      <div class="adaptive-box" style="background:var(--math-bg);border:2px solid var(--math)">
        Module 1: Mixed Difficulty<br>
        <span style="font-size:.78rem;color:var(--muted)">22 questions ¬∑ 35 minutes ¬∑ Easy ‚Üí Hard</span>
      </div>
      <div class="adaptive-arrow">‚Üì Your performance determines‚Ä¶</div>
      <div class="adaptive-split">
        <div class="adaptive-branch">
          <div class="adaptive-box" style="background:var(--correct-bg);border:2px solid var(--correct)">
            Module 2: <strong>Harder</strong><br>
            <span style="font-size:.78rem;color:var(--muted)">Unlocks scores up to 760</span>
          </div>
        </div>
        <div class="adaptive-branch">
          <div class="adaptive-box" style="background:var(--wrong-bg);border:2px solid var(--wrong)">
            Module 2: <strong>Easier</strong><br>
            <span style="font-size:.78rem;color:var(--muted)">Score ceiling ~550‚Äì650</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="callout"><strong>The Module 1 Imperative:</strong> Getting routed to the easier Module 2 <em>caps your maximum possible score</em> ‚Äî even if you ace every question in Module 2. Accuracy on the first 22 questions is more important than speed.</div>
</div>

<!-- ==================== SECTION 3: ROUTING SIMULATOR ==================== -->
<div class="section">
  <div class="section-label">Interactive: Try It</div>
  <h2>Routing Simulator</h2>
  <p>Slide to see how your Module 1 performance affects your scoring potential. Notice how the score ceiling changes dramatically around the routing threshold.</p>
  <div class="sim-container">
    <div style="text-align:center;font-size:.82rem;color:var(--muted);margin-bottom:8px">Module 1 Correct Answers</div>
    <div class="sim-slider-row">
      <span style="font-size:.78rem;color:var(--muted)">0</span>
      <input type="range" class="sim-slider" id="simSlider" min="0" max="22" value="11" oninput="updateSim()">
      <span style="font-size:.78rem;color:var(--muted)">22</span>
      <div class="sim-val" id="simVal">11</div>
    </div>
    <div class="sim-result" id="simResult"></div>
    <div style="margin-top:12px">
      <div style="display:flex;justify-content:space-between;font-size:.72rem;color:var(--muted);margin-bottom:4px">
        <span>Score Floor</span>
        <span id="simRange">‚Äî</span>
        <span>Score Ceiling</span>
      </div>
      <div class="sim-meter"><div class="sim-meter-fill" id="simMeter"></div></div>
    </div>
  </div>
</div>

<!-- ==================== SECTION 4: FOUR DOMAINS ==================== -->
<div class="section">
  <div class="section-label">Content Breakdown</div>
  <h2>The Four Content Domains</h2>
  <p>Click each domain card to flip it and see the specific topics tested.</p>
  <div class="domain-grid" id="domainGrid"></div>
  <div class="callout-blue callout"><strong>Key Insight:</strong> Algebra and Advanced Math together account for roughly <strong>70%</strong> of the test. If you only have limited study time, these two domains give you the biggest return on investment.</div>
</div>

<!-- ==================== SECTION 5: NATIONAL MERIT ==================== -->
<div class="section">
  <div class="section-label">Why It Matters</div>
  <h2>National Merit & the Selection Index</h2>
  <p>The PSAT/NMSQT isn't just practice for the SAT ‚Äî it's the <strong>only path to National Merit Scholarships</strong>. Your scores generate a Selection Index that determines whether you qualify as a Commended Student or Semifinalist.</p>

  <div class="card" style="border-color:var(--nm);margin-bottom:16px">
    <div style="text-align:center;padding:8px 0">
      <div style="font-size:.82rem;color:var(--muted);margin-bottom:4px">The Formula</div>
      <div style="font-family:'JetBrains Mono',monospace;font-size:1.1rem;color:var(--nm);background:var(--paper);display:inline-block;padding:10px 20px;border-radius:8px">
        Selection Index = (RW √ó 2 + Math) √∑ 10
      </div>
      <div style="font-size:.82rem;color:var(--muted);margin-top:8px">Range: 48‚Äì228 ¬∑ Reading & Writing is <strong style="color:var(--nm)">double-weighted</strong></div>
    </div>
  </div>

  <div class="callout-gold callout"><strong>Why this matters for Math prep:</strong> Because RW is double-weighted, a 10-point RW improvement adds 2 Selection Index points while a 10-point Math improvement adds only 1. Don't neglect RW ‚Äî but a strong Math score is still essential. Most Semifinalists need Math scores above 700.</div>

  <h3 style="font-family:'Cormorant Garamond',serif;font-size:1.2rem;margin:16px 0 10px">Selection Index Calculator</h3>
  <div class="si-calc">
    <div class="si-inputs">
      <div class="si-field">
        <label>Reading & Writing Score</label>
        <input type="number" id="siRW" min="160" max="760" placeholder="160‚Äì760" oninput="calcSI()">
      </div>
      <div class="si-field">
        <label>Math Score</label>
        <input type="number" id="siMath" min="160" max="760" placeholder="160‚Äì760" oninput="calcSI()">
      </div>
    </div>
    <div class="si-result" id="siResult">
      <div style="color:var(--muted);font-size:.9rem">Enter both scores to see your Selection Index</div>
    </div>
  </div>

  <h3 style="font-family:'Cormorant Garamond',serif;font-size:1.2rem;margin:16px 0 10px">State Cutoff Lookup</h3>
  <p>Semifinalist cutoffs vary by state. Select your state to see the estimated cutoff and your target.</p>
  <select class="state-select" id="stateSelect" onchange="showCutoff()">
    <option value="">Select your state‚Ä¶</option>
  </select>
  <div class="cutoff-result" id="cutoffResult">
    <div class="cutoff-label">Estimated Semifinalist Cutoff</div>
    <div class="cutoff-val" id="cutoffVal">‚Äî</div>
    <div class="cutoff-bar">
      <div class="cutoff-bar-fill" id="cutoffFill"></div>
      <div class="cutoff-bar-marker" id="cutoffMarker" style="display:none"></div>
    </div>
    <div id="cutoffContext" style="font-size:.82rem;color:var(--muted);margin-top:8px"></div>
  </div>
</div>

<!-- ==================== SECTION 6: MINI DIAGNOSTIC ==================== -->
<div class="section">
  <div class="section-label">Session 2: Diagnostic</div>
  <h2>Mini Diagnostic Assessment</h2>
  <p>Answer these 12 questions spanning all four domains. For each question, first rate your confidence, then select your answer. This helps identify both skill gaps <em>and</em> calibration gaps (questions you felt confident about but got wrong).</p>
  <div id="diagQuestions"></div>
  <div style="text-align:center;margin-top:16px">
    <button class="btn btn-blue" id="diagSubmit" onclick="scoreDiag()" style="display:none">Score My Diagnostic ‚Üí</button>
  </div>
  <div id="diagResults" style="display:none"></div>
</div>

<!-- ==================== SECTION 7: ERROR CLASSIFICATION ==================== -->
<div class="section">
  <div class="section-label">Session 2: Interactive Exercise</div>
  <h2>Error Classification Practice</h2>
  <p>Before analyzing your own mistakes, practice classifying these common PSAT math errors. Correctly identifying your error type is the key to knowing what to study.</p>
  <div class="ec-box" id="ecBox"></div>
  <div id="ecScore" style="text-align:center;padding:10px 0;font-size:.88rem;color:var(--muted)"></div>
</div>

<!-- ==================== SECTION 8: BASELINE PROTOCOL ==================== -->
<div class="section">
  <div class="section-label">Session 3: Full Baseline</div>
  <h2>Baseline Assessment Protocol</h2>
  <p>After the mini diagnostic, take a full-length PSAT Math section using the Bluebook app. This establishes your true baseline score.</p>
  <div class="protocol">
    <div class="protocol-title">Full Baseline Protocol</div>
    <div class="protocol-step"><div class="step-num">1</div><div>Open the <a href="https://bluebook.collegeboard.org/" target="_blank" style="color:var(--math)">Bluebook app</a> and select a PSAT practice test. Take only the Math section (44 questions, 70 minutes).</div></div>
    <div class="protocol-step"><div class="step-num">2</div><div><strong>Use the built-in Desmos calculator</strong> during the baseline ‚Äî this establishes your current comfort level with the tool.</div></div>
    <div class="protocol-step"><div class="step-num">3</div><div>Simulate test conditions: no phone, no notes, timed modules, quiet environment. No pausing between modules.</div></div>
    <div class="protocol-step"><div class="step-num">4</div><div>After completion, <strong>mark every question you were unsure about</strong>, even if you got it correct. "Lucky correct" answers mask skill gaps.</div></div>
    <div class="protocol-step"><div class="step-num">5</div><div>Review your score report. Note which domain(s) had the most errors.</div></div>
    <div class="protocol-step"><div class="step-num">6</div><div>Complete the Error Analysis Worksheet below for every missed <strong>and</strong> uncertain question.</div></div>
  </div>
</div>

<!-- PRE-TEST CHECKLIST -->
<div class="section">
  <div class="section-label">Preparation</div>
  <h2>Pre-Test Checklist</h2>
  <div class="checklist" id="preChecklist"></div>
</div>

<!-- ==================== SECTION 9: ERROR ANALYSIS WORKSHEET ==================== -->
<div class="section">
  <div class="section-label">Session 3: Interactive Tool</div>
  <h2>Error Analysis Worksheet</h2>
  <p>For every missed or uncertain question on your baseline test, fill in one entry. Data saves in your browser.</p>
  <div class="worksheet" id="worksheet">
    <h3 style="font-family:'Cormorant Garamond',serif;font-size:1.2rem;margin-bottom:4px">üìä PSAT Math Error Analysis</h3>
    <div style="font-size:.85rem;color:var(--muted);margin-bottom:14px">Complete one entry per missed/uncertain question</div>
    <div id="wsEntries"></div>
    <div style="display:flex;gap:8px;margin-top:12px;flex-wrap:wrap">
      <button class="btn btn-blue btn-sm" onclick="addEntry()">+ Add Entry</button>
      <button class="btn btn-sm btn-outline" onclick="exportWS()">üìã Export to Clipboard</button>
      <button class="btn btn-sm" style="background:var(--wrong)" onclick="if(confirm('Clear all entries?')){localStorage.removeItem(WS_KEY);renderWS();}">Reset</button>
    </div>
  </div>
</div>

<!-- ==================== SECTION 10: SCORE & STUDY PLAN ==================== -->
<div class="section">
  <div class="section-label">Session 3: Results</div>
  <h2>Baseline Score & Study Plan</h2>
  <div class="card" style="border:2px solid var(--math)">
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px">
      <div>
        <div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:6px">Module 1 Raw Score</div>
        <input type="number" id="m1Score" placeholder="/22" min="0" max="22" style="width:80px;padding:8px;background:var(--paper);border:1px solid var(--border);border-radius:8px;color:var(--ink);font-family:'JetBrains Mono',monospace;font-size:1.2rem;text-align:center" oninput="updateScores()">
      </div>
      <div>
        <div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:6px">Module 2 Raw Score</div>
        <input type="number" id="m2Score" placeholder="/22" min="0" max="22" style="width:80px;padding:8px;background:var(--paper);border:1px solid var(--border);border-radius:8px;color:var(--ink);font-family:'JetBrains Mono',monospace;font-size:1.2rem;text-align:center" oninput="updateScores()">
      </div>
    </div>
    <div id="scoreResult" style="text-align:center;font-size:.9rem;color:var(--muted);margin-bottom:16px">Enter both scores to see your total and recommended pathway.</div>
    <div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:6px;margin-top:16px">Top 3 Priority Areas</div>
    <div style="display:flex;flex-direction:column;gap:6px">
      <input type="text" placeholder="e.g., Quadratic equations ‚Äî vertex form" style="padding:8px 10px;background:var(--paper);border:1px solid var(--border);border-radius:6px;color:var(--ink);font-family:inherit;font-size:.88rem">
      <input type="text" placeholder="e.g., Systems of equations ‚Äî elimination method" style="padding:8px 10px;background:var(--paper);border:1px solid var(--border);border-radius:6px;color:var(--ink);font-family:inherit;font-size:.88rem">
      <input type="text" placeholder="e.g., Desmos ‚Äî not comfortable with regressions" style="padding:8px 10px;background:var(--paper);border:1px solid var(--border);border-radius:6px;color:var(--ink);font-family:inherit;font-size:.88rem">
    </div>
  </div>
</div>

<!-- KEY TAKEAWAYS -->
<div class="section">
  <div class="section-label">Summary</div>
  <h2>Key Takeaways</h2>
  <div class="card card-accent">
    <ol style="padding-left:18px;font-size:.93rem;color:#ccc;line-height:2">
      <li>The PSAT/NMSQT Math section has <strong>44 questions in 70 minutes</strong>, split into two adaptive modules of 22 questions each.</li>
      <li>Module 1 performance determines your Module 2 difficulty ‚Äî and your <strong>score ceiling</strong>. Accuracy in Module 1 matters most.</li>
      <li>The four domains are Algebra (~35%), Advanced Math (~35%), Problem-Solving & Data Analysis (~15%), and Geometry & Trigonometry (~15%).</li>
      <li>A <strong>Desmos graphing calculator</strong> is available on every question. Mastering it is a competitive advantage.</li>
      <li>There's <strong>no penalty for wrong answers</strong> ‚Äî never leave a question blank.</li>
      <li>For National Merit, the Selection Index <strong>double-weights Reading & Writing</strong>. A strong Math score is necessary but not sufficient.</li>
      <li>Error analysis is the most powerful study tool: identify <em>why</em> you missed a question, not just <em>what</em> you missed.</li>
    </ol>
  </div>
</div>

<div class="mod-nav">
  <a href="index.html">‚Üê Course Home</a>
  <a href="module-2.html">Module 2: Algebra ‚Üí</a>
</div>
</div>

<script>
// ============ PROGRESS BAR ============
window.addEventListener('scroll',()=>{
  const h=document.documentElement.scrollHeight-window.innerHeight;
  const pct=h>0?(window.scrollY/h)*100:0;
  document.getElementById('progressFill').style.width=Math.min(pct,100)+'%';
});

// ============ ROUTING SIMULATOR ============
function updateSim(){
  const v=parseInt(document.getElementById('simSlider').value);
  document.getElementById('simVal').textContent=v;
  const pct=v/22;
  let route,color,floor,ceil,bg;
  if(pct>=.64){
    route='Harder Module 2';color='var(--correct)';floor=400;ceil=760;bg='var(--correct-bg)';
  }else if(pct>=.5){
    route='Borderline ‚Äî Could go either way';color='var(--psda)';floor=350;ceil=680;bg='rgba(251,191,36,.1)';
  }else{
    route='Easier Module 2';color='var(--wrong)';floor=160;ceil=Math.min(550+v*10,650);bg='var(--wrong-bg)';
  }
  document.getElementById('simResult').innerHTML=`
    <div style="font-size:1rem;font-weight:700;color:${color};margin-bottom:4px">${v}/22 correct ‚Üí ${route}</div>
    <div style="font-size:.85rem;color:var(--muted)">Estimated score range: ${floor}‚Äì${ceil}</div>`;
  document.getElementById('simResult').style.background=bg;
  const meterPct=((ceil-160)/600)*100;
  const fill=document.getElementById('simMeter');
  fill.style.width=meterPct+'%';
  fill.style.background=pct>=.64?'var(--correct)':pct>=.5?'var(--psda)':'var(--wrong)';
  document.getElementById('simRange').textContent=floor+'‚Äì'+ceil;
}
updateSim();

// ============ DOMAIN CARDS ============
const DOMAINS=[
  {name:'Algebra',pct:'~35%',qs:'13‚Äì15 questions',color:'var(--algebra)',
   front:'Linear equations, systems, inequalities, functions',
   back:'<strong>Topics:</strong> One-variable linear equations ¬∑ Slope-intercept, point-slope, standard form ¬∑ Systems by substitution & elimination ¬∑ Linear inequalities ¬∑ Interpreting slope & y-intercept in context'},
  {name:'Advanced Math',pct:'~35%',qs:'12‚Äì14 questions',color:'var(--advanced)',
   front:'Quadratics, polynomials, functions, exponents',
   back:'<strong>Topics:</strong> Three quadratic forms (standard, vertex, factored) ¬∑ Discriminant ¬∑ Factoring ¬∑ Exponent rules ¬∑ Function notation & transformations ¬∑ Exponential growth/decay ¬∑ Rational & radical expressions'},
  {name:'Problem-Solving & Data',pct:'~15%',qs:'5‚Äì7 questions',color:'var(--psda)',
   front:'Ratios, percentages, statistics, probability',
   back:'<strong>Topics:</strong> Ratios & rates ¬∑ Percentages & percent change ¬∑ Mean, median, spread ¬∑ Scatterplots & lines of best fit ¬∑ Probability ¬∑ Study design (observational vs. experimental)'},
  {name:'Geometry & Trig',pct:'~15%',qs:'4‚Äì6 questions',color:'var(--geotrig)',
   front:'Area, volume, triangles, circles, SOH-CAH-TOA',
   back:'<strong>Topics:</strong> Area & volume of 2D/3D shapes ¬∑ Lines, angles, triangles ¬∑ Pythagorean theorem ¬∑ Similar triangles ¬∑ SOH-CAH-TOA ¬∑ Arc length & sector area ¬∑ Circle equations'}
];
document.getElementById('domainGrid').innerHTML=DOMAINS.map((d,i)=>`
  <div class="domain-card" onclick="this.classList.toggle('flipped')">
    <div class="dc-front">
      <div class="dc-header"><div class="dc-pct" style="color:${d.color}">${d.pct}</div><div class="dc-name">${d.name}</div></div>
      <div class="dc-qs">${d.qs}</div>
      <div class="dc-topics">${d.front}</div>
      <div class="dc-flip">tap to see topics ‚Üí</div>
    </div>
    <div class="dc-back">${d.back}<div class="dc-flip">‚Üê tap to flip back</div></div>
  </div>`).join('');

// ============ SELECTION INDEX CALCULATOR ============
function calcSI(){
  const rw=parseInt(document.getElementById('siRW').value);
  const m=parseInt(document.getElementById('siMath').value);
  const el=document.getElementById('siResult');
  if(isNaN(rw)||isNaN(m)){el.innerHTML='<div style="color:var(--muted);font-size:.9rem">Enter both scores to see your Selection Index</div>';return;}
  const si=Math.round((rw*2+m)/10);
  const total=rw+m;
  let level='',lcolor='';
  if(si>=220){level='Strong National Merit Semifinalist contender in most states';lcolor='var(--nm)';}
  else if(si>=210){level='Commended Student range ‚Äî Semifinalist in some states';lcolor='var(--correct)';}
  else if(si>=200){level='Above average ‚Äî near Commended threshold';lcolor='var(--psda)';}
  else{level='Below Commended threshold ‚Äî focus on building core skills';lcolor='var(--muted)';}
  el.innerHTML=`
    <div class="si-big">${si}</div>
    <div class="si-label">Selection Index (out of 228)</div>
    <div style="margin-top:8px;font-size:.88rem;color:${lcolor}">${level}</div>
    <div style="margin-top:6px;font-size:.82rem;color:var(--muted)">Total: ${total} (RW ${rw} + Math ${m})</div>`;
}

// ============ STATE CUTOFFS ============
const CUTOFFS={
  'Alabama':215,'Alaska':213,'Arizona':220,'Arkansas':213,'California':224,
  'Colorado':221,'Connecticut':223,'Delaware':220,'DC':225,'Florida':219,
  'Georgia':220,'Hawaii':220,'Idaho':215,'Illinois':222,'Indiana':218,
  'Iowa':216,'Kansas':218,'Kentucky':216,'Louisiana':216,'Maine':217,
  'Maryland':224,'Massachusetts':225,'Michigan':219,'Minnesota':221,
  'Mississippi':212,'Missouri':218,'Montana':213,'Nebraska':217,'Nevada':218,
  'New Hampshire':220,'New Jersey':225,'New Mexico':215,'New York':223,
  'North Carolina':221,'North Dakota':212,'Ohio':219,'Oklahoma':215,
  'Oregon':222,'Pennsylvania':222,'Rhode Island':220,'South Carolina':216,
  'South Dakota':212,'Tennessee':218,'Texas':222,'Utah':216,'Vermont':218,
  'Virginia':222,'Washington':223,'West Virginia':210,'Wisconsin':218,'Wyoming':209
};
const sel=document.getElementById('stateSelect');
Object.keys(CUTOFFS).sort().forEach(s=>{const o=document.createElement('option');o.value=s;o.textContent=s;sel.appendChild(o);});

function showCutoff(){
  const s=document.getElementById('stateSelect').value;
  const el=document.getElementById('cutoffResult');
  if(!s){el.style.display='none';return;}
  el.style.display='block';
  const c=CUTOFFS[s];
  document.getElementById('cutoffVal').textContent=c+' / 228';
  const pct=((c-48)/180)*100;
  document.getElementById('cutoffFill').style.width=pct+'%';
  let ctx='';
  if(c>=224)ctx='One of the most competitive states. You\'ll likely need RW 750+ and Math 730+ to qualify.';
  else if(c>=221)ctx='Highly competitive. Target RW 740+ and Math 720+.';
  else if(c>=218)ctx='Moderately competitive. Target RW 720+ and Math 710+.';
  else if(c>=214)ctx='Reachable with focused prep. Target RW 710+ and Math 700+.';
  else ctx='Among the lower cutoffs nationally. Target RW 700+ and Math 680+.';
  document.getElementById('cutoffContext').textContent=ctx;
}

// ============ MINI DIAGNOSTIC ============
const DIAG_QS=[
  {domain:'Algebra',color:'var(--algebra)',stem:'If <code>3(2x ‚àí 5) = 4x + 7</code>, what is the value of <code>x</code>?',
   choices:['8','9','11','22/6'],correct:2,
   explain:'Distribute: 6x ‚àí 15 = 4x + 7. Subtract 4x: 2x ‚àí 15 = 7. Add 15: 2x = 22. Divide: x = 11.'},
  {domain:'Algebra',color:'var(--algebra)',stem:'A gym charges a $50 registration fee plus $25 per month. Which equation represents the total cost <code>C</code> after <code>m</code> months?',
   choices:['C = 50m + 25','C = 25m + 50','C = 75m','C = 25(m + 50)'],correct:1,
   explain:'The fixed fee ($50) is the constant, and $25 per month is the rate. C = 25m + 50 (slope-intercept form).'},
  {domain:'Algebra',color:'var(--algebra)',stem:'The system of equations <code>2x + 3y = 12</code> and <code>4x + 6y = 24</code> has how many solutions?',
   choices:['Zero','Exactly one','Exactly two','Infinitely many'],correct:3,
   explain:'The second equation is exactly 2√ó the first (4x+6y=24 = 2(2x+3y)=2(12)). They\'re the same line ‚Üí infinitely many solutions.'},
  {domain:'Advanced Math',color:'var(--advanced)',stem:'What are the solutions to <code>x¬≤ ‚àí 5x + 6 = 0</code>?',
   choices:['x = 2 and x = 3','x = ‚àí2 and x = ‚àí3','x = 1 and x = 6','x = ‚àí1 and x = ‚àí6'],correct:0,
   explain:'Factor: (x ‚àí 2)(x ‚àí 3) = 0. So x = 2 or x = 3. Check: 2¬≤ ‚àí 5(2) + 6 = 4 ‚àí 10 + 6 = 0 ‚úì'},
  {domain:'Advanced Math',color:'var(--advanced)',stem:'If <code>f(x) = 2x¬≤ ‚àí 3</code>, what is <code>f(‚àí4)</code>?',
   choices:['29','‚àí35','5','‚àí11'],correct:0,
   explain:'f(‚àí4) = 2(‚àí4)¬≤ ‚àí 3 = 2(16) ‚àí 3 = 32 ‚àí 3 = 29. Remember: (‚àí4)¬≤ = 16 (positive!).'},
  {domain:'Advanced Math',color:'var(--advanced)',stem:'Which expression is equivalent to <code>(3x¬≤)(4x¬≥)</code>?',
   choices:['7x‚Åµ','12x‚Åµ','12x‚Å∂','7x‚Å∂'],correct:1,
   explain:'Multiply coefficients: 3 √ó 4 = 12. Add exponents (same base): x¬≤ ¬∑ x¬≥ = x‚Åµ. Answer: 12x‚Åµ.'},
  {domain:'Problem-Solving & Data',color:'var(--psda)',stem:'A shirt originally costs $40 and is marked 30% off. What is the sale price?',
   choices:['$10','$12','$28','$30'],correct:2,
   explain:'30% of $40 = 0.30 √ó 40 = $12 discount. Sale price = $40 ‚àí $12 = $28. Or: $40 √ó 0.70 = $28.'},
  {domain:'Problem-Solving & Data',color:'var(--psda)',stem:'The mean of 5 numbers is 12. If a sixth number, 30, is added, what is the new mean?',
   choices:['14','15','17','21'],correct:1,
   explain:'Sum of original 5 numbers = 5 √ó 12 = 60. New sum = 60 + 30 = 90. New mean = 90 √∑ 6 = 15.'},
  {domain:'Problem-Solving & Data',color:'var(--psda)',stem:'A researcher surveys 200 randomly selected students from a university of 10,000. The survey finds 35% prefer online classes. Which is the best conclusion?',
   choices:['Exactly 3,500 students prefer online classes','About 35% of students at this university likely prefer online classes','35% of all college students prefer online classes','The survey is invalid because it\'s too small'],correct:1,
   explain:'A random sample supports inference about the population it was drawn from (this university), not all students everywhere.'},
  {domain:'Geometry & Trig',color:'var(--geotrig)',stem:'A right triangle has legs of length 5 and 12. What is the length of the hypotenuse?',
   choices:['13','15','17','‚àö119'],correct:0,
   explain:'Pythagorean theorem: 5¬≤ + 12¬≤ = 25 + 144 = 169 = 13¬≤. This is the classic 5-12-13 triple.'},
  {domain:'Geometry & Trig',color:'var(--geotrig)',stem:'A circle has an area of 36œÄ. What is its circumference?',
   choices:['6œÄ','12œÄ','18œÄ','36œÄ'],correct:1,
   explain:'Area = œÄr¬≤ = 36œÄ ‚Üí r¬≤ = 36 ‚Üí r = 6. Circumference = 2œÄr = 2œÄ(6) = 12œÄ.'},
  {domain:'Geometry & Trig',color:'var(--geotrig)',stem:'In a right triangle, if the side opposite angle Œ∏ is 3 and the hypotenuse is 5, what is sin(Œ∏)?',
   choices:['3/5','4/5','3/4','5/3'],correct:0,
   explain:'SOH: sin(Œ∏) = Opposite / Hypotenuse = 3/5. (The adjacent side would be 4, from the 3-4-5 triple.)'}
];

let diagAnswers=new Array(DIAG_QS.length).fill(null);
let diagConf=new Array(DIAG_QS.length).fill(null);
let diagScored=false;

function renderDiag(){
  const el=document.getElementById('diagQuestions');
  el.innerHTML=DIAG_QS.map((q,i)=>{
    const answered=diagAnswers[i]!==null;
    const isCorrect=answered&&diagAnswers[i]===q.correct;
    return `<div class="diag-q ${diagScored&&answered?'answered':''}">
      <div class="diag-domain" style="background:${q.color}22;color:${q.color}">${q.domain}</div>
      <div class="diag-stem">${q.stem}</div>
      ${!diagScored?`<div style="font-size:.78rem;color:var(--muted);margin-bottom:6px">How confident are you?</div>
      <div class="diag-conf">${['Guessing','Unsure','Confident'].map((c,ci)=>
        `<div class="diag-conf-btn ${diagConf[i]===ci?'active':''}" onclick="setConf(${i},${ci})">${c}</div>`).join('')}
      </div>`:''}
      <div class="diag-choices">${q.choices.map((c,ci)=>{
        let cls='diag-choice';
        if(diagScored){
          if(ci===q.correct)cls+=' dc-correct';
          else if(diagAnswers[i]===ci)cls+=' dc-wrong';
          cls+=' dc-dis';
        }else if(diagAnswers[i]===ci){
          cls+=' dc-correct';
        }
        const letter=String.fromCharCode(65+ci);
        return `<div class="${cls}" onclick="ansDiag(${i},${ci})"><span class="letter">${letter})</span>${c}</div>`;
      }).join('')}</div>
      <div class="diag-explain ${diagScored?'show':''}">${diagScored?
        `${isCorrect?'‚úÖ Correct!':'‚ùå Incorrect.'} ${q.explain}`:''}
      </div>
    </div>`;
  }).join('');
  // Show submit button when all answered
  const allAnswered=diagAnswers.every(a=>a!==null);
  document.getElementById('diagSubmit').style.display=allAnswered&&!diagScored?'inline-block':'none';
}

function setConf(i,v){if(diagScored)return;diagConf[i]=v;renderDiag();}
function ansDiag(i,v){if(diagScored)return;diagAnswers[i]=v;renderDiag();}

function scoreDiag(){
  diagScored=true;
  renderDiag();
  // Calculate results
  let total=0;const domScores={};const domTotals={};const miscal=[];
  DIAG_QS.forEach((q,i)=>{
    const correct=diagAnswers[i]===q.correct;
    if(correct)total++;
    if(!domScores[q.domain])domScores[q.domain]=0;
    if(!domTotals[q.domain])domTotals[q.domain]=0;
    domTotals[q.domain]++;
    if(correct)domScores[q.domain]++;
    // Miscalibrated: confident but wrong, or guessing but right
    if(diagConf[i]===2&&!correct)miscal.push({q:i+1,type:'Overconfident',domain:q.domain});
    if(diagConf[i]===0&&correct)miscal.push({q:i+1,type:'Underconfident',domain:q.domain});
  });

  const colors={Algebra:'var(--algebra)','Advanced Math':'var(--advanced)','Problem-Solving & Data':'var(--psda)','Geometry & Trig':'var(--geotrig)'};
  const pct=Math.round((total/12)*100);
  let scoreColor=pct>=80?'var(--correct)':pct>=60?'var(--psda)':'var(--wrong)';

  document.getElementById('diagResults').style.display='block';
  document.getElementById('diagResults').innerHTML=`
    <div class="results fade-in">
      <div class="results-score">
        <div class="results-big" style="color:${scoreColor}">${total}/12</div>
        <div class="results-sub">${pct}% correct</div>
      </div>
      <div class="results-domains">${Object.keys(domScores).map(d=>{
        const s=domScores[d],t=domTotals[d],p=Math.round((s/t)*100);
        const c=p>=80?'var(--correct)':p>=50?'var(--psda)':'var(--wrong)';
        return `<div class="results-domain">
          <div class="results-domain-name" style="color:${colors[d]}">${d}</div>
          <div class="results-domain-score" style="color:${c}">${s}/${t}</div>
          <div class="results-domain-bar"><div class="results-domain-fill" style="width:${p}%;background:${c}"></div></div>
        </div>`;}).join('')}
      </div>
      ${miscal.length>0?`<div style="margin-top:12px">
        <div style="font-size:.82rem;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">‚ö†Ô∏è Calibration Flags</div>
        ${miscal.map(m=>`<div style="font-size:.85rem;color:#ccc;padding:4px 0">Q${m.q}: <span style="color:${m.type==='Overconfident'?'var(--wrong)':'var(--math)'}">${m.type}</span> (${m.domain})</div>`).join('')}
        <div style="font-size:.82rem;color:var(--muted);margin-top:8px;font-style:italic">Overconfident = you felt sure but got it wrong (watch for these!). Underconfident = you guessed but were right (you may know more than you think).</div>
      </div>`:''}
      <div style="margin-top:16px;font-size:.9rem;color:#ccc">
        <strong style="color:var(--ink)">Next step:</strong> Use these results alongside your full Bluebook baseline to identify your priority domains for the course.
      </div>
    </div>`;
  document.getElementById('diagResults').scrollIntoView({behavior:'smooth',block:'start'});
}
renderDiag();

// ============ ERROR CLASSIFICATION ============
const EC_QS=[
  {scenario:'A student solved 3x ‚àí 7 = 14 and got x = 3. When checking: 3(3) ‚àí 7 = 2 ‚â† 14. They made an arithmetic error dividing 21 by 3.',
   options:['Content Gap','Careless Error','Time Pressure','Misread/Trap'],correct:1,
   fb:'This is a <strong>Careless Error</strong>. The student knows the method but made a simple calculation mistake. Fix: slow down and check by substituting back.'},
  {scenario:'A student sees "what is the value of 3x + 2?" and solves for x instead. They get x = 4, choose 4, and it\'s wrong. The answer was 3(4)+2 = 14.',
   options:['Content Gap','Careless Error','Time Pressure','Misread/Trap'],correct:3,
   fb:'This is a <strong>Misread/Trap</strong>. The student solved for x but the question asked for 3x + 2. This is the #1 most common PSAT math trap. Fix: circle or underline exactly what the question asks for.'},
  {scenario:'A student can\'t remember how to find the vertex of a quadratic in standard form. They guess by plugging in x = 0.',
   options:['Content Gap','Careless Error','Time Pressure','Strategy Gap'],correct:0,
   fb:'This is a <strong>Content Gap</strong>. The student doesn\'t know the vertex formula (x = ‚àíb/2a). Fix: study quadratic forms in Module 3.'},
  {scenario:'A student runs out of time with 4 questions left. They had spent 3+ minutes on a hard question earlier that they ended up guessing on anyway.',
   options:['Content Gap','Careless Error','Time Pressure','Strategy Gap'],correct:2,
   fb:'This is a <strong>Time Pressure</strong> error caused by poor time management. Fix: use the two-pass strategy ‚Äî skip hard questions on the first pass, return with remaining time.'},
  {scenario:'A student multiplies both sides of ‚àí2x > 8 by ‚àí1 and gets x > ‚àí4. The correct answer is x < ‚àí4.',
   options:['Content Gap','Careless Error','Time Pressure','Misread/Trap'],correct:0,
   fb:'This is a <strong>Content Gap</strong>. The student doesn\'t know the rule: when dividing or multiplying by a negative, flip the inequality sign. This is a learned rule, not a careless mistake.'},
  {scenario:'A student stares at a systems problem for 45 seconds trying to set up elimination, when graphing both equations in Desmos would have given the answer in 10 seconds.',
   options:['Content Gap','Careless Error','Time Pressure','Strategy Gap'],correct:3,
   fb:'This is a <strong>Strategy Gap</strong>. The student knows the math but chose an inefficient method. Fix: develop the "Desmos or Algebra?" decision habit (Module 6).'}
];
let ecAns={};
function renderEC(){
  let correct=0,total=0;
  document.getElementById('ecBox').innerHTML=EC_QS.map((q,i)=>{
    const answered=ecAns[i]!==undefined;
    const isCorrect=ecAns[i]===q.correct;
    if(answered){total++;if(isCorrect)correct++;}
    return `<div class="ec-item">
      <div class="ec-scenario">${q.scenario}</div>
      <div class="ec-options">${q.options.map((o,oi)=>{
        let cls='ec-opt';
        if(answered){
          if(oi===q.correct)cls+=' ec-correct';
          else if(ecAns[i]===oi)cls+=' ec-wrong';
          cls+=' ec-dis';
        }
        return `<div class="${cls}" onclick="ansEC(${i},${oi})">${o}</div>`;
      }).join('')}</div>
      <div class="ec-fb ${answered?'show':''}">${answered?q.fb:''}</div>
    </div>`;
  }).join('');
  document.getElementById('ecScore').textContent=total>0?`${correct}/${total} correct`:'';
}
function ansEC(i,v){if(ecAns[i]!==undefined)return;ecAns[i]=v;renderEC();}
renderEC();

// ============ ERROR ANALYSIS WORKSHEET ============
const WS_KEY='pp_psat_m1_ws';
function loadWS(){return JSON.parse(localStorage.getItem(WS_KEY)||'[]');}
function saveWS(d){localStorage.setItem(WS_KEY,JSON.stringify(d));}
function addEntry(){
  const d=loadWS();d.push({qnum:'',domain:'',topic:'',errorType:'',shouldHave:'',desmos:''});saveWS(d);renderWS();
}
function updateEntry(idx,field,val){const d=loadWS();if(d[idx])d[idx][field]=val;saveWS(d);}
function removeEntry(idx){const d=loadWS();d.splice(idx,1);saveWS(d);renderWS();}
function renderWS(){
  const d=loadWS();
  if(d.length===0){addEntry();return;}
  document.getElementById('wsEntries').innerHTML=d.map((e,i)=>`
    <div class="ws-entry">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <div style="font-weight:700;font-size:.88rem;color:var(--math)">Question ${i+1}</div>
        <button style="background:none;border:none;color:var(--muted);cursor:pointer;font-size:.82rem" onclick="removeEntry(${i})">‚úï Remove</button>
      </div>
      <div class="ws-row">
        <div class="ws-label">Q #</div>
        <input class="ws-input" type="number" min="1" max="44" placeholder="1‚Äì44" value="${e.qnum}" onchange="updateEntry(${i},'qnum',this.value)" style="width:80px">
      </div>
      <div class="ws-row">
        <div class="ws-label">Domain</div>
        <select class="ws-select" onchange="updateEntry(${i},'domain',this.value)">
          <option value="">Select domain‚Ä¶</option>
          <option${e.domain==='Algebra'?' selected':''}>Algebra</option>
          <option${e.domain==='Advanced Math'?' selected':''}>Advanced Math</option>
          <option${e.domain==='Problem-Solving & Data'?' selected':''}>Problem-Solving & Data</option>
          <option${e.domain==='Geometry & Trig'?' selected':''}>Geometry & Trig</option>
        </select>
      </div>
      <div class="ws-row">
        <div class="ws-label">Topic</div>
        <input class="ws-input" placeholder="e.g., Quadratic vertex form" value="${e.topic||''}" onchange="updateEntry(${i},'topic',this.value)" style="width:100%">
      </div>
      <div class="ws-row">
        <div class="ws-label">Error Type</div>
        <select class="ws-select" onchange="updateEntry(${i},'errorType',this.value)">
          <option value="">Select type‚Ä¶</option>
          <option${e.errorType==='Content Gap'?' selected':''}>Content Gap</option>
          <option${e.errorType==='Careless Error'?' selected':''}>Careless Error</option>
          <option${e.errorType==='Time Pressure'?' selected':''}>Time Pressure</option>
          <option${e.errorType==='Misread/Trap'?' selected':''}>Misread/Trap</option>
          <option${e.errorType==='Strategy Gap'?' selected':''}>Strategy Gap</option>
        </select>
      </div>
      <div class="ws-row" style="grid-template-columns:1fr"><div class="ws-label">What I should have done</div></div>
      <textarea class="ws-textarea" placeholder="Write the correct approach in your own words‚Ä¶" onchange="updateEntry(${i},'shouldHave',this.value)">${e.shouldHave||''}</textarea>
      <div class="ws-row" style="margin-top:6px">
        <div class="ws-label">Desmos?</div>
        <select class="ws-select" onchange="updateEntry(${i},'desmos',this.value)">
          <option value="">Could Desmos have helped?</option>
          <option${e.desmos==='Yes'?' selected':''}>Yes</option>
          <option${e.desmos==='No'?' selected':''}>No</option>
          <option${e.desmos==='I used it but incorrectly'?' selected':''}>I used it but incorrectly</option>
        </select>
      </div>
    </div>`).join('');
}
function exportWS(){
  const d=loadWS();
  let txt='PSAT/NMSQT MATH ERROR ANALYSIS ‚Äî PantherPrep\n';
  txt+='‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n';
  const counts={},domCounts={};
  d.forEach((e,i)=>{
    txt+=`Q${e.qnum||'?'} | ${e.domain||'‚Äî'} | ${e.topic||'‚Äî'} | ${e.errorType||'‚Äî'} | Desmos: ${e.desmos||'‚Äî'}\n`;
    txt+=`  ‚Üí ${e.shouldHave||'‚Äî'}\n\n`;
    if(e.errorType)counts[e.errorType]=(counts[e.errorType]||0)+1;
    if(e.domain)domCounts[e.domain]=(domCounts[e.domain]||0)+1;
  });
  txt+='ERROR TYPE SUMMARY:\n';Object.entries(counts).forEach(([k,v])=>txt+=`  ${k}: ${v}\n`);
  txt+='\nDOMAIN SUMMARY:\n';Object.entries(domCounts).forEach(([k,v])=>txt+=`  ${k}: ${v}\n`);
  navigator.clipboard.writeText(txt).then(()=>alert('Worksheet copied to clipboard!')).catch(()=>{
    const ta=document.createElement('textarea');ta.value=txt;document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta);alert('Copied!');});
}
renderWS();

// ============ CHECKLIST ============
const CL_ITEMS=['Bluebook app installed and working','Quiet testing environment prepared','Phone silenced and out of reach','Scratch paper and pencil ready','70 uninterrupted minutes available','Water bottle nearby'];
const CL_KEY='pp_psat_m1_cl';
let clState=JSON.parse(localStorage.getItem(CL_KEY)||'[]');
if(clState.length!==CL_ITEMS.length)clState=CL_ITEMS.map(()=>false);
function renderCL(){
  const done=clState.filter(Boolean).length;
  document.getElementById('preChecklist').innerHTML=
    `<h3 style="font-family:'Cormorant Garamond',serif;font-size:1.2rem;margin-bottom:12px">‚úÖ Before Your Baseline Test</h3>`+
    CL_ITEMS.map((item,i)=>`<div class="cl-item ${clState[i]?'done':''}" onclick="toggleCL(${i})">
      <div class="cl-check">${clState[i]?'‚úì':''}</div><div>${item}</div></div>`).join('')+
    `<div class="cl-progress">${done}/${CL_ITEMS.length} complete</div>`;
}
function toggleCL(i){clState[i]=!clState[i];localStorage.setItem(CL_KEY,JSON.stringify(clState));renderCL();}
renderCL();

// ============ BASELINE SCORES ============
function updateScores(){
  const m1=parseInt(document.getElementById('m1Score').value);
  const m2=parseInt(document.getElementById('m2Score').value);
  const el=document.getElementById('scoreResult');
  if(isNaN(m1)||isNaN(m2)){el.textContent='Enter both scores to see your total and recommended pathway.';return;}
  const total=m1+m2;
  let path='',color='';
  if(total<18){path='Developing (below 400) ‚Äî Focus on Modules 2, 3, 4. Priority: linear equations, basic quadratics, Desmos basics.';color='var(--wrong)';}
  else if(total<28){path='Approaching (400‚Äì530) ‚Äî Complete all modules with extra time on your weakest domain.';color='var(--psda)';}
  else if(total<36){path='Proficient (530‚Äì650) ‚Äî Focus on Modules 3, 4, 6. Priority: quadratics, functions, Desmos power moves, strategy.';color='var(--math)';}
  else{path='Advanced (650+) ‚Äî Focus on Modules 3, 4, 6, 7. Priority: advanced functions, strategy optimization, time management.';color='var(--correct)';}
  el.innerHTML=`<div style="font-family:'JetBrains Mono',monospace;font-size:1.5rem;font-weight:700;color:${color}">${total}/44</div>
    <div style="margin-top:6px;font-size:.88rem;color:#ccc">${path}</div>`;
}
</script>
<script src="/translate.js"></script>
</body>
</html>
