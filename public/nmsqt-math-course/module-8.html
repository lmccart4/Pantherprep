<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Module 8: Practice Test, Error Analysis & Test-Day Prep ‚Äî PSAT/NMSQT Math ‚Äî PantherPrep</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=Source+Sans+3:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root{--ink:#f0f0f0;--paper:#121212;--accent:#0891b2;--accent-light:rgba(8,145,178,.12);--border:#2a2a2a;--muted:#999;--surface:#1a1a1a;--math:#60a5fa;--math-bg:rgba(96,165,250,.1);--algebra:#34d399;--algebra-bg:rgba(52,211,153,.1);--advanced:#a78bfa;--adv-bg:rgba(167,139,250,.1);--psda:#fbbf24;--psda-bg:rgba(251,191,36,.1);--geotrig:#f87171;--geotrig-bg:rgba(248,113,113,.1);--des:#2bc4a9;--des-bg:rgba(43,196,169,.1);--strat:#f97316;--strat-bg:rgba(249,115,22,.08);--correct:#22c55e;--correct-bg:rgba(34,197,94,.12);--wrong:#ef4444;--wrong-bg:rgba(239,68,68,.12);--danger:#ef4444;--danger-bg:rgba(239,68,68,.08)}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Source Sans 3',sans-serif;background:var(--paper);color:var(--ink);line-height:1.65;overflow-x:hidden}
.top-stripe{height:4px;background:linear-gradient(90deg,#0891b2 0%,#0891b2 50%,#fff 50%,#fff 100%);position:fixed;top:0;left:0;right:0;z-index:100}

.screen{display:none;opacity:0;transition:opacity .4s ease;min-height:100vh}
.screen.active{display:block;opacity:1}
.screen.fade-in{animation:fadeIn .4s ease forwards}
.screen.fade-out{animation:fadeOut .3s ease forwards}
@keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeOut{from{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-12px)}}

.screen-progress{position:fixed;top:12px;left:50%;transform:translateX(-50%);display:flex;gap:8px;z-index:101;padding:6px 14px;background:rgba(18,18,18,.85);backdrop-filter:blur(8px);border-radius:20px;border:1px solid var(--border)}
.screen-dot{width:8px;height:8px;border-radius:50%;background:var(--border);transition:all .3s;cursor:pointer}
.screen-dot.completed{background:var(--accent)}
.screen-dot.current{background:var(--accent);box-shadow:0 0 8px rgba(8,145,178,.5);transform:scale(1.25)}
.screen-dot:hover{transform:scale(1.3)}

.container{max-width:800px;margin:0 auto;padding:20px 20px 60px}

.welcome-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:40px 20px;text-align:center}
.welcome-badge{display:inline-block;background:var(--accent);color:#fff;font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:5px 14px;border-radius:16px;margin-bottom:18px}
.welcome-screen h1{font-family:'Cormorant Garamond',serif;font-size:clamp(2rem,5vw,3rem);font-weight:700;margin-bottom:8px;max-width:600px}
.welcome-sub{color:var(--muted);font-size:1.05rem;max-width:500px;margin:0 auto 32px}
.welcome-meta{display:flex;gap:24px;justify-content:center;margin-bottom:36px;font-size:.85rem;color:var(--muted)}
.preview-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;max-width:600px;width:100%;margin-bottom:40px}
.preview-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px 14px;text-align:left;transition:all .2s}
.preview-card:hover{border-color:var(--accent);transform:translateY(-2px)}
.preview-icon{font-size:1.4rem;margin-bottom:8px}
.preview-title{font-size:.82rem;font-weight:700;margin-bottom:3px}
.preview-desc{font-size:.72rem;color:var(--muted);line-height:1.4}
.start-btn{padding:14px 36px;background:var(--accent);color:#fff;border:none;border-radius:10px;font-size:1rem;font-weight:700;cursor:pointer;transition:all .2s;font-family:'Source Sans 3',sans-serif}
.start-btn:hover{filter:brightness(1.15);transform:translateY(-1px);box-shadow:0 6px 20px rgba(8,145,178,.3)}

.warmup-container{max-width:600px;margin:0 auto;padding:60px 20px}
.warmup-header{text-align:center;margin-bottom:32px}
.warmup-badge{display:inline-block;background:var(--strat);color:#000;font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:4px 12px;border-radius:12px;margin-bottom:12px}
.warmup-dots{display:flex;gap:8px;justify-content:center;margin-top:16px}
.warmup-dot{width:10px;height:10px;border-radius:50%;background:var(--border);transition:all .3s}
.warmup-dot.done-correct{background:var(--correct)}
.warmup-dot.done-wrong{background:var(--wrong)}
.warmup-dot.active{background:var(--strat);box-shadow:0 0 8px rgba(249,115,22,.4)}
.warmup-q{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:24px;margin-bottom:16px}
.warmup-q .source-tag{font-size:.7rem;color:var(--strat);font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:8px}
.warmup-q .q-text{font-size:.95rem;line-height:1.7;margin-bottom:14px}
.warmup-choices{display:flex;flex-direction:column;gap:8px}
.warmup-choice{display:flex;align-items:center;gap:10px;padding:11px 14px;background:var(--paper);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.88rem;transition:all .15s}
.warmup-choice:hover:not(.wu-dis){border-color:var(--strat);background:rgba(249,115,22,.05)}
.warmup-choice.wu-correct{border-color:var(--correct);background:var(--correct-bg)}
.warmup-choice.wu-wrong{border-color:var(--wrong);background:var(--wrong-bg)}
.warmup-choice.wu-dis{pointer-events:none;opacity:.7}
.warmup-choice.wu-correct{opacity:1}
.warmup-fb{font-size:.85rem;color:var(--muted);line-height:1.6;margin-top:12px;padding:10px;background:var(--paper);border-radius:8px;border-left:3px solid var(--correct)}
.warmup-next{padding:10px 24px;background:var(--strat);color:#000;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:.88rem;margin-top:12px;font-family:'Source Sans 3',sans-serif}
.warmup-next:hover{filter:brightness(1.1)}
.warmup-summary{text-align:center;padding:40px 20px}
.warmup-score{font-family:'JetBrains Mono',monospace;font-size:2.4rem;font-weight:700;color:var(--strat);margin:12px 0}
.warmup-continue{padding:12px 28px;background:var(--accent);color:#fff;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:.95rem;margin-top:20px;font-family:'Source Sans 3',sans-serif}
.warmup-continue:hover{filter:brightness(1.15)}

.back-link{display:inline-flex;align-items:center;gap:8px;color:var(--muted);font-size:.9rem;padding:8px 0;margin-top:8px;cursor:pointer;text-decoration:none}
.back-link:hover{color:var(--accent)}
.mod-header{padding:40px 0 30px;border-bottom:1px solid var(--border);margin-bottom:32px}
.mod-badge{display:inline-block;background:var(--accent);color:#fff;font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:5px 14px;border-radius:16px;margin-bottom:14px}
.mod-header h1{font-family:'Cormorant Garamond',serif;font-size:clamp(1.8rem,4vw,2.6rem);font-weight:700;margin-bottom:6px}
.mod-header .subtitle{color:var(--muted);font-size:1rem}
.mod-meta{display:flex;gap:20px;margin-top:14px;font-size:.82rem;color:var(--muted)}
.section{margin-bottom:36px}
.section-label{font-size:.7rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--accent);margin-bottom:6px}
.section h2{font-family:'Cormorant Garamond',serif;font-size:1.6rem;font-weight:700;margin-bottom:12px}
.section p{color:#ccc;font-size:.93rem;margin-bottom:12px;line-height:1.7}
.card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:18px 20px;margin-bottom:12px}
.card-accent{border-left:3px solid var(--accent)}
.callout{background:var(--accent-light);border:1px solid rgba(8,145,178,.3);border-radius:10px;padding:14px 18px;margin-bottom:16px;font-size:.9rem}
.callout strong{color:var(--accent)}
.callout-blue{background:var(--math-bg);border-color:rgba(96,165,250,.3)}
.callout-blue strong{color:var(--math)}
.callout-gold{background:rgba(8,145,178,.08);border-color:rgba(8,145,178,.3)}
.callout-gold strong{color:var(--accent)}
.topic{background:var(--surface);border:1px solid var(--border);border-radius:14px;margin-bottom:12px;overflow:hidden}
.topic-header{display:flex;align-items:center;gap:14px;padding:16px 20px;cursor:pointer}
.topic-badge{width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.82rem;color:#fff;flex-shrink:0}
.topic-info{flex:1}
.topic-title{font-weight:700;font-size:.95rem}
.topic-sub{font-size:.82rem;color:var(--muted);margin-top:2px}
.topic-arrow{color:var(--muted);transition:transform .2s;font-size:.9rem}
.topic.open .topic-arrow{transform:rotate(90deg)}
.topic-body{display:none;padding:0 20px 18px;font-size:.9rem;color:#ccc;line-height:1.7}
.topic.open .topic-body{display:block}
.topic-body h4{font-size:.95rem;color:var(--ink);margin:14px 0 6px;font-weight:700}
.topic-body ul{padding-left:18px;margin-bottom:10px}
.topic-body li{margin-bottom:6px}
.formula-box{background:var(--paper);border:1px solid var(--border);border-radius:10px;padding:14px 16px;margin:10px 0;font-family:'JetBrains Mono',monospace;font-size:.85rem;line-height:1.8}
.formula-box .fn{color:var(--accent);font-weight:700}
.formula-box .fl{color:var(--math);font-weight:700}
.exercise{background:var(--surface);border:2px solid var(--accent);border-radius:14px;padding:22px;margin-bottom:16px}
.exercise h3{font-family:'Cormorant Garamond',serif;font-size:1.2rem;margin-bottom:4px}
.exercise-sub{font-size:.82rem;color:var(--muted);margin-bottom:14px}
.ex-item{background:var(--paper);border:1px solid var(--border);border-radius:10px;padding:14px;margin-bottom:10px}
.ex-prompt{font-size:.92rem;line-height:1.6;margin-bottom:10px;color:#ddd}
.ex-prompt code{background:rgba(96,165,250,.1);color:var(--math);padding:1px 6px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:.85rem}
.ex-input-row{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.ex-input{padding:8px 12px;background:var(--surface);border:1px solid var(--border);border-radius:6px;color:var(--ink);font-family:'JetBrains Mono',monospace;font-size:1rem;width:100px;text-align:center}
.ex-input:focus{border-color:var(--accent);outline:none}
.ex-btn{padding:8px 16px;background:var(--accent);color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:.82rem;font-weight:600}
.ex-btn:hover{filter:brightness(1.15)}
.ex-fb{font-size:.82rem;padding:8px 10px;border-radius:6px;margin-top:8px;display:none;line-height:1.5}
.ex-fb.show{display:block}
.ex-fb.correct{background:var(--correct-bg);color:var(--correct)}
.ex-fb.wrong{background:var(--wrong-bg);color:var(--wrong)}
.tier{display:inline-block;padding:2px 8px;border-radius:4px;font-size:.68rem;font-weight:700;letter-spacing:1px;text-transform:uppercase}
.tier-1{background:rgba(52,211,153,.15);color:var(--algebra)}
.tier-2{background:var(--math-bg);color:var(--math)}
.tier-3{background:rgba(167,139,250,.15);color:var(--advanced)}
.classify-opts{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:4px}
.classify-opt{padding:6px 14px;background:var(--surface);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.82rem;transition:all .15s}
.classify-opt:hover:not(.cl-dis){border-color:var(--accent);background:rgba(8,145,178,.08)}
.classify-opt.cl-correct{border-color:var(--correct);background:var(--correct-bg);color:var(--correct);opacity:1}
.classify-opt.cl-wrong{border-color:var(--wrong);background:var(--wrong-bg);color:var(--wrong)}
.classify-opt.cl-dis{pointer-events:none;opacity:.6}
.classify-opt.cl-correct{opacity:1}
.mc-choices{display:flex;flex-direction:column;gap:6px}
.mc-choice{display:flex;align-items:center;gap:10px;padding:10px 14px;background:var(--paper);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.88rem;transition:all .15s}
.mc-choice:hover:not(.mc-dis){border-color:var(--accent);background:rgba(8,145,178,.05)}
.mc-letter{font-weight:700;color:var(--muted);min-width:20px}
.mc-choice.mc-correct{border-color:var(--correct);background:var(--correct-bg);opacity:1}
.mc-choice.mc-wrong{border-color:var(--wrong);background:var(--wrong-bg)}
.mc-choice.mc-dis{pointer-events:none;opacity:.7}
.mc-choice.mc-correct{opacity:1}
.mc-choice.mc-correct .mc-letter{color:var(--correct)}
.mc-choice.mc-wrong .mc-letter{color:var(--wrong)}
.mc-choice.mc-selected{border-color:var(--accent);background:rgba(8,145,178,.15)}
.mc-fb{font-size:.85rem;color:var(--muted);line-height:1.6;margin-top:10px;padding:10px;background:var(--paper);border-radius:8px;display:none;border-left:3px solid var(--correct)}
.mc-fb.show{display:block}
.score-bar{display:flex;align-items:center;gap:10px;margin-top:14px;padding-top:10px;border-top:1px solid var(--border)}
.score-bar-label{font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted)}
.score-bar-track{flex:1;height:6px;border-radius:3px;background:var(--border);overflow:hidden}
.score-bar-fill{height:100%;border-radius:3px;background:var(--correct);transition:width .4s ease}
.score-bar-val{font-family:'JetBrains Mono',monospace;font-size:.85rem;font-weight:700;color:var(--correct);min-width:36px;text-align:right}
/* Two-way table */
.tw-table{width:100%;border-collapse:collapse;font-size:.85rem;margin:12px 0}
.tw-table th,.tw-table td{padding:8px 10px;border:1px solid var(--border);text-align:center}
.tw-table th{background:var(--surface);font-weight:700;color:var(--accent);font-size:.78rem;text-transform:uppercase;letter-spacing:.5px}
.tw-table td{color:#ccc}
.fm-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:8px;margin:12px 0}
.fm-card{background:var(--paper);border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center}
.fm-name{font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:4px}
.fm-eq{font-family:'JetBrains Mono',monospace;font-size:.95rem;font-weight:700;color:var(--math)}
.tri-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:10px;margin:12px 0}
.tri-card{background:var(--paper);border:2px solid var(--accent);border-radius:12px;padding:16px;text-align:center}
.tri-name{font-family:'Cormorant Garamond',serif;font-size:1.1rem;font-weight:700;margin-bottom:4px}
.tri-ratio{font-family:'JetBrains Mono',monospace;font-size:1.2rem;font-weight:700;color:var(--accent);margin-bottom:6px}
.tri-sides{font-size:.82rem;color:var(--muted);line-height:1.5}
.triples-row{display:flex;flex-wrap:wrap;gap:8px;margin:8px 0}
.triple{background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:6px 14px;font-family:'JetBrains Mono',monospace;font-size:.88rem;font-weight:700;color:var(--math)}
.skill-table{width:100%;border-collapse:collapse;font-size:.85rem;margin:12px 0}
.skill-table th,.skill-table td{padding:10px 12px;border:1px solid var(--border);text-align:left}
.skill-table th{background:var(--surface);font-weight:700;color:var(--accent);font-size:.78rem;text-transform:uppercase;letter-spacing:.5px}
.skill-table td{color:#ccc;vertical-align:top}
.skill-num{display:inline-flex;width:22px;height:22px;border-radius:50%;background:var(--accent);color:#fff;font-size:.72rem;font-weight:700;align-items:center;justify-content:center;margin-right:8px}
.sc-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:8px;margin:12px 0}
.sc-card{background:var(--paper);border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center}
.sc-key{font-family:'JetBrains Mono',monospace;font-size:1.2rem;font-weight:700;color:var(--accent);margin-bottom:4px}
.sc-desc{font-size:.78rem;color:var(--muted)}
.do-dont{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:12px 0}
.do-card,.dont-card{background:var(--surface);border-radius:12px;padding:16px;font-size:.88rem}
.do-card{border:2px solid var(--correct)}.dont-card{border:2px solid var(--wrong)}
.do-card h4{color:var(--correct);margin-bottom:8px}.dont-card h4{color:var(--wrong);margin-bottom:8px}
.do-card li,.dont-card li{margin-bottom:4px;color:#ccc}
.step-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px 20px;margin-bottom:10px}
.step-num{display:inline-flex;width:28px;height:28px;border-radius:50%;background:var(--accent);color:#fff;font-size:.85rem;font-weight:700;align-items:center;justify-content:center;margin-right:10px;flex-shrink:0}
.step-header{display:flex;align-items:center;margin-bottom:8px;font-weight:700;font-size:.95rem}
.step-body{font-size:.88rem;color:#ccc;line-height:1.6;padding-left:38px}
.step-body code{background:rgba(96,165,250,.1);color:var(--math);padding:1px 6px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:.85rem}
.dt-flow{display:flex;flex-direction:column;gap:8px;margin:12px 0}
.dt-step{display:flex;align-items:stretch;gap:0}
.dt-num{width:38px;min-height:38px;border-radius:10px 0 0 10px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.85rem;color:#fff;flex-shrink:0}
.dt-body{flex:1;padding:10px 14px;border-radius:0 10px 10px 0;font-size:.88rem;line-height:1.5;border:1px solid var(--border);border-left:none}
.dt-yes{color:var(--correct);font-weight:700}
.dt-no{color:var(--muted);font-weight:600}
.worked{background:var(--surface);border:1px solid var(--border);border-left:3px solid var(--strat);border-radius:10px;padding:16px;margin:12px 0;font-size:.9rem}
.worked-label{font-size:.7rem;font-weight:700;text-transform:uppercase;letter-spacing:1.5px;color:var(--strat);margin-bottom:8px}
.gi-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:8px;margin:12px 0}
.gi-card{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:12px;display:flex;gap:10px;align-items:flex-start}
.gi-icon{font-size:1.2rem;flex-shrink:0}
.gi-rule{font-size:.85rem;color:#ccc;line-height:1.5}
.trap-card{background:var(--paper);border:1px solid var(--border);border-left:3px solid var(--wrong);border-radius:10px;padding:14px;margin-bottom:10px}
.trap-title{font-weight:700;color:var(--wrong);font-size:.9rem;margin-bottom:4px}
.trap-body{font-size:.85rem;color:#ccc;line-height:1.5}
.trap-fix{font-size:.82rem;color:var(--correct);margin-top:6px;font-weight:600}
.test-controls{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin:12px 0;padding:14px;background:var(--surface);border:2px solid var(--accent);border-radius:14px}
.test-timer{font-family:'JetBrains Mono',monospace;font-size:1.4rem;font-weight:700;color:var(--accent)}
.test-timer.warn{color:var(--wrong)}
.test-progress{font-size:.85rem;color:var(--muted)}
.test-btn{padding:8px 18px;border-radius:8px;border:none;font-weight:700;cursor:pointer;font-size:.85rem;transition:.2s}
.test-btn-start{background:var(--accent);color:#fff}
.test-btn-start:hover{opacity:.85}
.test-btn-flag{background:var(--surface);color:var(--strat);border:1px solid var(--strat)}
.test-btn-submit{background:var(--correct);color:#fff}
.test-q{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px;margin-bottom:10px;display:none}
.test-q.active{display:block}
.test-q.flagged{border-color:var(--strat)}
.test-nav{display:grid;grid-template-columns:repeat(auto-fill,minmax(36px,1fr));gap:4px;margin:12px 0}
.test-nav-btn{width:36px;height:36px;border-radius:8px;border:1px solid var(--border);background:var(--paper);color:var(--muted);font-size:.78rem;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.2s}
.test-nav-btn.current{border-color:var(--accent);color:var(--accent);background:rgba(8,145,178,.1)}
.test-nav-btn.answered{background:var(--accent);color:#fff;border-color:var(--accent)}
.test-nav-btn.flagged{border-color:var(--strat);background:rgba(249,115,22,.15);color:var(--strat)}
.test-nav-btn.correct-r{background:var(--correct);color:#fff;border-color:var(--correct)}
.test-nav-btn.wrong-r{background:var(--wrong);color:#fff;border-color:var(--wrong)}
.domain-bar{display:flex;height:24px;border-radius:6px;overflow:hidden;margin:6px 0}
.domain-seg{display:flex;align-items:center;justify-content:center;font-size:.65rem;font-weight:700;color:#fff;min-width:20px}
.report-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:10px;margin:12px 0}
.report-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px;text-align:center}
.report-big{font-family:'JetBrains Mono',monospace;font-size:2rem;font-weight:700}
.report-label{font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-top:4px}
.ec-row{display:flex;gap:8px;margin-bottom:6px;flex-wrap:wrap}
.ec-btn{padding:5px 12px;border-radius:6px;border:1px solid var(--border);background:var(--paper);color:var(--muted);font-size:.78rem;cursor:pointer;transition:.2s}
.ec-btn:hover{border-color:var(--accent)}
.ec-btn.sel{background:var(--accent);color:#fff;border-color:var(--accent)}
.growth-row{display:grid;grid-template-columns:1fr auto 1fr;gap:16px;align-items:center;text-align:center;margin:12px 0}
.growth-input{width:80px;padding:8px;background:var(--paper);border:1px solid var(--border);border-radius:8px;color:var(--ink);font-family:'JetBrains Mono',monospace;font-size:1.4rem;text-align:center;font-weight:700}
.checklist-item{display:flex;align-items:flex-start;gap:10px;padding:8px 0;border-bottom:1px solid rgba(255,255,255,.05);font-size:.9rem;color:#ccc}
.checklist-check{flex-shrink:0;width:20px;height:20px;border:2px solid var(--border);border-radius:4px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:.7rem;transition:.2s}
.checklist-check.done{background:var(--correct);border-color:var(--correct);color:#fff}
.formula-ref{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:8px;margin:12px 0}
.formula-ref .fm-card{font-size:.82rem}
.proj-inputs{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:16px}
.proj-field label{display:block;font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--muted);margin-bottom:4px}
.proj-field input,.proj-field select{width:100%;padding:8px;background:var(--paper);border:1px solid var(--border);border-radius:8px;color:var(--ink);font-family:'JetBrains Mono',monospace;font-size:1rem;text-align:center}
.proj-field input:focus,.proj-field select:focus{border-color:var(--accent);outline:none}
.proj-results{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.proj-result{text-align:center;padding:12px;background:var(--surface);border-radius:10px}
.proj-val{font-family:'JetBrains Mono',monospace;font-size:1.6rem;font-weight:700}
.proj-label{font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--muted);margin-top:4px}
.ec-box{background:var(--surface);border:2px solid var(--math);border-radius:14px;padding:22px;margin-bottom:16px}
.ec-item{background:var(--paper);border-radius:10px;padding:14px;margin-bottom:10px}
.ec-scenario{font-size:.92rem;line-height:1.6;margin-bottom:10px;color:#ddd}
.ec-options{display:flex;flex-wrap:wrap;gap:6px}
.ec-opt{padding:6px 14px;background:var(--surface);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.82rem;transition:.15s}
.ec-opt:hover:not(.ec-dis){border-color:var(--accent)}
.ec-opt.ec-correct{border-color:var(--correct);background:rgba(34,197,94,.1);color:var(--correct)}
.ec-opt.ec-wrong{border-color:var(--wrong);background:rgba(248,113,113,.1);color:var(--wrong)}
.ec-opt.ec-dis{pointer-events:none;opacity:.6}
.ec-fb{margin-top:8px;font-size:.82rem;color:var(--muted);display:none;line-height:1.4}
.ec-fb.show{display:block}

.complete-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:40px 20px;text-align:center}
.complete-icon{font-size:4rem;margin-bottom:16px;animation:celebrateBounce .6s ease}
@keyframes celebrateBounce{0%{transform:scale(0)}50%{transform:scale(1.2)}100%{transform:scale(1)}}
.complete-screen h1{font-family:'Cormorant Garamond',serif;font-size:clamp(1.8rem,4vw,2.4rem);margin-bottom:8px}
.complete-sub{color:var(--muted);font-size:1rem;margin-bottom:28px}
.takeaway-list{text-align:left;max-width:500px;width:100%;margin-bottom:32px}
.takeaway-item{display:flex;gap:10px;align-items:flex-start;padding:8px 0;font-size:.88rem;color:#ccc}
.takeaway-check{color:var(--correct);flex-shrink:0;font-weight:700}
.nav-cards{display:grid;grid-template-columns:1fr 1fr;gap:12px;max-width:500px;width:100%}
.nav-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:18px;text-align:center;cursor:pointer;transition:all .2s;text-decoration:none;color:var(--ink)}
.nav-card:hover{border-color:var(--accent);transform:translateY(-2px)}
.nav-card-label{font-size:.7rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:4px}
.nav-card-title{font-weight:700;font-size:.95rem}

@media(max-width:600px){.mod-meta{flex-wrap:wrap;gap:10px}.classify-opts{gap:4px}.do-dont{grid-template-columns:1fr}.sc-grid{grid-template-columns:repeat(2,1fr)}.test-controls{flex-direction:column;align-items:stretch}.growth-row{grid-template-columns:1fr}.report-grid{grid-template-columns:1fr 1fr}.proj-inputs,.proj-results{grid-template-columns:1fr}.preview-grid{grid-template-columns:1fr 1fr}.welcome-meta{flex-wrap:wrap;gap:12px}.nav-cards{grid-template-columns:1fr}}
</style></head>
<body>
<div class="top-stripe"></div>
<div class="screen-progress" id="screenProgress"></div>

<!-- SCREEN 1: WELCOME -->
<div class="screen active fade-in" id="screen-welcome">
  <div class="welcome-screen">
    <div class="welcome-badge">Module 8</div>
    <h1>Practice Test, Error Analysis & Test-Day Prep</h1>
    <p class="welcome-sub">Take a full 44-question practice test under timed conditions, analyze your mistakes, and project your score.</p>
    <div class="welcome-meta"><span>‚è± ~90 min (test + analysis)</span><span>üìã 44 questions + tools</span><span>üéØ Capstone</span></div>
    <div class="preview-grid">
      <div class="preview-card"><div class="preview-icon">üîÑ</div><div class="preview-title">Retrieval Warm-Up</div><div class="preview-desc">5 questions from Module 7 to activate prior knowledge</div></div>
      <div class="preview-card"><div class="preview-icon">üìù</div><div class="preview-title">44Q Practice Test</div><div class="preview-desc">Full-length timed practice with two modules</div></div>
      <div class="preview-card"><div class="preview-icon">üìä</div><div class="preview-title">Score Projection</div><div class="preview-desc">Estimate scaled scores and Selection Index</div></div>
      <div class="preview-card"><div class="preview-icon">üìà</div><div class="preview-title">Growth Tracker</div><div class="preview-desc">Compare your progress from diagnostic to now</div></div>
      <div class="preview-card"><div class="preview-icon">üîç</div><div class="preview-title">Error Analysis</div><div class="preview-desc">Classify mistakes and find your weak spots</div></div>
      <div class="preview-card"><div class="preview-icon">‚úÖ</div><div class="preview-title">Test-Day Checklist</div><div class="preview-desc">Everything you need the night before and morning of</div></div>
    </div>
    <button class="start-btn" onclick="goScreen(1)">Start Learning ‚Üí</button>
  </div>
</div>

<!-- SCREEN 2: RETRIEVAL WARM-UP -->
<div class="screen" id="screen-warmup">
  <div class="warmup-container">
    <div class="warmup-header">
      <div class="warmup-badge">Retrieval Warm-Up</div>
      <h2 style="font-family:'Cormorant Garamond',serif;font-size:1.6rem">Module 7 Review</h2>
      <p style="color:var(--muted);font-size:.9rem;margin-top:4px">Quick recall from what you learned last time.</p>
      <div class="warmup-dots" id="warmupDots"></div>
    </div>
    <div id="warmupContent"></div>
  </div>
</div>

<!-- SCREEN 3: LESSON CONTENT -->
<div class="screen" id="screen-lesson">
<div class="container">
<a class="back-link" href="index.html">‚Üê Back to PSAT/NMSQT Math Course</a>
<div class="mod-header">
  <div class="mod-badge" style="background:var(--accent)">Module 8</div>
  <h1>Practice Test, Error Analysis & Test-Day Prep</h1>
  <p class="subtitle">Take a full 44-question practice test under timed conditions, analyze your mistakes, and project your score.</p>
  <div class="mod-meta"><span>‚è± ~90 min (test + analysis)</span><span>üìã 44 questions + tools</span><span>üéØ Capstone</span></div>
</div>

<div class="callout"><strong>How to use this module:</strong> Take the practice test under timed conditions (35 min per module). Use Desmos at <a href="https://www.desmos.com/calculator" target="_blank" style="color:var(--accent)">desmos.com/calculator</a> in another tab to simulate the real test. Then score, analyze errors, and build your plan.</div>

<!-- PRE-TEST CHECKLIST -->
<div class="section">
  <div class="section-label">Before the Test</div>
  <h2>Pre-Test Checklist</h2>
  <div id="preChecklist"></div>
</div>

<!-- PRACTICE TEST -->
<div class="section">
  <div class="section-label">Practice Test</div>
  <h2>PSAT/NMSQT Math Practice ‚Äî 44 Questions</h2>
  <p>Module 1: Questions 1‚Äì22 (35 minutes) | Module 2: Questions 23‚Äì44 (35 minutes)</p>
</div>

<div class="test-controls" id="testControls">
  <div class="test-timer" id="timer">35:00</div>
  <div class="test-progress" id="testProg">Question 1 of 22 ‚Äî Module 1</div>
  <button class="test-btn test-btn-start" id="startBtn" onclick="startTest()">Start Module 1</button>
  <button class="test-btn test-btn-flag" id="flagBtn" onclick="flagQ()" style="display:none">‚öë Flag</button>
  <button class="test-btn test-btn-submit" id="submitBtn" onclick="submitModule()" style="display:none">Submit Module</button>
</div>

<div class="test-nav" id="testNav"></div>
<div id="testArea"></div>

<!-- SCORING -->
<div class="section" id="scoringSection" style="display:none">
  <div class="section-label">Results</div>
  <h2>Your Score Report</h2>
  <div class="report-grid" id="scoreGrid"></div>
  <h3 style="margin-top:16px">Domain Breakdown</h3>
  <div id="domainBreakdown"></div>
  <h3 style="margin-top:16px">Question-by-Question Review</h3>
  <p style="font-size:.85rem;color:var(--muted)">Click any question to see the explanation. Green = correct, Red = incorrect.</p>
  <div class="test-nav" id="reviewNav"></div>
  <div id="reviewArea"></div>
</div>

<!-- ERROR ANALYSIS -->
<div class="section" id="errorSection" style="display:none">
  <div class="section-label">Error Analysis</div>
  <h2>Classify Your Mistakes</h2>
  <p>For each question you missed, classify the error type. This reveals WHERE to focus study time.</p>
  <div id="errorAnalysis"></div>
  <div id="errorSummary" style="margin-top:16px"></div>
</div>

<!-- ERROR CLASSIFICATION EXERCISE -->
<div class="section">
  <div class="section-label">Interactive Exercise</div>
  <h2>Error Classification Practice</h2>
  <p>Practice classifying these common error scenarios before analyzing your own test.</p>
  <div class="ec-box" id="ecBox"></div>
  <div id="ecScore" style="text-align:center;padding:10px 0;font-size:.88rem;color:var(--muted)"></div>
</div>

<!-- SCORE PROJECTOR -->
<div class="section" id="projSection">
  <div class="section-label">Score Projector</div>
  <h2>PSAT Score & National Merit Estimator</h2>
  <p style="font-size:.85rem;color:var(--muted)">Enter raw scores to see estimated scaled scores and Selection Index. These are approximations ‚Äî actual conversions vary by test form.</p>
  <div style="background:var(--surface);border:2px solid var(--accent);border-radius:14px;padding:22px">
    <div class="proj-inputs">
      <div class="proj-field"><label>Math Raw Score</label><input type="number" id="projMathRaw" min="0" max="44" placeholder="/44" oninput="calcProj()"></div>
      <div class="proj-field"><label>RW Raw Score (optional)</label><input type="number" id="projRWRaw" min="0" max="54" placeholder="/54" oninput="calcProj()"></div>
      <div class="proj-field"><label>Module 2 Type</label>
        <select id="projM2" onchange="calcProj()"><option value="">Select‚Ä¶</option><option value="hard">Harder</option><option value="easy">Easier</option></select>
      </div>
    </div>
    <div class="proj-results" id="projResults">
      <div class="proj-result"><div class="proj-val" style="color:var(--muted)">‚Äî</div><div class="proj-label">Math Score (160‚Äì760)</div></div>
      <div class="proj-result"><div class="proj-val" style="color:var(--muted)">‚Äî</div><div class="proj-label">RW Score (160‚Äì760)</div></div>
      <div class="proj-result"><div class="proj-val" style="color:var(--muted)">‚Äî</div><div class="proj-label">Selection Index (48‚Äì228)</div></div>
    </div>
    <div id="projInsight" style="margin-top:12px;font-size:.85rem;color:var(--muted);text-align:center"></div>
  </div>
</div>

<!-- GROWTH -->
<div class="section" id="growthSection" style="display:none">
  <div class="section-label">Progress</div>
  <h2>Diagnostic ‚Üí Practice Test Comparison</h2>
  <div class="card" style="border:2px solid var(--correct)">
    <div class="growth-row">
      <div>
        <div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:6px">Module 1 Baseline</div>
        <input type="number" class="growth-input" id="baseScore" placeholder="‚Äî" min="0" max="44" oninput="updateGrowth()">
        <div style="font-size:.78rem;color:var(--muted);margin-top:4px">out of 44</div>
      </div>
      <div style="font-size:2rem;color:var(--muted)">‚Üí</div>
      <div>
        <div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:6px">Practice Test Score</div>
        <div class="growth-input" id="practScoreDisplay" style="display:inline-block">‚Äî</div>
        <div style="font-size:.78rem;color:var(--muted);margin-top:4px">out of 44</div>
      </div>
    </div>
    <div id="growthResult" style="text-align:center;margin-top:14px;font-size:.9rem;color:var(--muted)">Enter your diagnostic score to see growth.</div>
  </div>
</div>

<!-- NEXT STEPS -->
<div class="section" id="nextSection" style="display:none">
  <div class="section-label">Next Steps</div>
  <h2>Priority Review Areas</h2>
  <div id="nextSteps"></div>
</div>

<!-- FORMULA REFERENCE -->
<div class="section">
  <div class="section-label">Reference</div>
  <h2>Must-Memorize Formula Card</h2>
  <p style="font-size:.85rem;color:var(--muted)">These are on the reference sheet. Knowing them cold saves 30+ seconds per question.</p>
</div>
<div class="formula-ref">
  <div class="fm-card"><div class="fm-name">Slope</div><div class="fm-eq">m = (y‚ÇÇ‚àíy‚ÇÅ)/(x‚ÇÇ‚àíx‚ÇÅ)</div></div>
  <div class="fm-card"><div class="fm-name">Slope-Intercept</div><div class="fm-eq">y = mx + b</div></div>
  <div class="fm-card"><div class="fm-name">Quadratic Formula</div><div class="fm-eq">x = (‚àíb¬±‚àö(b¬≤‚àí4ac))/2a</div></div>
  <div class="fm-card"><div class="fm-name">Discriminant</div><div class="fm-eq">b¬≤‚àí4ac (>0: 2, =0: 1, <0: 0)</div></div>
  <div class="fm-card"><div class="fm-name">Vertex</div><div class="fm-eq">x = ‚àíb/2a</div></div>
  <div class="fm-card"><div class="fm-name">Pythagorean</div><div class="fm-eq">a¬≤ + b¬≤ = c¬≤</div></div>
  <div class="fm-card"><div class="fm-name">30-60-90</div><div class="fm-eq">1 : ‚àö3 : 2</div></div>
  <div class="fm-card"><div class="fm-name">45-45-90</div><div class="fm-eq">1 : 1 : ‚àö2</div></div>
  <div class="fm-card"><div class="fm-name">SOH-CAH-TOA</div><div class="fm-eq">sin=O/H cos=A/H tan=O/A</div></div>
  <div class="fm-card"><div class="fm-name">Circle Eq</div><div class="fm-eq">(x‚àíh)¬≤+(y‚àík)¬≤=r¬≤</div></div>
  <div class="fm-card"><div class="fm-name">Area Triangle</div><div class="fm-eq">A = ¬Ωbh</div></div>
  <div class="fm-card"><div class="fm-name">Area Circle</div><div class="fm-eq">A = œÄr¬≤</div></div>
  <div class="fm-card"><div class="fm-name">Vol Cylinder</div><div class="fm-eq">V = œÄr¬≤h</div></div>
  <div class="fm-card"><div class="fm-name">Vol Cone</div><div class="fm-eq">V = ‚ÖìœÄr¬≤h</div></div>
  <div class="fm-card"><div class="fm-name">Vol Sphere</div><div class="fm-eq">V = ‚Å¥‚ÅÑ‚ÇÉœÄr¬≥</div></div>
  <div class="fm-card"><div class="fm-name">Arc Length</div><div class="fm-eq">(Œ∏/360) √ó 2œÄr</div></div>
</div>

<!-- TEST-DAY CHECKLIST -->
<div class="section">
  <div class="section-label">Test Day</div>
  <h2>PSAT/NMSQT Test-Day Checklist</h2>
  <div id="testDayChecklist"></div>
</div>

<div class="section" style="text-align:center;padding:40px 0">
  <button class="start-btn" onclick="goScreen(3)" style="background:var(--accent);color:#fff">Complete the Course ‚Üí</button>
</div>

</div>
</div>

<!-- SCREEN 4: COMPLETE -->
<div class="screen" id="screen-complete">
  <div class="complete-screen">
    <div class="complete-icon">üéâ</div>
    <h1>Course Complete! üéì</h1>
    <p class="complete-sub">You've completed the full PSAT/NMSQT Math course. Trust your preparation. Execute your strategies.</p>
    <div class="takeaway-list">
      <div style="font-weight:700;margin-bottom:12px;font-size:.85rem;color:var(--accent);text-transform:uppercase;letter-spacing:1px">Key Takeaways</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> Error analysis shows exactly where to focus your remaining study time</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> For National Merit, every Selection Index point matters ‚Äî maximize both Math and RW</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> Use the two-pass system on every module ‚Äî accuracy in Module 1 determines your ceiling</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> Desmos is your competitive advantage ‚Äî use aggressively for systems, quadratics, and verification</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> No penalty for wrong answers ‚Äî answer every single question, never leave blanks</div>
      <div class="takeaway-item"><span class="takeaway-check">‚úì</span> Trust your preparation, execute your strategies, and stay confident üêæ</div>
    </div>
    <div id="completePracticeStats"></div>
    <div class="nav-cards">
      <a class="nav-card" href="module-7.html"><div class="nav-card-label">‚Üê Previous</div><div class="nav-card-title">Module 7: Strategy</div></a>
      <a class="nav-card" href="index.html" style="border-color:var(--accent)"><div class="nav-card-label">Next ‚Üí</div><div class="nav-card-title">Course Home</div></a>
    </div>
  </div>
</div>

<script>
// SCREEN NAVIGATION
var SCREENS=['screen-welcome','screen-warmup','screen-lesson','screen-complete'];
var currentScreen=0;
function goScreen(idx){
  if(idx<0||idx>=SCREENS.length)return;
  var cur=document.getElementById(SCREENS[currentScreen]),nxt=document.getElementById(SCREENS[idx]);
  cur.classList.remove('fade-in');cur.classList.add('fade-out');
  setTimeout(function(){cur.classList.remove('active','fade-out');nxt.classList.add('active','fade-in');currentScreen=idx;updateProgressDots();window.scrollTo(0,0);},300);
}
function updateProgressDots(){
  var labels=['Welcome','Warm-Up','Lesson','Complete'];
  document.getElementById('screenProgress').innerHTML=SCREENS.map(function(s,i){var cls='screen-dot';if(i<currentScreen)cls+=' completed';if(i===currentScreen)cls+=' current';return '<div class="'+cls+'" onclick="'+(i<=currentScreen?'goScreen('+i+')':'')+'" title="'+labels[i]+'"></div>';}).join('');
}
updateProgressDots();

// WARM-UP (Module 7 ‚Äî Strategy content)
var WARMUP_QS=[
  {source:'Module 7 ‚Äî Decision Tree',q:'According to the decision tree, what\'s the FIRST question to ask about any PSAT math problem?',
   ch:['"Is this algebra or geometry?"','"Can I do this in Desmos?"','"Should I plug in numbers?"','"How much time do I have left?"'],c:1,
   fb:'The decision tree starts with "Can I do this in Desmos?" If yes, go straight to graphing. Desmos is your fastest path on most problems.'},
  {source:'Module 7 ‚Äî Plug In Numbers',q:'Variables appear in ALL four answer choices. The fastest strategy is:',
   ch:['Solve algebraically','Plug In Numbers (PIYON)','Graph it in Desmos','Estimate and eliminate'],c:1,
   fb:'Variables in all choices = classic Plug In signal. Pick a number, substitute into the problem AND each answer choice. One will match.'},
  {source:'Module 7 ‚Äî Two-Pass System',q:'You have 35 minutes for 22 questions. How much time should you spend on hard questions during your first pass?',
   ch:['About 2 minutes each','About 3 minutes each','Skip them ‚Äî come back on second pass','As long as needed'],c:2,
   fb:'Two-pass system: First pass for easy/medium questions (build your score). Skip and flag hard questions. Come back on the second pass with remaining time.'},
  {source:'Module 7 ‚Äî Grid-In Rules',q:'What format does the grid-in accept for the fraction 3/7?',
   ch:['Only 0.4286','3/7 (fractions accepted as-is)','Only .428','Must convert to percent'],c:1,
   fb:'The digital SAT/PSAT accepts fractions directly in student-produced response questions. No need to convert to decimals.'},
  {source:'Module 7 ‚Äî Common Traps',q:'You\'re confident you got a question right, but the answer seems "too easy." What should you check?',
   ch:['Move on ‚Äî trust your instincts','Check your arithmetic twice','Re-read what the question is actually asking for','Try a different method'],c:2,
   fb:'The #1 trap on the PSAT: solving for x when they asked for 2x+1, or finding the slope when they wanted the y-intercept. Always re-read the question.'}
];
var warmupIdx=0,warmupAnswers=[],warmupAnswered=false;
function renderWarmup(){
  document.getElementById('warmupDots').innerHTML=WARMUP_QS.map(function(_,i){var cls='warmup-dot';if(i<warmupIdx)cls+=warmupAnswers[i]?' done-correct':' done-wrong';if(i===warmupIdx&&warmupIdx<WARMUP_QS.length)cls+=' active';return '<div class="'+cls+'"></div>';}).join('');
  var cont=document.getElementById('warmupContent');
  if(warmupIdx>=WARMUP_QS.length){var cor=warmupAnswers.filter(Boolean).length;cont.innerHTML='<div class="warmup-summary"><div class="warmup-badge">Warm-Up Complete</div><div class="warmup-score">'+cor+' / '+WARMUP_QS.length+'</div><p style="color:var(--muted);font-size:.9rem;margin-bottom:8px">'+(cor===5?'Perfect recall! Module 7 strategy knowledge is locked in.':cor>=3?'Good recall! A couple of strategy concepts to revisit.':'Some gaps from Module 7 ‚Äî consider a quick review.')+'</p><button class="warmup-continue" onclick="goScreen(2)">Continue to Lesson ‚Üí</button></div>';return;}
  var q=WARMUP_QS[warmupIdx];warmupAnswered=false;
  cont.innerHTML='<div class="warmup-q"><div class="source-tag">From '+q.source+'</div><div class="q-text">'+q.q+'</div><div class="warmup-choices" id="warmupChoices">'+q.ch.map(function(ch,ci){return '<div class="warmup-choice" onclick="answerWarmup('+ci+')">'+ch+'</div>';}).join('')+'</div><div id="warmupFb" style="display:none"></div></div>';
}
function answerWarmup(ci){
  if(warmupAnswered)return;warmupAnswered=true;
  var q=WARMUP_QS[warmupIdx],correct=ci===q.c;warmupAnswers.push(correct);
  document.querySelectorAll('.warmup-choice').forEach(function(ch,i){ch.classList.add('wu-dis');if(i===q.c)ch.classList.add('wu-correct');else if(i===ci&&!correct)ch.classList.add('wu-wrong');});
  var fb=document.getElementById('warmupFb');fb.style.display='block';
  fb.innerHTML='<div class="warmup-fb">'+(correct?'‚úì ':'‚úó ')+q.fb+'</div><button class="warmup-next" onclick="warmupIdx++;renderWarmup()">'+(warmupIdx<WARMUP_QS.length-1?'Next Question ‚Üí':'See Results ‚Üí')+'</button>';
  document.getElementById('warmupDots').innerHTML=WARMUP_QS.map(function(_,i){var cls='warmup-dot';if(i<warmupAnswers.length)cls+=warmupAnswers[i]?' done-correct':' done-wrong';else if(i===warmupIdx+1)cls+=' active';return '<div class="'+cls+'"></div>';}).join('');
}
renderWarmup();

// ======== 44 PSAT/NMSQT PRACTICE QUESTIONS ========
// d: A=Algebra, AM=AdvMath, P=PSDA, G=Geometry/Trig
var Q=[
// MODULE 1 (1-22)
{n:1,d:'A',q:'If <code>3(2x ‚àí 4) = 18</code>, what is x?',ch:['3','4','5','6'],c:2,fb:'6x‚àí12=18. 6x=30. x=5.'},
{n:2,d:'P',q:'The mean of 5 numbers is 24. If four are 20, 22, 26, 28, what is the fifth?',ch:['20','22','24','26'],c:2,fb:'Sum must be 120. 20+22+26+28=96. Fifth=24.'},
{n:3,d:'G',q:'In a 30-60-90 triangle, the hypotenuse is 16. What is the shorter leg?',ch:['4','8','8‚àö2','8‚àö3'],c:1,fb:'Short leg = hyp/2 = 16/2 = 8.'},
{n:4,d:'A',q:'Line passes through (‚àí1, 3) and (3, 11). What is the equation in slope-intercept form?',ch:['y = 2x + 5','y = 2x + 3','y = 4x + 7','y = ‚àí2x + 1'],c:0,fb:'m=(11‚àí3)/(3‚àí(‚àí1))=8/4=2. b: 3=2(‚àí1)+b ‚Üí b=5. y=2x+5.'},
{n:5,d:'AM',q:'Simplify: <code>(x¬≥y¬≤)/(x¬πy‚Å¥)</code>',ch:['x¬≤y¬≤','x¬≤/y¬≤','x‚Å¥y‚Å∂','xy¬≤'],c:1,fb:'x^(3‚àí1)/y^(4‚àí2) = x¬≤/y¬≤.'},
{n:6,d:'P',q:'A population of 2000 decreases by 5% per year. Which models this?',ch:['2000(1.05)·µó','2000(0.95)·µó','2000(0.05)·µó','2000 ‚àí 0.05t'],c:1,fb:'Decay: multiply by (1‚àí0.05)=0.95 each year.'},
{n:7,d:'A',q:'The system <code>y = 3x ‚àí 1</code> and <code>y = kx ‚àí 1</code> has infinitely many solutions when k = ?',ch:['‚àí3','‚àí1','1','3'],c:3,fb:'Same line ‚Üí same slope AND intercept. k=3.'},
{n:8,d:'G',q:'A circle has equation <code>x¬≤ + y¬≤ ‚àí 6x + 4y ‚àí 12 = 0</code>. What is the radius?',ch:['3','5','12','25'],c:1,fb:'Complete the square: (x‚àí3)¬≤+(y+2)¬≤=25. r=‚àö25=5.'},
{n:9,d:'P',q:'A bag has 4 red, 6 blue, 5 green marbles. P(blue | not green)?',ch:['6/15','6/10','6/9','2/5'],c:1,fb:'Not green = 4+6 = 10. P(blue|not green) = 6/10.'},
{n:10,d:'AM',q:'Factor completely: <code>3x¬≤ ‚àí 12x ‚àí 15</code>',ch:['3(x‚àí5)(x+1)','3(x+5)(x‚àí1)','(3x‚àí5)(x+3)','(3x‚àí15)(x+1)'],c:0,fb:'Factor out 3: 3(x¬≤‚àí4x‚àí5) = 3(x‚àí5)(x+1).'},
{n:11,d:'A',q:'Which represents "the cost is at least $50 but no more than $120"?',ch:['50 < c < 120','50 ‚â§ c ‚â§ 120','c > 50 or c < 120','c ‚â• 50 and c > 120'],c:1,fb:'"At least" = ‚â•, "no more than" = ‚â§. 50 ‚â§ c ‚â§ 120.'},
{n:12,d:'G',q:'In a right triangle, sin(A) = 5/13. What is cos(A)?',ch:['5/12','12/13','5/13','13/12'],c:1,fb:'If sin=5/13, opposite=5, hyp=13. Adjacent=12 (5-12-13 triple). cos=12/13.'},
{n:13,d:'P',q:'A scatter plot shows a strong negative linear association. The slope of the line of best fit is most likely:',ch:['‚àí0.85','0.15','0.85','‚àí0.02'],c:0,fb:'Negative association ‚Üí negative slope. Strong ‚Üí steep ‚Üí ‚àí0.85.'},
{n:14,d:'AM',q:'If <code>f(x) = 2x¬≤ ‚àí 8x + 6</code>, what is the minimum value of f?',ch:['‚àí2','0','2','6'],c:0,fb:'Vertex: x=8/4=2. f(2)=8‚àí16+6=‚àí2. Minimum is ‚àí2.'},
{n:15,d:'A',q:'The graph of <code>y = |x ‚àí 3| + 2</code> has its vertex at:',ch:['(3, 2)','(‚àí3, 2)','(3, ‚àí2)','(2, 3)'],c:0,fb:'|x‚àíh|+k ‚Üí vertex at (h,k) = (3,2).'},
{n:16,d:'G',q:'A cone has radius 6 and height 10. Volume?',ch:['60œÄ','120œÄ','360œÄ','40œÄ'],c:1,fb:'V=‚ÖìœÄr¬≤h = ‚ÖìœÄ(36)(10) = 120œÄ.'},
{n:17,d:'P',q:'Margin of error for a survey of 400: ¬±5%. For 1600: ¬±2.5%. What happened?',ch:['Sample doubled, MOE halved','Sample quadrupled, MOE halved','Sample doubled, MOE doubled','No relationship'],c:1,fb:'4√ó sample ‚Üí ¬Ω margin of error (MOE ‚àù 1/‚àön).'},
{n:18,d:'AM',q:'If <code>g(x) = 3À£</code>, what is g(x+2) in terms of g(x)?',ch:['g(x) + 2','2¬∑g(x)','9¬∑g(x)','g(x)¬≤'],c:2,fb:'g(x+2) = 3^(x+2) = 3À£ ¬∑ 3¬≤ = 9¬∑g(x).'},
{n:19,d:'A',q:'For what value of a does <code>ax + 6 = 3(2x + 2)</code> have no solution?',ch:['2','3','6','9'],c:2,fb:'ax+6=6x+6. If a=6: 6x+6=6x+6 ‚Üí infinite. Wait ‚Äî no solution needs same slope, different constant. ax+6=6x+6 ‚Üí (a‚àí6)x=0. If a=6 ‚Üí 0=0 infinite. For no solution we need parallel: same coefficient but different constant. Rework: ax+6=6x+6 means (a-6)x=0. This is always true (x=0) unless... Actually for no solution: the equation must be inconsistent. Let me reconsider: original is ax+6=6x+6 ‚Üí (a-6)x=0. If a‚â†6, x=0 (one solution). If a=6, 0=0 (infinite). No value gives no solution with this equation. Let me fix.'},
{n:20,d:'G',q:'A sector with central angle 120¬∞ in a circle of radius 9. Arc length?',ch:['3œÄ','6œÄ','9œÄ','12œÄ'],c:1,fb:'(120/360)√ó2œÄ(9) = ‚Öì√ó18œÄ = 6œÄ.'},
{n:21,d:'P',q:'Data set: {2, 5, 5, 7, 8, 9, 12, 42}. Which is true?',ch:['Mean > Median','Mean < Median','Mean = Median','Cannot determine'],c:0,fb:'Outlier 42 pulls mean up. Mean=11.25, Median=7.5. Mean > Median (skewed right).'},
{n:22,d:'AM',q:'The function <code>f(x) = ‚àí2(x ‚àí 1)¬≤ + 8</code> has a maximum at:',ch:['(1, 8)','(‚àí1, 8)','(1, ‚àí8)','(2, 8)'],c:0,fb:'Vertex form: (h,k)=(1,8). Negative a ‚Üí opens down ‚Üí maximum.'},
// MODULE 2 (23-44)
{n:23,d:'A',q:'Solve the system: <code>2x + 3y = 1</code> and <code>4x ‚àí y = 9</code>. What is x?',ch:['1','2','3','4'],c:1,fb:'From eq2: y=4x‚àí9. Sub: 2x+3(4x‚àí9)=1 ‚Üí 14x‚àí27=1 ‚Üí x=2.'},
{n:24,d:'AM',q:'If <code>x¬≤ ‚àí 10x + k = 0</code> has exactly one solution, what is k?',ch:['5','10','20','25'],c:3,fb:'Discriminant=0: 100‚àí4k=0 ‚Üí k=25.'},
{n:25,d:'P',q:'In a two-way table: P(A|B)=0.4, P(A|not B)=0.7. What can we conclude?',ch:['A and B are independent','A is more likely given B','A is less likely given B','No relationship'],c:2,fb:'P(A|B)=0.4 < P(A|not B)=0.7. A is less likely when B occurs.'},
{n:26,d:'G',q:'In triangle ABC, angle C = 90¬∞, AB = 10, BC = 6. What is tan(A)?',ch:['3/4','4/3','3/5','4/5'],c:0,fb:'AC=‚àö(100‚àí36)=8. tan(A)=opposite/adjacent=BC/AC=6/8=3/4.'},
{n:27,d:'A',q:'The function <code>f(x) = 3x + 7</code>. If f(a) = 22, what is f(2a)?',ch:['37','44','47','52'],c:0,fb:'3a+7=22 ‚Üí a=5. f(10)=30+7=37.'},
{n:28,d:'AM',q:'Which is equivalent to <code>(2x+3)(x¬≤‚àíx+4)</code>?',ch:['2x¬≥+x¬≤+5x+12','2x¬≥‚àí2x¬≤+11x+12','2x¬≥+x¬≤+5x+7','2x¬≥‚àíx¬≤+8x+12'],c:0,fb:'2x¬≥‚àí2x¬≤+8x+3x¬≤‚àí3x+12 = 2x¬≥+x¬≤+5x+12.'},
{n:29,d:'P',q:'A researcher wants to study exercise habits of college students. Which gives the most generalizable results?',ch:['Survey gym members','Ask volunteers online','Random sample from student directory','Interview the football team'],c:2,fb:'Random sample from full population ‚Üí most generalizable.'},
{n:30,d:'G',q:'Two concentric circles, radii 5 and 12. A point is random in the larger circle. P(inside the smaller)?',ch:['5/12','25/144','25/169','5/17'],c:1,fb:'P=œÄ(25)/œÄ(144) = 25/144.'},
{n:31,d:'A',q:'The line <code>y = ‚àí¬Ωx + 4</code> is perpendicular to a line with slope:',ch:['‚àí¬Ω','¬Ω','2','‚àí2'],c:2,fb:'Perpendicular slopes are negative reciprocals. ‚àí¬Ω ‚Üí 2.'},
{n:32,d:'AM',q:'If <code>f(x) = x¬≤ + 1</code> and <code>g(x) = 2x ‚àí 3</code>, what is f(g(2))?',ch:['2','4','5','10'],c:0,fb:'g(2)=1. f(1)=1+1=2.'},
{n:33,d:'P',q:'A value increases 25% then the result decreases 20%. Net change?',ch:['0%','‚àí5%','5%','‚àí1%'],c:0,fb:'100‚Üí125‚Üí100. Net: 0%. (1.25√ó0.80=1.00.)'},
{n:34,d:'G',q:'sin(30¬∞) =',ch:['¬Ω','‚àö2/2','‚àö3/2','1'],c:0,fb:'30-60-90: sin(30¬∞)=opposite/hyp=1/2.'},
{n:35,d:'A',q:'If <code>|2x + 5| ‚â§ 9</code>, what is the solution set?',ch:['‚àí7 ‚â§ x ‚â§ 2','x ‚â§ ‚àí7 or x ‚â• 2','‚àí2 ‚â§ x ‚â§ 7','x ‚â§ 2'],c:0,fb:'‚àí9 ‚â§ 2x+5 ‚â§ 9 ‚Üí ‚àí14 ‚â§ 2x ‚â§ 4 ‚Üí ‚àí7 ‚â§ x ‚â§ 2.'},
{n:36,d:'AM',q:'A bacteria population doubles every 3 hours. Starting at 500, the population after t hours is:',ch:['500(2)^(t/3)','500(2)^(3t)','1000t','500 + 2t/3'],c:0,fb:'Doubles every 3 hrs ‚Üí base 2, exponent t/3.'},
{n:37,d:'P',q:'A 95% confidence interval for the mean is (42, 58). What is the margin of error?',ch:['4','8','16','50'],c:1,fb:'MOE = (58‚àí42)/2 = 8.'},
{n:38,d:'G',q:'A square has vertices at (0,0), (4,0), (4,4), (0,4). What is the length of its diagonal?',ch:['4','4‚àö2','8','16'],c:1,fb:'d=‚àö(16+16)=‚àö32=4‚àö2. (45-45-90: leg√ó‚àö2.)'},
{n:39,d:'A',q:'If <code>f(x) = 2x + 3</code>, for what value of x does <code>f(2x) = f(x) + 5</code>?',ch:['1','2','2.5','5'],c:3,fb:'f(2x)=4x+3. f(x)+5=2x+8. 4x+3=2x+8 ‚Üí 2x=5 ‚Üí x=5/2. Hmm, not in choices. Let me recheck: 4x+3=2x+3+5=2x+8. 2x=5, x=2.5. Closest is 5/2 but not listed. Actually answer D is 5 ‚Äî let me fix.'},
{n:40,d:'AM',q:'Which function has a horizontal asymptote at y = 3?',ch:['f(x) = 3/x','f(x) = 3x/(x+1)','f(x) = (3x+1)/(x+1)','f(x) = x + 3'],c:2,fb:'(3x+1)/(x+1): as x‚Üí‚àû, approaches 3x/x=3. Horizontal asymptote y=3.'},
{n:41,d:'P',q:'Convert: 72 km/hr to m/s.',ch:['12','20','72','720'],c:1,fb:'72√ó1000/3600 = 72000/3600 = 20 m/s.'},
{n:42,d:'G',q:'An inscribed angle intercepts a semicircle. The angle measures:',ch:['45¬∞','90¬∞','180¬∞','360¬∞'],c:1,fb:'Semicircle = 180¬∞ arc. Inscribed angle = ¬Ω arc = 90¬∞.'},
{n:43,d:'A',q:'If the graph of <code>y = ax¬≤ + bx + c</code> opens downward and has vertex (2, 7), which must be true?',ch:['a > 0 and c = 7','a < 0 and max value is 7','a < 0 and min value is 7','a > 0 and max value is 7'],c:1,fb:'Opens down ‚Üí a < 0. Vertex is maximum when a < 0. Max value = 7.'},
{n:44,d:'AM',q:'If <code>log‚ÇÇ(x) = 5</code>, what is x?',ch:['10','16','25','32'],c:3,fb:'2‚Åµ = 32.'},
];

// Fix Q19 (had unsolvable "no solution" equation)
Q[18]={n:19,d:'A',q:'For what value of a does <code>ax + 3 = 2x + 3a</code> have no solution?',ch:['1','2','3','6'],c:1,fb:'ax‚àí2x=3a‚àí3. x(a‚àí2)=3(a‚àí1). If a=2: 0=3. No solution (contradiction).'};

// Fix Q39
Q[38]={n:39,d:'A',q:'If <code>f(x) = 2x + 3</code>, for what value of x does <code>f(3x) = f(x) + 10</code>?',ch:['1','2','2.5','5'],c:2,fb:'f(3x)=6x+3. f(x)+10=2x+13. 6x+3=2x+13 ‚Üí 4x=10 ‚Üí x=2.5.'};

// ======== TEST ENGINE (same as PSAT 8/9) ========
var testState='idle',curMod=1,curQ=0,answers=new Array(44).fill(-1),flags=new Array(44).fill(false);
var timerSec=35*60,timerInt=null;

function startTest(){
  if(testState==='idle'){testState='m1';curMod=1;curQ=0;timerSec=35*60;renderTest();startTimer();
    document.getElementById('startBtn').style.display='none';document.getElementById('flagBtn').style.display='';document.getElementById('submitBtn').style.display='';
  }else if(testState==='m1done'){testState='m2';curMod=2;curQ=22;timerSec=35*60;renderTest();startTimer();
    document.getElementById('startBtn').style.display='none';
  }
}
function startTimer(){
  clearInterval(timerInt);
  timerInt=setInterval(function(){
    timerSec--;if(timerSec<=0){clearInterval(timerInt);submitModule();}
    var m=Math.floor(timerSec/60),s=timerSec%60;
    var el=document.getElementById('timer');
    el.textContent=(m<10?'0':'')+m+':'+(s<10?'0':'')+s;
    el.className='test-timer'+(timerSec<120?' warn':'');
  },1000);
}
function renderTest(){
  var start=curMod===1?0:22,end=curMod===1?22:44;
  var nav='';for(var i=start;i<end;i++){
    var cls='test-nav-btn';if(i===curQ)cls+=' current';if(answers[i]>=0)cls+=' answered';if(flags[i])cls+=' flagged';
    nav+='<div class="'+cls+'" onclick="goQ('+i+')">'+(i+1)+'</div>';
  }
  document.getElementById('testNav').innerHTML=nav;
  var q=Q[curQ];
  document.getElementById('testArea').innerHTML='<div class="test-q active"><div style="margin-bottom:4px;font-size:.75rem;color:var(--muted)">Question '+(curQ+1)+' | '+({A:'Algebra',AM:'Advanced Math',P:'Data Analysis',G:'Geometry & Trig'}[q.d])+'</div><div class="ex-prompt" style="font-size:1rem;margin-bottom:12px">'+q.q+'</div><div class="mc-choices">'+q.ch.map(function(ch,ci){
    var c='mc-choice';if(answers[curQ]===ci)c+=' mc-selected';
    return '<div class="'+c+'" onclick="pickA('+ci+')"><div class="mc-letter">'+'ABCD'[ci]+'</div><div>'+ch+'</div></div>';
  }).join('')+'</div></div>';
  document.getElementById('testProg').textContent='Question '+(curQ+1)+' of '+(curMod===1?22:44)+' ‚Äî Module '+curMod;
}
function goQ(i){curQ=i;renderTest();}
function pickA(ci){answers[curQ]=ci;renderTest();}
function flagQ(){flags[curQ]=!flags[curQ];renderTest();}
function submitModule(){
  clearInterval(timerInt);
  if(curMod===1){testState='m1done';document.getElementById('startBtn').textContent='Start Module 2';document.getElementById('startBtn').style.display='';document.getElementById('flagBtn').style.display='none';document.getElementById('submitBtn').style.display='none';document.getElementById('timer').textContent='Module 1 Complete';document.getElementById('testProg').textContent='Click "Start Module 2" to continue.';
  }else{testState='done';document.getElementById('flagBtn').style.display='none';document.getElementById('submitBtn').style.display='none';document.getElementById('timer').textContent='Test Complete!';document.getElementById('testProg').textContent='Scroll down for your score report.';document.getElementById('testNav').innerHTML='';document.getElementById('testArea').innerHTML='';showResults();}
}

// ======== SCORING ========
function showResults(){
  var correct=0,domC={A:0,AM:0,P:0,G:0},domT={A:0,AM:0,P:0,G:0};
  Q.forEach(function(q,i){domT[q.d]++;if(answers[i]===q.c){correct++;domC[q.d]++;}});
  document.getElementById('scoreGrid').innerHTML=[
    {l:'Raw Score',v:correct+'/44',c:'var(--accent)'},
    {l:'Percentage',v:Math.round(correct/44*100)+'%',c:correct/44>.7?'var(--correct)':'var(--strat)'},
    {l:'Module 1',v:Q.slice(0,22).filter(function(_,i){return answers[i]===Q[i].c;}).length+'/22',c:'var(--math)'},
    {l:'Module 2',v:Q.slice(22).filter(function(_,i){return answers[i+22]===Q[i+22].c;}).length+'/22',c:'var(--math)'},
  ].map(function(s){return '<div class="report-card"><div class="report-big" style="color:'+s.c+'">'+s.v+'</div><div class="report-label">'+s.l+'</div></div>';}).join('');
  var doms=[{k:'A',n:'Algebra',c:'var(--algebra)'},{k:'AM',n:'Advanced Math',c:'var(--advanced)'},{k:'P',n:'Data Analysis',c:'var(--psda)'},{k:'G',n:'Geometry & Trig',c:'var(--geotrig)'}];
  document.getElementById('domainBreakdown').innerHTML=doms.map(function(d){
    var pct=domT[d.k]>0?Math.round(domC[d.k]/domT[d.k]*100):0;
    return '<div style="margin-bottom:10px"><div style="display:flex;justify-content:space-between;font-size:.85rem;margin-bottom:4px"><span style="font-weight:700;color:'+d.c+'">'+d.n+'</span><span style="color:var(--muted)">'+domC[d.k]+'/'+domT[d.k]+' ('+pct+'%)</span></div><div style="height:8px;background:var(--surface);border-radius:4px;overflow:hidden"><div style="height:100%;width:'+pct+'%;background:'+d.c+';border-radius:4px"></div></div></div>';
  }).join('');
  var rNav='';Q.forEach(function(q,i){rNav+='<div class="test-nav-btn '+(answers[i]===q.c?'correct-r':'wrong-r')+'" onclick="showReview('+i+')">'+(i+1)+'</div>';});
  document.getElementById('reviewNav').innerHTML=rNav;
  ['scoringSection','errorSection','growthSection','nextSection'].forEach(function(id){document.getElementById(id).style.display='';});
  renderErrors();
  document.getElementById('projMathRaw').value=correct;calcProj();
  document.getElementById('practScoreDisplay').textContent=correct;updateGrowth();
  showNextSteps(domC,domT);
  // Populate complete screen stats
  var m1cor=Q.slice(0,22).filter(function(_,i){return answers[i]===Q[i].c;}).length;
  var m2cor=Q.slice(22).filter(function(_,i){return answers[i+22]===Q[i+22].c;}).length;
  document.getElementById('completePracticeStats').innerHTML='<div style="background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px 20px;margin-bottom:24px;max-width:500px;width:100%;text-align:left"><div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:8px">Practice Test Results</div><div style="font-family:\'JetBrains Mono\',monospace;font-size:1.4rem;font-weight:700;color:var(--correct);margin-bottom:8px">'+correct+'/44 correct</div><div style="font-size:.82rem;color:var(--muted)">Module 1: '+m1cor+'/22 ¬∑ Module 2: '+m2cor+'/22</div></div>';
}
function showReview(i){
  var q=Q[i],ok=answers[i]===q.c;
  document.getElementById('reviewArea').innerHTML='<div class="ex-item" style="border-color:'+(ok?'var(--correct)':'var(--wrong)')+'"><div style="font-size:.78rem;color:var(--muted);margin-bottom:4px">Q'+(i+1)+' | '+({A:'Algebra',AM:'Advanced Math',P:'Data Analysis',G:'Geometry & Trig'}[q.d])+'</div><div class="ex-prompt">'+q.q+'</div><div class="mc-choices">'+q.ch.map(function(ch,ci){var c='mc-choice mc-dis';if(ci===q.c)c+=' mc-correct';else if(ci===answers[i])c+=' mc-wrong';return '<div class="'+c+'"><div class="mc-letter">'+'ABCD'[ci]+'</div><div>'+ch+'</div></div>';}).join('')+'</div><div class="mc-fb show">'+(ok?'‚úì Correct! ':'‚úó You picked '+'ABCD'[answers[i]]+'. ')+q.fb+'</div></div>';
}

// ======== ERROR ANALYSIS ========
var errorTypes={};
function renderErrors(){
  var missed=[];Q.forEach(function(q,i){if(answers[i]!==q.c)missed.push(i);});
  if(missed.length===0){document.getElementById('errorAnalysis').innerHTML='<p style="color:var(--correct);font-weight:700">Perfect score!</p>';return;}
  var types=['Careless/Arithmetic','Concept Gap','Misread Problem','Ran Out of Time','Strategy Gap'];
  document.getElementById('errorAnalysis').innerHTML=missed.map(function(i){var q=Q[i];
    return '<div class="ex-item" style="border-color:var(--wrong)"><div style="font-size:.78rem;color:var(--muted)">Q'+(i+1)+' ('+q.d+') ‚Äî You: '+'ABCD'[answers[i]]+', Correct: '+'ABCD'[q.c]+'</div><div class="ex-prompt" style="font-size:.88rem">'+q.q+'</div><div class="ec-row">'+types.map(function(t,ti){return '<div class="ec-btn'+(errorTypes[i]===ti?' sel':'')+'" onclick="classifyErr('+i+','+ti+')">'+t+'</div>';}).join('')+'</div></div>';
  }).join('');
  updateErrorSummary(missed,types);
}
function classifyErr(i,ti){errorTypes[i]=ti;renderErrors();}
function updateErrorSummary(missed,types){
  var counts=[0,0,0,0,0];missed.forEach(function(i){if(errorTypes[i]!==undefined)counts[errorTypes[i]]++;});
  var classified=counts.reduce(function(a,b){return a+b;},0);
  if(classified<missed.length){document.getElementById('errorSummary').innerHTML='<p style="font-size:.85rem;color:var(--muted)">Classify all '+missed.length+' errors to see summary. ('+classified+'/'+missed.length+')</p>';return;}
  var colors=['var(--strat)','var(--wrong)','var(--advanced)','var(--muted)','var(--accent)'];
  document.getElementById('errorSummary').innerHTML='<h3>Error Summary</h3><div class="report-grid">'+types.map(function(t,ti){return '<div class="report-card"><div class="report-big" style="color:'+colors[ti]+'">'+counts[ti]+'</div><div class="report-label">'+t+'</div></div>';}).join('')+'</div>';
}

// ======== ERROR CLASSIFICATION EXERCISE ========
var EC=[
  {s:'You identified center (3,‚àí2) from (x‚àí3)¬≤+(y+2)¬≤=16, but chose radius=16 instead of 4.',c:'Concept Gap',fb:'r¬≤=16 means r=4. Review circles.'},
  {s:'You solved a system correctly but wrote (3,5) when they asked for x+y. Answer was 8.',c:'Misread Problem',fb:'Classic trap ‚Äî re-read what they ask for.'},
  {s:'Variables in all choices. Spent 3 min on algebra. Plugging in x=2 would take 30 sec.',c:'Strategy Gap',fb:'Variables in choices = Plug In. Review Decision Tree.'},
  {s:'Ran out of time with 5 questions left unanswered.',c:'Time Pressure',fb:'Pacing issue. Use the two-pass system.'},
  {s:'Solved 3(x+4)=27 but expanded as 3x+4 instead of 3x+12.',c:'Careless/Arithmetic',fb:'You know distribution ‚Äî just did it wrong. Slow down.'},
  {s:'Exponential question: picked decay when it was growth. Confused (1+r) with (1‚àír).',c:'Concept Gap',fb:'Growth=(1+r), Decay=(1‚àír). Review exponentials.'},
];
var ecA={};
function renderEC(){
  document.getElementById('ecBox').innerHTML=EC.map(function(e,i){var a=ecA[i],h=a!==undefined;
    return '<div class="ec-item"><div style="font-size:.78rem;font-weight:700;color:var(--muted);margin-bottom:6px">Scenario '+(i+1)+'</div><div class="ec-scenario">'+e.s+'</div><div class="ec-options">'+['Concept Gap','Careless/Arithmetic','Time Pressure','Misread Problem','Strategy Gap'].map(function(o){var cls='ec-opt';if(h){cls+=' ec-dis';if(o===e.c)cls+=' ec-correct';else if(o===a)cls+=' ec-wrong';}return '<div class="'+cls+'" onclick="ecA['+i+']=\''+o+'\';renderEC()">'+o+'</div>';}).join('')+'</div><div class="ec-fb'+(h?' show':'')+'">'+(h?(a===e.c?'‚úì Correct! ':'‚úó ')+e.fb:'')+'</div></div>';
  }).join('');
  var t=EC.length,done=Object.keys(ecA).length,cor=Object.entries(ecA).filter(function(e){return e[1]===EC[e[0]].c;}).length;
  document.getElementById('ecScore').innerHTML=done===t?'<strong style="color:'+(cor>=5?'var(--correct)':'var(--strat)')+'">'+cor+'/'+t+' correct</strong>':'';
}
renderEC();

// ======== SCORE PROJECTOR (NMSQT-specific with Selection Index) ========
function calcProj(){
  var mr=parseInt(document.getElementById('projMathRaw').value);
  var rwr=parseInt(document.getElementById('projRWRaw').value);
  var m2=document.getElementById('projM2').value;
  if(isNaN(mr)&&isNaN(rwr)){document.getElementById('projResults').innerHTML='<div class="proj-result"><div class="proj-val" style="color:var(--muted)">‚Äî</div><div class="proj-label">Math Score</div></div><div class="proj-result"><div class="proj-val" style="color:var(--muted)">‚Äî</div><div class="proj-label">RW Score</div></div><div class="proj-result"><div class="proj-val" style="color:var(--muted)">‚Äî</div><div class="proj-label">Selection Index</div></div>';return;}
  var mathPct=isNaN(mr)?0:mr/44,rwPct=isNaN(rwr)?0:rwr/54;
  var hb=m2==='hard'?20:m2==='easy'?-20:0;
  var ms=isNaN(mr)?null:Math.min(760,Math.max(160,Math.round(160+mathPct*540+hb)));
  var rs=isNaN(rwr)?null:Math.min(760,Math.max(160,Math.round(160+rwPct*540)));
  var si=(ms&&rs)?Math.round((rs*2+ms)/10):null;
  document.getElementById('projResults').innerHTML=
    '<div class="proj-result"><div class="proj-val" style="color:'+(ms?ms>=700?'var(--correct)':ms>=600?'var(--psda)':'var(--wrong)':'var(--muted)')+'">'+( ms||'‚Äî')+'</div><div class="proj-label">Math (160‚Äì760)</div></div>'+
    '<div class="proj-result"><div class="proj-val" style="color:'+(rs?rs>=700?'var(--correct)':rs>=600?'var(--psda)':'var(--wrong)':'var(--muted)')+'">'+( rs||'‚Äî')+'</div><div class="proj-label">RW (160‚Äì760)</div></div>'+
    '<div class="proj-result"><div class="proj-val" style="color:'+(si?si>=215?'var(--correct)':si>=200?'var(--psda)':'var(--muted)':'var(--muted)')+'">'+( si||'‚Äî')+'</div><div class="proj-label">Selection Index</div></div>';
  var ins='';
  if(si){
    if(si>=220)ins='<strong style="color:var(--correct)">National Merit Semifinalist range!</strong> Competitive in most states.';
    else if(si>=215)ins='<strong style="color:var(--psda)">Approaching Semifinalist territory.</strong> A few more points could make the difference.';
    else if(si>=200)ins='<strong>Commended Scholar range.</strong> Solid ‚Äî targeted practice can push higher.';
    else ins='Keep working. Every raw score point translates to Selection Index gains.';
  }
  document.getElementById('projInsight').innerHTML=ins;
}
calcProj();

// ======== GROWTH ========
function updateGrowth(){
  var base=parseInt(document.getElementById('baseScore').value),pract=parseInt(document.getElementById('practScoreDisplay').textContent);
  var el=document.getElementById('growthResult');
  if(isNaN(base)||isNaN(pract)){el.textContent='Enter your diagnostic score to see growth.';return;}
  var diff=pract-base;
  if(diff>0)el.innerHTML='<span style="color:var(--correct);font-weight:700;font-size:1.1rem">+'+diff+' questions improved!</span><br><span style="font-size:.85rem;color:var(--muted)">~'+(diff*14)+' points on the scaled score.</span>';
  else if(diff===0)el.innerHTML='<span style="color:var(--strat);font-weight:700">Same score.</span><br><span style="font-size:.85rem;color:var(--muted)">Check error types ‚Äî different mistakes can still mean progress.</span>';
  else el.innerHTML='<span style="color:var(--strat);font-weight:700">'+diff+'.</span><br><span style="font-size:.85rem;color:var(--muted)">Practice conditions can be harder. Focus on error analysis.</span>';
}

// ======== NEXT STEPS ========
function showNextSteps(domC,domT){
  var weak=[];
  [{k:'A',n:'Algebra',m:'Module 2'},{k:'AM',n:'Advanced Math',m:'Module 3'},{k:'P',n:'Data Analysis',m:'Module 4'},{k:'G',n:'Geometry & Trig',m:'Module 5'}].forEach(function(d){
    if(domT[d.k]>0&&domC[d.k]/domT[d.k]<0.7)weak.push(d);
  });
  var h='<div class="card card-accent"><h3 style="margin-bottom:10px">Priority Review</h3>';
  if(weak.length===0)h+='<p style="color:var(--correct)">All domains above 70%! Focus on reducing careless errors and timed practice.</p>';
  else h+='<p style="color:#ccc;margin-bottom:10px">These domains scored below 70% \u2014 review them before test day:</p>'+weak.map(function(d){return '<div style="padding:8px 0;border-bottom:1px solid rgba(255,255,255,.05)"><strong style="color:var(--wrong)">'+d.n+'</strong> \u2014 Review <strong>'+d.m+'</strong> and redo the exercises and practice questions.</div>';}).join('');
  h+='<h3 style="margin-top:16px;margin-bottom:10px">Your Action Plan</h3>';
  h+='<div style="font-size:.9rem;color:#ccc;line-height:1.8">';
  h+='<strong>Now \u2192 48 Hours:</strong> Review every missed question. Classify each error (concept, careless, strategy, misread). Redo the ones you got wrong.<br>';
  h+='<strong>This Week:</strong> Go back to the module(s) for your weak domains. Redo the exercises and practice questions \u2014 don\u2019t just re-read.<br>';
  h+='<strong>1 Week Before Test:</strong> Take another full practice test under strict timed conditions. Review the formula card and test-day checklist below.<br>';
  h+='<strong>Night Before:</strong> Light review only (flip through formula cards). No new material after 8 PM. Lay out everything. Set two alarms.<br>';
  h+='<strong>Test Day:</strong> Warm up with 3\u20135 easy problems. Use your LOTD letter. Two-pass every module. Never leave blanks.<br>';
  h+='<strong>After the PSAT/NMSQT:</strong> Your score report will show specific skill areas. Use it to target your SAT prep \u2014 everything you learned here carries directly forward.';
  h+='</div></div>';
  document.getElementById('nextSteps').innerHTML=h;
}

// ======== CHECKLISTS ========
function renderChecklist(id,items){
  document.getElementById(id).innerHTML=items.map(function(t,i){
    return '<div class="checklist-item"><div class="checklist-check" id="'+id+i+'" onclick="this.classList.toggle(\'done\');this.textContent=this.classList.contains(\'done\')?\'‚úì\':\'\'"></div><div>'+t+'</div></div>';
  }).join('');
}
renderChecklist('preChecklist',[
  'Find a quiet space with 70+ minutes uninterrupted.',
  'Open <a href="https://www.desmos.com/calculator" target="_blank" style="color:var(--accent)">desmos.com/calculator</a> in another tab.',
  'Have scratch paper and pencils ready.',
  'Turn off phone, close other tabs.',
  'Remember: accuracy over speed in Module 1.',
  'Desmos shortcuts memorized: ^ _ ~ | sqrt pi',
]);
renderChecklist('testDayChecklist',[
  '<strong>Night before:</strong> Charge your device. Sleep 8+ hours.',
  '<strong>Morning:</strong> Eat a real breakfast. Bring a snack.',
  '<strong>Bring:</strong> Charged device, pencils, approved calculator (backup).',
  '<strong>Bluebook app</strong> must be installed and updated.',
  '<strong>Module 1:</strong> Two-pass system. Flag hard questions. Accuracy first.',
  '<strong>Desmos:</strong> Use aggressively for systems, quadratics, statistics.',
  '<strong>Time check:</strong> After 15 min, be on question 8+.',
  '<strong>Last 2 min:</strong> Answer ALL remaining questions ‚Äî no penalty for guessing.',
  '<strong>Between modules:</strong> Breathe. Stay confident.',
  '<strong>For National Merit:</strong> Every Selection Index point matters. Maximize both Math and RW.',
]);
</script>
<script src="/translate.js"></script>
</body>
</html>
