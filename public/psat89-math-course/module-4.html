<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Module 4: Problem-Solving & Data â€” PSAT 8/9 Math â€” PantherPrep</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=Source+Sans+3:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root{--ink:#f0f0f0;--paper:#121212;--accent:#0891b2;--accent-light:rgba(8,145,178,.12);--border:#2a2a2a;--muted:#999;--surface:#1a1a1a;--math:#60a5fa;--math-bg:rgba(96,165,250,.1);--algebra:#34d399;--advanced:#a78bfa;--psda:#fbbf24;--geo:#f87171;--correct:#22c55e;--correct-bg:rgba(34,197,94,.12);--wrong:#ef4444;--wrong-bg:rgba(239,68,68,.12);--danger:#ef4444;--danger-bg:rgba(239,68,68,.08);--grad:linear-gradient(135deg,var(--psda),var(--strat))}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Source Sans 3',sans-serif;background:var(--paper);color:var(--ink);line-height:1.65;overflow-x:hidden}
.top-stripe{height:4px;background:linear-gradient(90deg,#0891b2 0%,#0891b2 50%,#fff 50%,#fff 100%);position:fixed;top:0;left:0;right:0;z-index:100}

/* â”€â”€ Screen System â”€â”€ */
.screen{display:none;opacity:0;transition:opacity .4s ease;min-height:100vh}
.screen.active{display:block;opacity:1}
.screen.fade-in{animation:fadeIn .4s ease forwards}
.screen.fade-out{animation:fadeOut .3s ease forwards}
@keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeOut{from{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-12px)}}

/* â”€â”€ Progress Dots â”€â”€ */
.screen-progress{position:fixed;top:12px;left:50%;transform:translateX(-50%);display:flex;gap:8px;z-index:101;padding:6px 14px;background:rgba(18,18,18,.85);backdrop-filter:blur(8px);border-radius:20px;border:1px solid var(--border)}
.screen-dot{width:8px;height:8px;border-radius:50%;background:var(--border);transition:all .3s;cursor:pointer}
.screen-dot.completed{background:var(--psda)}
.screen-dot.current{background:var(--accent);box-shadow:0 0 8px rgba(8,145,178,.5);transform:scale(1.25)}
.screen-dot:hover{transform:scale(1.3)}

/* â”€â”€ Container â”€â”€ */
.container{max-width:800px;margin:0 auto;padding:20px 20px 60px}

/* â”€â”€ Welcome Screen â”€â”€ */
.welcome-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:40px 20px;text-align:center}
.welcome-badge{display:inline-block;background:var(--psda);color:#000;font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:5px 14px;border-radius:16px;margin-bottom:18px}
.welcome-screen h1{font-family:'Cormorant Garamond',serif;font-size:clamp(2rem,5vw,3rem);font-weight:700;margin-bottom:8px;max-width:600px;background:var(--grad);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.welcome-sub{color:var(--muted);font-size:1.05rem;max-width:500px;margin:0 auto 32px}
.welcome-meta{display:flex;gap:24px;justify-content:center;margin-bottom:36px;font-size:.85rem;color:var(--muted)}
.preview-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;max-width:600px;width:100%;margin-bottom:40px}
.preview-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px 14px;text-align:left;transition:all .2s}
.preview-card:hover{border-color:var(--psda);transform:translateY(-2px)}
.preview-icon{font-size:1.4rem;margin-bottom:8px}
.preview-title{font-size:.82rem;font-weight:700;margin-bottom:3px}
.preview-desc{font-size:.72rem;color:var(--muted);line-height:1.4}
.start-btn{padding:14px 36px;background:var(--grad);color:#000;border:none;border-radius:10px;font-size:1rem;font-weight:700;cursor:pointer;transition:all .2s;font-family:'Source Sans 3',sans-serif}
.start-btn:hover{filter:brightness(1.15);transform:translateY(-1px);box-shadow:0 6px 20px rgba(251,191,36,.3)}

/* â”€â”€ Retrieval Warm-Up â”€â”€ */
.warmup-container{max-width:600px;margin:0 auto;padding:60px 20px}
.warmup-header{text-align:center;margin-bottom:32px}
.warmup-badge{display:inline-block;background:var(--psda);color:#000;font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:4px 12px;border-radius:12px;margin-bottom:12px}
.warmup-dots{display:flex;gap:8px;justify-content:center;margin-top:16px}
.warmup-dot{width:10px;height:10px;border-radius:50%;background:var(--border);transition:all .3s}
.warmup-dot.done-correct{background:var(--correct)}
.warmup-dot.done-wrong{background:var(--wrong)}
.warmup-dot.active{background:var(--psda);box-shadow:0 0 8px rgba(251,191,36,.4)}
.warmup-q{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:24px;margin-bottom:16px}
.warmup-q .source-tag{font-size:.7rem;color:var(--psda);font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:8px}
.warmup-q .q-text{font-size:.95rem;line-height:1.7;margin-bottom:14px}
.warmup-choices{display:flex;flex-direction:column;gap:8px}
.warmup-choice{display:flex;align-items:center;gap:10px;padding:11px 14px;background:var(--paper);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.88rem;transition:all .15s}
.warmup-choice:hover:not(.wu-dis){border-color:var(--psda);background:rgba(251,191,36,.05)}
.warmup-choice.wu-correct{border-color:var(--correct);background:var(--correct-bg)}
.warmup-choice.wu-wrong{border-color:var(--wrong);background:var(--wrong-bg)}
.warmup-choice.wu-dis{pointer-events:none;opacity:.7}
.warmup-choice.wu-correct{opacity:1}
.warmup-fb{font-size:.85rem;color:var(--muted);line-height:1.6;margin-top:12px;padding:10px;background:var(--paper);border-radius:8px;border-left:3px solid var(--correct)}
.warmup-next{padding:10px 24px;background:var(--psda);color:#000;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:.88rem;margin-top:12px;font-family:'Source Sans 3',sans-serif}
.warmup-next:hover{filter:brightness(1.1)}
.warmup-summary{text-align:center;padding:40px 20px}
.warmup-score{font-family:'JetBrains Mono',monospace;font-size:2.4rem;font-weight:700;color:var(--psda);margin:12px 0}
.warmup-continue{padding:12px 28px;background:var(--psda);color:#000;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:.95rem;margin-top:20px;font-family:'Source Sans 3',sans-serif}
.warmup-continue:hover{filter:brightness(1.15)}

/* â”€â”€ Lesson Content â”€â”€ */
.back-link{display:inline-flex;align-items:center;gap:8px;color:var(--muted);font-size:.9rem;padding:8px 0;margin-top:8px;cursor:pointer;text-decoration:none}
.back-link:hover{color:var(--accent)}
.mod-header{padding:40px 0 30px;border-bottom:1px solid var(--border);margin-bottom:32px}
.mod-badge{display:inline-block;background:var(--psda);color:#000;font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:5px 14px;border-radius:16px;margin-bottom:14px}
.mod-header h1{font-family:'Cormorant Garamond',serif;font-size:clamp(1.8rem,4vw,2.6rem);font-weight:700;margin-bottom:6px}
.mod-header .subtitle{color:var(--muted);font-size:1rem}
.mod-meta{display:flex;gap:20px;margin-top:14px;font-size:.82rem;color:var(--muted)}
.section{margin-bottom:36px}
.section-label{font-size:.7rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--psda);margin-bottom:6px}
.section h2{font-family:'Cormorant Garamond',serif;font-size:1.6rem;font-weight:700;margin-bottom:12px}
.section p{color:#ccc;font-size:.93rem;margin-bottom:12px;line-height:1.7}
.card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:18px 20px;margin-bottom:12px}
.card-accent{border-left:3px solid var(--accent)}
.callout{background:var(--accent-light);border:1px solid rgba(8,145,178,.3);border-radius:10px;padding:14px 18px;margin-bottom:16px;font-size:.9rem}
.callout strong{color:var(--accent)}
.callout-blue{background:var(--math-bg);border-color:rgba(96,165,250,.3)}.callout-blue strong{color:var(--math)}
.callout-gold{background:rgba(251,191,36,.08);border-color:rgba(251,191,36,.3)}.callout-gold strong{color:var(--psda)}
.topic{background:var(--surface);border:1px solid var(--border);border-radius:14px;margin-bottom:12px;overflow:hidden;transition:all .3s}
.topic-header{display:flex;align-items:center;gap:14px;padding:16px 20px;cursor:pointer}
.topic-badge{width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.82rem;color:#000;flex-shrink:0}
.topic-info{flex:1}.topic-title{font-weight:700;font-size:.95rem}.topic-sub{font-size:.82rem;color:var(--muted);margin-top:2px}
.topic-arrow{color:var(--muted);transition:transform .2s;font-size:.9rem}
.topic.open .topic-arrow{transform:rotate(90deg)}
.topic-body{display:none;padding:0 20px 18px;font-size:.9rem;color:#ccc;line-height:1.7}
.topic.open .topic-body{display:block}
.topic-body h4{font-size:.95rem;color:var(--ink);margin:14px 0 6px;font-weight:700}
.topic-body ul{padding-left:18px;margin-bottom:10px}.topic-body li{margin-bottom:6px}
.formula-box{background:var(--paper);border:1px solid var(--border);border-radius:10px;padding:14px 16px;margin:10px 0;font-family:'JetBrains Mono',monospace;font-size:.85rem;line-height:1.8}
.formula-box .fn{color:var(--psda);font-weight:700}.formula-box .fl{color:var(--math);font-weight:700}
.exercise{background:var(--surface);border:2px solid var(--psda);border-radius:14px;padding:22px;margin-bottom:16px}
.exercise h3{font-family:'Cormorant Garamond',serif;font-size:1.2rem;margin-bottom:4px}
.exercise-sub{font-size:.82rem;color:var(--muted);margin-bottom:14px}
.ex-item{background:var(--paper);border:1px solid var(--border);border-radius:10px;padding:14px;margin-bottom:10px}
.ex-prompt{font-size:.92rem;line-height:1.6;margin-bottom:10px;color:#ddd}
.ex-prompt code{background:rgba(96,165,250,.1);color:var(--math);padding:1px 6px;border-radius:4px;font-family:'JetBrains Mono',monospace;font-size:.85rem}
.ex-input-row{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.ex-input{padding:8px 12px;background:var(--surface);border:1px solid var(--border);border-radius:6px;color:var(--ink);font-family:'JetBrains Mono',monospace;font-size:1rem;width:100px;text-align:center}
.ex-input:focus{border-color:var(--psda);outline:none}
.ex-btn{padding:8px 16px;background:var(--psda);color:#000;border:none;border-radius:6px;cursor:pointer;font-size:.82rem;font-weight:600}.ex-btn:hover{filter:brightness(1.15)}
.ex-fb{font-size:.82rem;padding:8px 10px;border-radius:6px;margin-top:8px;display:none;line-height:1.5}
.ex-fb.show{display:block}.ex-fb.correct{background:var(--correct-bg);color:var(--correct)}.ex-fb.wrong{background:var(--wrong-bg);color:var(--wrong)}
.tier{display:inline-block;padding:2px 8px;border-radius:4px;font-size:.68rem;font-weight:700;letter-spacing:1px;text-transform:uppercase}
.tier-1{background:rgba(52,211,153,.15);color:var(--algebra)}.tier-2{background:var(--math-bg);color:var(--math)}.tier-3{background:rgba(167,139,250,.15);color:var(--advanced)}
.classify-opts{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:4px}
.classify-opt{padding:6px 14px;background:var(--surface);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.82rem;transition:all .15s}
.classify-opt:hover:not(.cl-dis){border-color:var(--psda);background:rgba(251,191,36,.08)}
.classify-opt.cl-correct{border-color:var(--correct);background:var(--correct-bg);color:var(--correct);opacity:1}
.classify-opt.cl-wrong{border-color:var(--wrong);background:var(--wrong-bg);color:var(--wrong)}
.classify-opt.cl-dis{pointer-events:none;opacity:.6}.classify-opt.cl-correct{opacity:1}

/* â”€â”€ Trap Taxonomy â”€â”€ */
.trap-taxonomy{margin-bottom:24px}
.trap-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px 18px;margin-bottom:10px;display:flex;gap:14px;align-items:flex-start;transition:all .2s}
.trap-card:hover{border-color:var(--accent);transform:translateX(3px)}
.trap-number{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.78rem;color:#fff;flex-shrink:0}
.trap-card-body{flex:1}
.trap-card-name{font-weight:700;font-size:.92rem;margin-bottom:3px}
.trap-card-desc{font-size:.82rem;color:var(--muted);line-height:1.5}
.trap-card-example{font-size:.78rem;color:var(--math);font-family:'JetBrains Mono',monospace;margin-top:4px}

/* â”€â”€ Confidence Tags â”€â”€ */
.confidence-row{display:flex;gap:6px;margin-bottom:10px;flex-wrap:wrap}
.conf-tag{padding:5px 12px;border-radius:6px;font-size:.75rem;font-weight:600;cursor:pointer;border:2px solid var(--border);background:var(--surface);transition:all .15s;letter-spacing:.5px}
.conf-tag:hover{border-color:var(--psda)}
.conf-tag.selected{border-color:var(--psda);background:rgba(251,191,36,.12);color:var(--psda)}
.conf-tag[data-conf="guessing"].selected{border-color:var(--psda);background:rgba(251,191,36,.12);color:var(--psda)}
.conf-tag[data-conf="unsure"].selected{border-color:var(--math);background:var(--math-bg);color:var(--math)}
.conf-tag[data-conf="confident"].selected{border-color:var(--psda);background:rgba(251,191,36,.12);color:var(--psda)}

/* â”€â”€ Timed Practice â”€â”€ */
.timer-bar{position:sticky;top:8px;z-index:50;background:rgba(18,18,18,.92);backdrop-filter:blur(8px);border:1px solid var(--border);border-radius:12px;padding:10px 16px;margin-bottom:20px;display:flex;align-items:center;gap:14px}
.timer-display{font-family:'JetBrains Mono',monospace;font-size:1.1rem;font-weight:700;color:var(--psda);min-width:60px}
.timer-display.warning{color:var(--psda)}
.timer-display.danger{color:var(--wrong);animation:pulse 1s ease infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
.timer-track{flex:1;height:4px;background:var(--border);border-radius:2px;overflow:hidden}
.timer-fill{height:100%;background:var(--grad);transition:width 1s linear;border-radius:2px}
.timer-fill.warning{background:var(--psda)}
.timer-fill.danger{background:var(--wrong)}
.timer-toggle{padding:5px 12px;background:var(--surface);border:1px solid var(--border);border-radius:6px;font-size:.75rem;color:var(--muted);cursor:pointer;font-family:'Source Sans 3',sans-serif;font-weight:600}
.timer-toggle:hover{border-color:var(--accent);color:var(--ink)}
.timer-toggle.active{background:var(--accent-light);border-color:var(--accent);color:var(--accent)}
.q-dots{display:flex;gap:4px}
.q-dot{width:8px;height:8px;border-radius:50%;background:var(--border)}
.q-dot.correct{background:var(--correct)}
.q-dot.wrong{background:var(--wrong)}
.q-dot.current{background:var(--accent);box-shadow:0 0 6px rgba(8,145,178,.5)}

/* â”€â”€ MC Choices â”€â”€ */
.mc-choices{display:flex;flex-direction:column;gap:6px}
.mc-choice{display:flex;align-items:center;gap:10px;padding:10px 14px;background:var(--paper);border:2px solid var(--border);border-radius:8px;cursor:pointer;font-size:.88rem;transition:all .15s}
.mc-choice:hover:not(.mc-dis){border-color:var(--psda);background:rgba(251,191,36,.05)}
.mc-letter{font-weight:700;color:var(--muted);min-width:20px}
.mc-choice.mc-correct{border-color:var(--correct);background:var(--correct-bg);opacity:1}
.mc-choice.mc-wrong{border-color:var(--wrong);background:var(--wrong-bg)}
.mc-choice.mc-dis{pointer-events:none;opacity:.7}.mc-choice.mc-correct{opacity:1}
.mc-choice.mc-correct .mc-letter{color:var(--correct)}.mc-choice.mc-wrong .mc-letter{color:var(--wrong)}
.mc-fb{font-size:.85rem;color:var(--muted);line-height:1.6;margin-top:10px;padding:10px;background:var(--paper);border-radius:8px;display:none;border-left:3px solid var(--correct)}.mc-fb.show{display:block}
.score-bar{display:flex;align-items:center;gap:10px;margin-top:14px;padding-top:10px;border-top:1px solid var(--border)}
.score-bar-label{font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted)}
.score-bar-track{flex:1;height:6px;border-radius:3px;background:var(--border);overflow:hidden}
.score-bar-fill{height:100%;border-radius:3px;background:var(--correct);transition:width .4s ease}
.score-bar-val{font-family:'JetBrains Mono',monospace;font-size:.85rem;font-weight:700;color:var(--correct);min-width:36px;text-align:right}

/* â”€â”€ Results Enhancement â”€â”€ */
.results-section{margin-top:24px;padding:20px;background:var(--surface);border:1px solid var(--border);border-radius:14px}
.results-section h3{font-family:'Cormorant Garamond',serif;font-size:1.3rem;margin-bottom:14px}
.results-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:2px;margin-bottom:16px;background:var(--border);border-radius:10px;overflow:hidden}
.results-grid-header{background:var(--surface);padding:8px;text-align:center;font-size:.68rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted)}
.results-grid-cell{background:var(--paper);padding:10px 8px;text-align:center;font-size:.78rem;min-height:50px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px}
.results-grid-cell.danger-cell{background:var(--danger-bg);border:1px solid rgba(239,68,68,.3)}
.cell-label{font-size:.65rem;color:var(--muted);font-weight:600}
.cell-dots{display:flex;gap:3px;flex-wrap:wrap;justify-content:center}
.cell-dot{width:8px;height:8px;border-radius:50%}
.difficulty-bars{display:flex;flex-direction:column;gap:8px;margin-bottom:16px}
.diff-row{display:flex;align-items:center;gap:10px}
.diff-label{font-size:.78rem;font-weight:600;min-width:60px}
.diff-track{flex:1;height:8px;background:var(--border);border-radius:4px;overflow:hidden}
.diff-fill{height:100%;border-radius:4px;transition:width .5s ease}
.diff-val{font-family:'JetBrains Mono',monospace;font-size:.78rem;font-weight:700;min-width:40px;text-align:right}
.error-category{padding:12px 16px;border-radius:10px;margin-bottom:8px;font-size:.85rem;line-height:1.6}
.error-category .error-label{font-weight:700;margin-bottom:4px}
.error-category .error-items{color:var(--muted);font-size:.82rem}

/* â”€â”€ Module Complete â”€â”€ */
.complete-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:40px 20px;text-align:center}
.complete-icon{font-size:4rem;margin-bottom:16px;animation:celebrateBounce .6s ease}
@keyframes celebrateBounce{0%{transform:scale(0)}50%{transform:scale(1.2)}100%{transform:scale(1)}}
.complete-screen h1{font-family:'Cormorant Garamond',serif;font-size:clamp(1.8rem,4vw,2.4rem);margin-bottom:8px;background:var(--grad);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.complete-sub{color:var(--muted);font-size:1rem;margin-bottom:28px}
.takeaway-list{text-align:left;max-width:500px;width:100%;margin-bottom:32px}
.takeaway-item{display:flex;gap:10px;align-items:flex-start;padding:8px 0;font-size:.88rem;color:#ccc}
.takeaway-check{color:var(--correct);flex-shrink:0;font-weight:700}
.nav-cards{display:grid;grid-template-columns:1fr 1fr;gap:12px;max-width:500px;width:100%}
.nav-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:18px;text-align:center;cursor:pointer;transition:all .2s;text-decoration:none;color:var(--ink)}
.nav-card:hover{border-color:var(--psda);transform:translateY(-2px)}
.nav-card-label{font-size:.7rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:4px}
.nav-card-title{font-weight:700;font-size:.95rem}

/* â”€â”€ Two-way table â”€â”€ */
.tw-table{width:100%;border-collapse:collapse;font-size:.85rem;margin:12px 0}
.tw-table th,.tw-table td{padding:8px 10px;border:1px solid var(--border);text-align:center}
.tw-table th{background:var(--surface);font-weight:700;color:var(--psda);font-size:.78rem;text-transform:uppercase;letter-spacing:.5px}
.tw-table td{color:#ccc}

/* â”€â”€ Statistics Explorer â”€â”€ */
.stat-exp{background:var(--surface);border:2px solid var(--psda);border-radius:14px;padding:22px;margin-bottom:16px}
.stat-input{width:100%;padding:10px 14px;background:var(--paper);border:1px solid var(--border);border-radius:8px;color:var(--ink);font-family:'JetBrains Mono',monospace;font-size:.95rem}
.stat-input:focus{border-color:var(--psda);outline:none}
.stat-results{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:14px}
.stat-card{background:var(--paper);border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center}
.stat-label{font-size:.68rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:4px}
.stat-val{font-family:'JetBrains Mono',monospace;font-size:1.3rem;font-weight:700}

/* â”€â”€ Responsive â”€â”€ */
@media(max-width:600px){
  .mod-meta{flex-wrap:wrap;gap:10px}
  .classify-opts{gap:4px}
  .preview-grid{grid-template-columns:1fr 1fr}
  .welcome-meta{flex-wrap:wrap;gap:12px}
  .results-grid{grid-template-columns:1fr;gap:1px}
  .nav-cards{grid-template-columns:1fr}
  .timer-bar{flex-wrap:wrap;gap:8px}
  .stat-results{grid-template-columns:repeat(2,1fr)}
}
</style>
</head>
<body>
<div class="top-stripe"></div>

<!-- â”€â”€ Screen Progress Dots â”€â”€ -->
<div class="screen-progress" id="screenProgress"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- SCREEN 1: WELCOME                             -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen active fade-in" id="screen-welcome">
  <div class="welcome-screen">
    <div class="welcome-badge">Module 4</div>
    <h1>Problem-Solving & Data Analysis</h1>
    <p class="welcome-sub">~15% of the test â€” but built on grades 6-8 content. This is the highest-ROI domain for quick score gains.</p>
    <div class="welcome-meta">
      <span>â± ~60 min</span>
      <span>ğŸ“‹ 4 topics</span>
      <span>ğŸ”¨ 5 exercises</span>
      <span>ğŸ¯ 10 practice Qs</span>
    </div>
    <div class="preview-grid">
      <div class="preview-card">
        <div class="preview-icon">ğŸ”„</div>
        <div class="preview-title">Retrieval Warm-Up</div>
        <div class="preview-desc">5 questions from Module 3 to activate prior knowledge</div>
      </div>
      <div class="preview-card">
        <div class="preview-icon">âš–ï¸</div>
        <div class="preview-title">Ratios & Rates</div>
        <div class="preview-desc">Proportions, unit rates, dimensional analysis</div>
      </div>
      <div class="preview-card">
        <div class="preview-icon">ğŸ’¯</div>
        <div class="preview-title">Percents</div>
        <div class="preview-desc">Increase, decrease, multi-step traps</div>
      </div>
      <div class="preview-card">
        <div class="preview-icon">ğŸ“Š</div>
        <div class="preview-title">Statistics & Probability</div>
        <div class="preview-desc">Mean, median, two-way tables, conditional probability</div>
      </div>
      <div class="preview-card">
        <div class="preview-icon">ğŸ”¬</div>
        <div class="preview-title">Study Design</div>
        <div class="preview-desc">Correlation vs causation, sampling, margin of error</div>
      </div>
      <div class="preview-card">
        <div class="preview-icon">â±</div>
        <div class="preview-title">Timed Practice</div>
        <div class="preview-desc">10 PSAT-style questions with confidence tracking</div>
      </div>
    </div>
    <button class="start-btn" onclick="goScreen(1)">Start Learning â†’</button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- SCREEN 2: RETRIEVAL WARM-UP                   -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen" id="screen-warmup">
  <div class="warmup-container">
    <div class="warmup-header">
      <div class="warmup-badge">Retrieval Warm-Up</div>
      <h2 style="font-family:'Cormorant Garamond',serif;font-size:1.6rem">Module 3 Review</h2>
      <p style="color:var(--muted);font-size:.9rem;margin-top:4px">Quick recall from Advanced Math â€” the foundation for everything ahead.</p>
      <div class="warmup-dots" id="warmupDots"></div>
    </div>
    <div id="warmupContent"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- SCREEN 3: LESSON CONTENT                      -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen" id="screen-lesson">
<div class="container">
<div class="mod-header">
  <div class="mod-badge">Module 4</div>
  <h1>Problem-Solving & Data Analysis</h1>
  <p class="subtitle">~15% of the test â€” but built on grades 6-8 content. This is the highest-ROI domain for quick score gains.</p>
  <div class="mod-meta"><span>â± ~60 min</span><span>ğŸ“‹ 4 topics + 5 exercises</span><span>ğŸ”¨ Phase 2: Build</span></div>
</div>

<div class="callout-gold callout"><strong>Quick Wins Domain:</strong> Problem-Solving & Data Analysis draws heavily on grades 6-8 content â€” ratios, percentages, basic statistics. If you're solid on fundamentals, you can pick up 5-7 questions with targeted review.</div>

<!-- TOPIC 4A: Ratios, Rates & Proportions -->
<div class="section">
  <div class="section-label">Topic 4A</div>
  <h2>Ratios, Rates & Proportions</h2>
</div>

<div class="topic open" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
  <div class="topic-header">
    <div class="topic-badge" style="background:var(--psda)">4A</div>
    <div class="topic-info"><div class="topic-title">Ratios, Rates & Unit Conversions</div><div class="topic-sub">Proportional relationships, unit rates, dimensional analysis</div></div>
    <div class="topic-arrow">â–¸</div>
  </div>
  <div class="topic-body">
    <h4>Core Concepts</h4>
    <ul>
      <li><strong>Ratio:</strong> Compares two quantities. Written as a:b, a/b, or "a to b"</li>
      <li><strong>Rate:</strong> A ratio with different units. Speed (mi/hr), price ($/item), density (people/sq mi)</li>
      <li><strong>Unit rate:</strong> Rate per ONE unit. "60 miles per hour" = 60 mi/1 hr</li>
      <li><strong>Proportion:</strong> Two equal ratios. Cross-multiply to solve: a/b = c/d â†’ ad = bc</li>
    </ul>
    <div class="formula-box">
      <div><span class="fn">Proportion:</span> a/b = c/d â†’ cross multiply â†’ ad = bc</div>
      <div><span class="fn">Unit Rate:</span> total Ã· number of units</div>
      <div><span class="fn">Unit Conversion:</span> multiply by fractions where units cancel</div>
      <div style="color:var(--muted);font-size:.82rem">Example: 60 mph Ã— (5280 ft/1 mi) Ã— (1 hr/3600 sec) = 88 ft/sec</div>
    </div>
    <h4>Direct vs. Inverse Proportion</h4>
    <ul>
      <li><strong>Direct:</strong> y = kx. As x doubles, y doubles. y/x stays constant.</li>
      <li><strong>Inverse:</strong> y = k/x. As x doubles, y halves. xy stays constant.</li>
    </ul>
    <div class="callout"><strong>Unit Conversion Trap:</strong> The question gives data in minutes but asks for hours, or gives feet but asks for miles. Always check what units the answer needs!</div>
  </div>
</div>

<div class="topic" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
  <div class="topic-header">
    <div class="topic-badge" style="background:var(--psda)">4A+</div>
    <div class="topic-info"><div class="topic-title">Percentages: Increase, Decrease & Multi-Step</div><div class="topic-sub">Percent of, percent change, successive percent changes</div></div>
    <div class="topic-arrow">â–¸</div>
  </div>
  <div class="topic-body">
    <h4>Percent Basics</h4>
    <ul>
      <li><strong>Finding a percent:</strong> "What is 30% of 80?" â†’ 0.30 Ã— 80 = 24</li>
      <li><strong>Finding the whole:</strong> "40% of what number is 28?" â†’ 28 Ã· 0.40 = 70</li>
      <li><strong>Finding the percent:</strong> "12 is what percent of 48?" â†’ 12/48 = 0.25 = 25%</li>
    </ul>
    <div class="formula-box">
      <div><span class="fn">Percent Increase:</span> (new âˆ’ old) / old Ã— 100</div>
      <div><span class="fn">Percent Decrease:</span> (old âˆ’ new) / old Ã— 100</div>
      <div><span class="fn">Multiplier Shortcut:</span></div>
      <div style="color:var(--muted);font-size:.82rem">15% increase â†’ Ã— 1.15 | 20% decrease â†’ Ã— 0.80 | 8% tax â†’ Ã— 1.08</div>
    </div>
    <h4>Multi-Step Percent Trap</h4>
    <p><strong>A price goes up 20%, then down 20%. Is it back to the original?</strong></p>
    <p>NO! Start with $100: +20% = $120. Then âˆ’20% of $120 = $24 off = <strong>$96</strong>. That's 4% LESS than the original. The second percent is applied to a different base.</p>
    <div class="callout"><strong>Key Rule:</strong> Successive percent changes don't cancel! The second change applies to the NEW amount, not the original. This is one of the PSAT's favorite traps.</div>
  </div>
</div>

<!-- TOPIC 4B: Statistics -->
<div class="section">
  <div class="section-label">Topic 4B</div>
  <h2>Statistics: Center, Spread & Shape</h2>
</div>

<div class="topic open" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
  <div class="topic-header">
    <div class="topic-badge" style="background:var(--psda)">4B</div>
    <div class="topic-info"><div class="topic-title">Mean vs. Median â€” When It Matters</div><div class="topic-sub">Calculating, comparing, and predicting outlier effects</div></div>
    <div class="topic-arrow">â–¸</div>
  </div>
  <div class="topic-body">
    <div class="formula-box">
      <div><span class="fn">Mean:</span> sum of all values Ã· count</div>
      <div><span class="fn">Median:</span> middle value when sorted (average two middles if even count)</div>
    </div>
    <p><strong>The PSAT's favorite question:</strong> "A very high value is added. Which measure changes more?"</p>
    <p>Answer: The <strong>mean</strong> is always more affected. The median barely moves.</p>
    <p><strong>Example:</strong> Data: 10, 12, 14, 15, 16. Mean = 13.4, Median = 14.</p>
    <p>Add outlier (100): New mean = 27.8 (huge jump!). New median = 14.5 (tiny change).</p>
  </div>
</div>

<div class="topic" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
  <div class="topic-header">
    <div class="topic-badge" style="background:var(--psda)">4B+</div>
    <div class="topic-info"><div class="topic-title">Standard Deviation, Range & Distribution Shape</div><div class="topic-sub">Spread measures and skew â€” conceptual understanding only</div></div>
    <div class="topic-arrow">â–¸</div>
  </div>
  <div class="topic-body">
    <h4>Spread</h4>
    <ul>
      <li><strong>Range:</strong> max âˆ’ min. Simple but affected by outliers.</li>
      <li><strong>Standard deviation:</strong> How spread out values are from the mean. You won't calculate it â€” just understand:</li>
    </ul>
    <div class="formula-box">
      <div><span class="fn">Clustered tightly â†’</span> SMALL standard deviation</div>
      <div><span class="fn">Spread far apart â†’</span> LARGE standard deviation</div>
      <div><span class="fn">Adding a constant to every value:</span> Does NOT change SD</div>
      <div><span class="fn">Multiplying every value by a constant:</span> DOES change SD (by that factor)</div>
    </div>
    <h4>Distribution Shape & Skew</h4>
    <ul>
      <li><strong>Symmetric:</strong> Mean â‰ˆ Median. Bell-shaped.</li>
      <li><strong>Skewed right (positive):</strong> Long tail to the right. Mean > Median. (High values pull mean up.)</li>
      <li><strong>Skewed left (negative):</strong> Long tail to the left. Mean < Median. (Low values pull mean down.)</li>
      <li><strong>Tip:</strong> "Which direction is the skew?" â†’ look for the long tail direction.</li>
    </ul>
    <div class="callout"><strong>Common scenario:</strong> Income data is skewed right â€” a few very high earners pull the mean above the median. That's why "median household income" is more informative than "average household income."</div>
  </div>
</div>

<!-- STATISTICS EXPLORER -->
<div class="section">
  <div class="section-label">Interactive Tool</div>
  <h2>Statistics Explorer</h2>
  <p>Enter comma-separated numbers to see mean, median, range, and count update instantly. Try adding an outlier to see the effect!</p>
  <div class="stat-exp">
    <input class="stat-input" id="statInput" value="12, 15, 18, 20, 22, 25, 28" placeholder="Enter numbers separated by commasâ€¦" oninput="calcStats()">
    <div class="stat-results" id="statResults"></div>
    <div id="statInsight" style="margin-top:10px;font-size:.85rem;color:var(--muted)"></div>
  </div>
</div>

<!-- TOPIC 4C: Data Interpretation -->
<div class="section">
  <div class="section-label">Topic 4C</div>
  <h2>Scatterplots, Two-Way Tables & Probability</h2>
</div>

<div class="topic open" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
  <div class="topic-header">
    <div class="topic-badge" style="background:var(--psda)">4C</div>
    <div class="topic-info"><div class="topic-title">Scatterplots & Lines of Best Fit</div><div class="topic-sub">Correlation, regression, predictions, residuals</div></div>
    <div class="topic-arrow">â–¸</div>
  </div>
  <div class="topic-body">
    <ul>
      <li><strong>Positive correlation:</strong> As x increases, y increases (upward trend â†—)</li>
      <li><strong>Negative correlation:</strong> As x increases, y decreases (downward trend â†˜)</li>
      <li><strong>No correlation:</strong> Random scatter, no clear trend</li>
      <li><strong>Line of best fit:</strong> Slope = rate of change in context. Y-intercept = predicted value when x = 0.</li>
      <li><strong>Interpolation:</strong> Predicting WITHIN the data range (reliable)</li>
      <li><strong>Extrapolation:</strong> Predicting BEYOND the data range (unreliable â€” the trend may not continue)</li>
      <li><strong>Residuals:</strong> actual âˆ’ predicted. Good model â†’ residuals scattered randomly around zero.</li>
    </ul>
    <div class="callout-blue callout"><strong>Desmos Regression:</strong> Enter data as a table, then type <code>yâ‚ ~ mxâ‚ + b</code> for a linear regression. Desmos finds the best-fit equation automatically.</div>
  </div>
</div>

<div class="topic" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
  <div class="topic-header">
    <div class="topic-badge" style="background:var(--psda)">4C+</div>
    <div class="topic-info"><div class="topic-title">Two-Way Tables & Conditional Probability</div><div class="topic-sub">Joint, marginal, and conditional frequencies</div></div>
    <div class="topic-arrow">â–¸</div>
  </div>
  <div class="topic-body">
    <ul>
      <li><strong>Marginal frequencies:</strong> Row/column totals (the margins of the table)</li>
      <li><strong>Joint frequencies:</strong> Values inside the table (where row and column intersect)</li>
      <li><strong>Conditional probability:</strong> P(A|B) = "given B, what's the probability of A?"</li>
    </ul>
    <div class="formula-box">
      <div><span class="fn">P(A|B) =</span> (count of A AND B) / (total count of B)</div>
      <div style="color:var(--muted);font-size:.82rem">Key: Restrict to B's row/column first, then find A within it</div>
    </div>
    <div class="callout"><strong>PSAT Trap:</strong> Confusing P(A|B) with P(B|A). "Given they play sports, what's the probability they have a job?" is NOT the same as "given they have a job, what's the probability they play sports?" The denominator changes!</div>
  </div>
</div>

<!-- TOPIC 4D: Study Design -->
<div class="section">
  <div class="section-label">Topic 4D</div>
  <h2>Study Design & Statistical Inference</h2>
</div>

<div class="topic open" onclick="if(event.target.closest('.topic-body'))return;this.classList.toggle('open')">
  <div class="topic-header">
    <div class="topic-badge" style="background:var(--psda)">4D</div>
    <div class="topic-info"><div class="topic-title">Correlation vs. Causation, Sampling & Margin of Error</div><div class="topic-sub">What conclusions can we draw from data?</div></div>
    <div class="topic-arrow">â–¸</div>
  </div>
  <div class="topic-body">
    <div class="formula-box">
      <div><span class="fn">Observational study:</span> Observe without intervening â†’ correlation only</div>
      <div><span class="fn">Experiment:</span> Randomly assign treatments â†’ CAN show causation</div>
      <div><span class="fn">Survey/Sample:</span> Ask questions of a sample â†’ generalizes to population</div>
    </div>
    <h4>Critical Rules</h4>
    <ul>
      <li><strong>Correlation â‰  causation</strong> â€” just because two things happen together doesn't mean one causes the other</li>
      <li><strong>Only experiments with random assignment</strong> can establish cause and effect</li>
      <li><strong>Random sampling</strong> is needed to generalize results to a larger population</li>
      <li><strong>Larger sample â†’ smaller margin of error</strong> (more precise estimate)</li>
      <li><strong>Margin of error:</strong> "42% Â± 3%" means the true value is likely between 39% and 45%</li>
      <li><strong>Confounding variables:</strong> Other factors that could explain a relationship (ice cream sales and drownings both increase in summer â€” temperature is the confound)</li>
    </ul>
    <div class="callout"><strong>The #1 PSDA trap:</strong> A study shows students who eat breakfast score higher. Can you conclude breakfast CAUSES higher scores? <strong>NO</strong> â€” unless it's an experiment with random assignment. Students who eat breakfast may differ in many other ways.</div>
  </div>
</div>

<!-- â”€â”€ Trap Taxonomy Section â”€â”€ -->
<div class="section">
  <div class="section-label">Math Trap Taxonomy</div>
  <h2>Four Traps in Problem-Solving & Data Analysis</h2>
  <p>These traps catch students who rush through PSDA problems. Know them and you'll dodge easy-to-lose points.</p>
  <div class="trap-taxonomy">
    <div class="trap-card">
      <div class="trap-number" style="background:var(--wrong)">1</div>
      <div class="trap-card-body">
        <div class="trap-card-name">ğŸŒ€ The Percent Spiral</div>
        <div class="trap-card-desc">Applied successive percents to the original amount instead of each new amount. 20% up then 20% down â‰  original!</div>
        <div class="trap-card-example">$100 â†’ +20% = $120 â†’ âˆ’20% of $120 = $96, NOT $100</div>
      </div>
    </div>
    <div class="trap-card">
      <div class="trap-number" style="background:var(--math)">2</div>
      <div class="trap-card-body">
        <div class="trap-card-name">ğŸ¯ Wrong Target</div>
        <div class="trap-card-desc">Answered what was asked... but for the wrong group. Conditional probability â€” make sure you restricted to the right denominator!</div>
        <div class="trap-card-example">P(Math|10th) â‰  P(10th|Math). Different denominators!</div>
      </div>
    </div>
    <div class="trap-card">
      <div class="trap-number" style="background:var(--geo)">3</div>
      <div class="trap-card-body">
        <div class="trap-card-name">ğŸ“Š Scale Mirage</div>
        <div class="trap-card-desc">Misread the axis scale on a graph â€” assumed each line = 1 when it actually = 5 or 10.</div>
        <div class="trap-card-example">Bar graph shows 4 gridlines. You read 4, but scale says each = 5 â†’ actual value is 20</div>
      </div>
    </div>
    <div class="trap-card">
      <div class="trap-number" style="background:var(--advanced)">4</div>
      <div class="trap-card-body">
        <div class="trap-card-name">ğŸ”€ Conditional Swap</div>
        <div class="trap-card-desc">Confused P(A|B) with P(B|A). The condition changes which group you restrict to.</div>
        <div class="trap-card-example">P(sports|female)=40/60 â‰  P(female|sports)=40/80</div>
      </div>
    </div>
  </div>
</div>

<!-- EXERCISES -->
<div class="section"><div class="section-label">Interactive Exercise 1</div><h2>Ratio, Rate & Percent Problems</h2><p>Solve these common PSAT-style problems. Includes unit conversions and multi-step percents.</p><div class="exercise" id="ratioEx"></div></div>

<div class="section"><div class="section-label">Interactive Exercise 2</div><h2>Percent Trap Spotter</h2><p>Identify the trap in each percent problem before solving.</p><div class="exercise" style="border-color:var(--accent)" id="pctTrapEx"></div></div>

<div class="section"><div class="section-label">Interactive Exercise 3</div><h2>Two-Way Table & Probability</h2>
<p>Use this table to answer the probability questions below.</p>
<table class="tw-table">
<tr><th></th><th>Prefers Math</th><th>Prefers Science</th><th>Total</th></tr>
<tr><td><strong>9th Grade</strong></td><td>45</td><td>30</td><td>75</td></tr>
<tr><td><strong>10th Grade</strong></td><td>35</td><td>40</td><td>75</td></tr>
<tr><td><strong>Total</strong></td><td>80</td><td>70</td><td>150</td></tr>
</table>
<div class="exercise" id="probEx"></div></div>

<div class="section"><div class="section-label">Interactive Exercise 4</div><h2>Spot the Misleading Statistic</h2><p>Each scenario describes a statistical claim. Identify why it's misleading.</p><div class="exercise" style="border-color:var(--accent)" id="misleadEx"></div></div>

<div class="section"><div class="section-label">Interactive Exercise 5</div><h2>Study Design Classifier</h2><p>Observational study, experiment, or survey? And what can we conclude?</p><div class="exercise" id="studyEx"></div></div>

<div style="text-align:center;padding:24px 0">
  <button class="start-btn" onclick="goScreen(3)">Continue to Practice Questions â†’</button>
</div>
</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- SCREEN 4: TIMED PRACTICE                      -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen" id="screen-practice">
<div class="container">
  <div class="section-label">PSAT 8/9 Practice</div>
  <h2 style="font-family:'Cormorant Garamond',serif;font-size:1.6rem;margin-bottom:4px">Practice Questions</h2>
  <p style="color:var(--muted);font-size:.9rem;margin-bottom:16px">10 questions at three difficulty tiers. Tag your confidence before answering.</p>

  <div class="timer-bar" id="timerBar">
    <div class="timer-display" id="timerDisplay">--:--</div>
    <div class="timer-track"><div class="timer-fill" id="timerFill"></div></div>
    <div class="q-dots" id="qDots"></div>
    <button class="timer-toggle" id="timerToggle" onclick="toggleTimer()">â± Timer OFF</button>
  </div>

  <div id="psatPractice"></div>
  <div id="practiceResults" style="display:none"></div>

  <div id="practiceNav" style="display:none;text-align:center;padding:24px 0">
    <button class="start-btn" onclick="goScreen(4)">View Summary & Complete Module â†’</button>
  </div>
</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- SCREEN 5: MODULE COMPLETE                     -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen" id="screen-complete">
  <div class="complete-screen">
    <div class="complete-icon">ğŸ“Š</div>
    <h1>Module 4 Complete!</h1>
    <p class="complete-sub">You've conquered Problem-Solving & Data Analysis â€” the highest-ROI domain on the PSAT 8/9.</p>

    <div class="takeaway-list">
      <div style="font-weight:700;margin-bottom:12px;font-size:.85rem;color:var(--psda);text-transform:uppercase;letter-spacing:1px">Key Takeaways</div>
      <div class="takeaway-item"><span class="takeaway-check">âœ“</span> PSDA is ~15% of the test but built on skills from middle school â€” highest ROI for study time.</div>
      <div class="takeaway-item"><span class="takeaway-check">âœ“</span> Cross-multiply to solve proportions: a/b = c/d â†’ ad = bc.</div>
      <div class="takeaway-item"><span class="takeaway-check">âœ“</span> Percent multiplier shortcut: increase = Ã— (1 + rate), decrease = Ã— (1 âˆ’ rate).</div>
      <div class="takeaway-item"><span class="takeaway-check">âœ“</span> Successive percent changes don't cancel! Each change applies to the new amount.</div>
      <div class="takeaway-item"><span class="takeaway-check">âœ“</span> Mean is pulled by outliers. Median resists them. This is the PSAT's favorite stat question.</div>
      <div class="takeaway-item"><span class="takeaway-check">âœ“</span> Skewed right â†’ mean > median. Skewed left â†’ mean < median.</div>
      <div class="takeaway-item"><span class="takeaway-check">âœ“</span> Correlation â‰  causation. Only experiments with random assignment can show cause and effect.</div>
      <div class="takeaway-item"><span class="takeaway-check">âœ“</span> P(A|B): restrict to B's group first, then find A within it. Don't confuse with P(B|A).</div>
      <div class="takeaway-item"><span class="takeaway-check">âœ“</span> Larger sample â†’ smaller margin of error. Random sampling â†’ can generalize.</div>
    </div>

    <div id="completePracticeStats"></div>

    <div class="nav-cards">
      <a class="nav-card" href="module-3.html">
        <div class="nav-card-label">â† Previous</div>
        <div class="nav-card-title">Module 3: Advanced Math</div>
      </a>
      <a class="nav-card" href="module-5.html" style="border-color:var(--psda)">
        <div class="nav-card-label">Next â†’</div>
        <div class="nav-card-title">Module 5: Geometry</div>
      </a>
    </div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCREEN NAVIGATION SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SCREENS = ['screen-welcome','screen-warmup','screen-lesson','screen-practice','screen-complete'];
let currentScreen = 0;

function goScreen(idx) {
  if (idx < 0 || idx >= SCREENS.length) return;
  const cur = document.getElementById(SCREENS[currentScreen]);
  const nxt = document.getElementById(SCREENS[idx]);
  cur.classList.remove('fade-in');
  cur.classList.add('fade-out');
  setTimeout(() => {
    cur.classList.remove('active','fade-out');
    nxt.classList.add('active','fade-in');
    currentScreen = idx;
    updateProgressDots();
    window.scrollTo(0, 0);
    if (idx === 3 && timerEnabled) startTimer();
  }, 300);
}

function updateProgressDots() {
  const cont = document.getElementById('screenProgress');
  cont.innerHTML = SCREENS.map((s, i) => {
    let cls = 'screen-dot';
    if (i < currentScreen) cls += ' completed';
    if (i === currentScreen) cls += ' current';
    return `<div class="${cls}" onclick="${i <= currentScreen ? 'goScreen('+i+')' : ''}" title="${['Welcome','Warm-Up','Lesson','Practice','Complete'][i]}"></div>`;
  }).join('');
}
updateProgressDots();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RETRIEVAL WARM-UP (Module 3 content)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const WARMUP_QS = [
  {
    source: 'Module 3 â€” Exponents',
    q: 'Simplify: <code>xâ´ Â· xÂ³</code>',
    ch: ['xÂ¹Â²','xâ·','xÂ¹','7x'],
    c: 1,
    fb: 'Product rule: add exponents. xâ´âºÂ³ = xâ·.'
  },
  {
    source: 'Module 3 â€” Quadratics',
    q: 'What are the x-intercepts of <code>f(x) = (xâˆ’3)(x+5)</code>?',
    ch: ['x = 3 and x = 5','x = âˆ’3 and x = 5','x = 3 and x = âˆ’5','x = âˆ’3 and x = âˆ’5'],
    c: 2,
    fb: 'Set each factor to 0: xâˆ’3=0 â†’ x=3, x+5=0 â†’ x=âˆ’5.'
  },
  {
    source: 'Module 3 â€” Vertex Form',
    q: 'The vertex of <code>f(x) = 2(xâˆ’4)Â² + 1</code> is:',
    ch: ['(4, 1)','(âˆ’4, 1)','(4, âˆ’1)','(2, 1)'],
    c: 0,
    fb: 'Vertex form a(xâˆ’h)Â²+k â†’ vertex at (h,k) = (4,1). The sign flips!'
  },
  {
    source: 'Module 3 â€” Discriminant',
    q: 'How many real solutions does <code>xÂ² + 6x + 10 = 0</code> have?',
    ch: ['0','1','2','3'],
    c: 0,
    fb: 'bÂ²âˆ’4ac = 36âˆ’40 = âˆ’4 < 0 â†’ no real solutions.'
  },
  {
    source: 'Module 3 â€” Growth/Decay',
    q: '<code>y = 500(0.92)^t</code> represents:',
    ch: ['8% growth','92% growth','8% decay','92% decay'],
    c: 2,
    fb: 'Base 0.92 < 1 â†’ decay. Rate = 1 âˆ’ 0.92 = 0.08 = 8% per period.'
  }
];

let warmupIdx = 0;
let warmupAnswers = [];
let warmupAnswered = false;

function renderWarmup() {
  document.getElementById('warmupDots').innerHTML = WARMUP_QS.map((_, i) => {
    let cls = 'warmup-dot';
    if (i < warmupIdx) cls += warmupAnswers[i] ? ' done-correct' : ' done-wrong';
    if (i === warmupIdx && warmupIdx < WARMUP_QS.length) cls += ' active';
    return `<div class="${cls}"></div>`;
  }).join('');

  const cont = document.getElementById('warmupContent');

  if (warmupIdx >= WARMUP_QS.length) {
    const cor = warmupAnswers.filter(Boolean).length;
    cont.innerHTML = `
      <div class="warmup-summary">
        <div class="warmup-badge">Warm-Up Complete</div>
        <div class="warmup-score">${cor} / ${WARMUP_QS.length}</div>
        <p style="color:var(--muted);font-size:.9rem;margin-bottom:8px">
          ${cor === 5 ? 'Perfect recall! Module 3 knowledge is locked in.' :
            cor >= 3 ? 'Good recall! A couple of Advanced Math topics to revisit.' :
            'Some gaps from Module 3 â€” consider a quick review before continuing.'}
        </p>
        <button class="warmup-continue" onclick="goScreen(2)">Continue to Lesson â†’</button>
      </div>`;
    return;
  }

  const q = WARMUP_QS[warmupIdx];
  warmupAnswered = false;
  cont.innerHTML = `
    <div class="warmup-q">
      <div class="source-tag">From ${q.source}</div>
      <div class="q-text">${q.q}</div>
      <div class="warmup-choices" id="warmupChoices">
        ${q.ch.map((ch, ci) => `<div class="warmup-choice" onclick="answerWarmup(${ci})">${ch}</div>`).join('')}
      </div>
      <div id="warmupFb" style="display:none"></div>
    </div>`;
}

function answerWarmup(ci) {
  if (warmupAnswered) return;
  warmupAnswered = true;
  const q = WARMUP_QS[warmupIdx];
  const correct = ci === q.c;
  warmupAnswers.push(correct);

  const choices = document.querySelectorAll('.warmup-choice');
  choices.forEach((ch, i) => {
    ch.classList.add('wu-dis');
    if (i === q.c) ch.classList.add('wu-correct');
    else if (i === ci && !correct) ch.classList.add('wu-wrong');
  });

  const fb = document.getElementById('warmupFb');
  fb.style.display = 'block';
  fb.innerHTML = `<div class="warmup-fb">${correct ? 'âœ“ ' : 'âœ— '}${q.fb}</div>
    <button class="warmup-next" onclick="warmupIdx++;renderWarmup()">
      ${warmupIdx < WARMUP_QS.length - 1 ? 'Next Question â†’' : 'See Results â†’'}
    </button>`;

  document.getElementById('warmupDots').innerHTML = WARMUP_QS.map((_, i) => {
    let cls = 'warmup-dot';
    if (i < warmupAnswers.length) cls += warmupAnswers[i] ? ' done-correct' : ' done-wrong';
    else if (i === warmupIdx + 1) cls += ' active';
    return `<div class="${cls}"></div>`;
  }).join('');
}

renderWarmup();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GENERIC HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function mkSc(c,t){return `<div class="score-bar"><div class="score-bar-label">Score</div><div class="score-bar-track"><div class="score-bar-fill" style="width:${t?c/t*100:0}%"></div></div><div class="score-bar-val">${c}/${t}</div></div>`;}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATISTICS EXPLORER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function calcStats(){
  const raw=document.getElementById('statInput').value;
  const nums=raw.split(',').map(s=>parseFloat(s.trim())).filter(n=>!isNaN(n));
  const el=document.getElementById('statResults');
  const ins=document.getElementById('statInsight');
  if(nums.length===0){el.innerHTML='';ins.textContent='';return;}
  nums.sort((a,b)=>a-b);
  const n=nums.length;
  const sum=nums.reduce((a,b)=>a+b,0);
  const mean=sum/n;
  const median=n%2===1?nums[Math.floor(n/2)]:(nums[n/2-1]+nums[n/2])/2;
  const range=nums[n-1]-nums[0];
  el.innerHTML=[
    {l:'Count',v:n,c:'var(--math)'},
    {l:'Mean',v:mean.toFixed(1),c:'var(--psda)'},
    {l:'Median',v:median.toFixed(1),c:'var(--correct)'},
    {l:'Range',v:range.toFixed(1),c:'var(--geo)'}
  ].map(s=>`<div class="stat-card"><div class="stat-label">${s.l}</div><div class="stat-val" style="color:${s.c}">${s.v}</div></div>`).join('');
  const diff=Math.abs(mean-median);
  if(diff>2)ins.textContent=`Mean and median differ by ${diff.toFixed(1)} â€” the data may be skewed ${mean>median?'right (high outliers pull mean up)':'left (low outliers pull mean down)'}.`;
  else ins.textContent='Mean â‰ˆ Median â€” the data looks roughly symmetric. Try adding an extreme value like 200!';
}
calcStats();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXERCISE 1: Ratio, Rate & Percent
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const RAT=[
  {p:'A recipe needs 3 cups of flour for every 2 cups of sugar. If you use 9 cups of flour, how many cups of sugar?',a:6,s:'3/2 = 9/x â†’ 3x = 18 â†’ x = 6.',t:1},
  {p:'A car travels 180 miles in 3 hours. What is its speed in miles per hour?',a:60,s:'180 Ã· 3 = 60 mph.',t:1},
  {p:'Convert 5 hours to minutes.',a:300,s:'5 Ã— 60 = 300 minutes.',t:1},
  {p:'A shirt costs $40 and is 25% off. What is the sale price?',a:30,s:'$40 Ã— 0.75 = $30. Or: 25% of $40 = $10 off.',t:1},
  {p:'A population grows from 200 to 250. What is the percent increase?',a:25,s:'(250âˆ’200)/200 Ã— 100 = 25%.',t:2},
  {p:'If 40% of a number is 28, what is the number?',a:70,s:'0.40n = 28 â†’ n = 70.',t:2},
  {p:'A store raises prices 10%, then raises again by 10%. A shirt was originally $50. What is the final price?',a:60.5,s:'$50 Ã— 1.10 = $55. Then $55 Ã— 1.10 = $60.50. NOT $50 Ã— 1.20!',t:2},
  {p:'Convert 88 feet per second to miles per hour. (5280 ft = 1 mi, 3600 sec = 1 hr)',a:60,s:'88 Ã— 3600/5280 = 88 Ã— 0.6818 = 60 mph.',t:3},
];
function renderRat(){
  document.getElementById('ratioEx').innerHTML='<h3>ğŸ“Š Ratios, Rates & Percents</h3><div class="exercise-sub">Solve each. Round to one decimal if needed.</div>'+
    RAT.map((q,i)=>`<div class="ex-item"><div style="margin-bottom:4px"><span class="tier tier-${q.t}">${q.t===1?'Easy':q.t===2?'Medium':'Hard'}</span></div><div class="ex-prompt">${q.p}</div><div class="ex-input-row"><span style="font-size:.85rem;color:var(--muted)">= </span><input class="ex-input" type="number" step="any" id="rat${i}" placeholder="?"><button class="ex-btn" onclick="chkRat(${i})">Check</button></div><div class="ex-fb" id="ratFb${i}"></div></div>`).join('');
}
function chkRat(i){
  var v=parseFloat(document.getElementById('rat'+i).value),fb=document.getElementById('ratFb'+i),q=RAT[i];
  if(isNaN(v)){fb.className='ex-fb show wrong';fb.textContent='Enter a number.';return;}
  var ok=Math.abs(v-q.a)<0.6;
  fb.className='ex-fb show '+(ok?'correct':'wrong');
  fb.textContent=(ok?'âœ“ Correct! ':'âœ— Not quite. ')+q.s;
}
renderRat();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXERCISE 2: Percent Trap Spotter
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const PCT=[
  {q:'A price goes up 20%, then down 20%. Is the final price equal to the original?',opts:['Yes, they cancel out','No, it\'s 4% less','No, it\'s 4% more','Depends on the price'],c:1,fb:'Start $100: +20% = $120. âˆ’20% of $120 = $24 off = $96. That\'s 4% less. The second percent applies to the NEW amount.'},
  {q:'A store advertises "50% off, then an additional 20% off." Is that the same as 70% off?',opts:['Yes, 50+20=70','No, it\'s only 60% off total','No, it\'s 56% off total','Depends on original price'],c:1,fb:'Start $100: 50% off = $50. Then 20% off $50 = $10 off = $40. Total discount = 60%, not 70%.'},
  {q:'"Sales increased 200%." If original sales were $1,000, what are they now?',opts:['$2,000','$3,000','$200,000','$1,200'],c:1,fb:'200% INCREASE means the increase is $2,000. New total = $1,000 + $2,000 = $3,000. A 200% increase triples the original.'},
  {q:'A student got 80% on Test 1 and 90% on Test 2. Is their overall average 85%?',opts:['Yes, always','Only if both tests have the same number of questions','Only if Test 2 was harder','Never'],c:1,fb:'Only if tests have equal weight (same number of questions/points). If Test 1 had 50 questions and Test 2 had 10, the average would be much closer to 80%.'},
];
var pctA={};
function renderPct(){
  document.getElementById('pctTrapEx').innerHTML='<h3>ğŸ¯ Percent Traps</h3><div class="exercise-sub">Identify the correct answer â€” these are the traps PSAT loves.</div>'+
    PCT.map(function(q,i){var a=pctA[i],h=a!==undefined;
      return '<div class="ex-item"><div class="ex-prompt">'+q.q+'</div><div class="classify-opts">'+q.opts.map(function(o,oi){var c='classify-opt';if(h){c+=' cl-dis';if(oi===q.c)c+=' cl-correct';else if(oi===a)c+=' cl-wrong';}return '<div class="'+c+'" onclick="aPct('+i+','+oi+')">'+o+'</div>';}).join('')+'</div><div class="ex-fb'+(h?' show':'')+(h?(a===q.c?' correct':' wrong'):'')+'">'+((h)?((a===q.c?'âœ“ ':'âœ— ')+q.fb):'')+'</div></div>';
    }).join('');
}
function aPct(i,v){if(pctA[i]!==undefined)return;pctA[i]=v;renderPct();}
renderPct();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXERCISE 3: Two-way table
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const PRB=[
  {q:'What is P(prefers Math)?',ch:['45/150','80/150','45/75','35/75'],c:1,fb:'Total who prefer Math = 80. Total = 150. P = 80/150 â‰ˆ 0.533.'},
  {q:'What is P(9th grader AND prefers Science)?',ch:['30/150','30/75','30/70','70/150'],c:0,fb:'9th + Science = 30. Total = 150. P = 30/150 = 1/5.'},
  {q:'What is P(prefers Math | 10th grader)?',ch:['35/150','35/80','35/75','80/150'],c:2,fb:'Restrict to 10th graders (75). Of those, 35 prefer Math. P = 35/75.'},
  {q:'What is P(9th grader | prefers Science)?',ch:['30/150','30/75','30/70','75/150'],c:2,fb:'Restrict to Science-preferrers (70). Of those, 30 are 9th grade. P = 30/70.'},
  {q:'Is a 10th grader more likely to prefer Science than a 9th grader?',ch:['Yes: 40/75 > 30/75','No: 30/75 > 40/75','Equal likelihood','Cannot determine'],c:0,fb:'10th: 40/75 â‰ˆ 53% prefer Science. 9th: 30/75 = 40%. So yes, 10th graders prefer Science more.'},
];
var prbA={};
function renderPrb(){
  document.getElementById('probEx').innerHTML='<h3>ğŸ² Probability Practice</h3><div class="exercise-sub">Use the table above.</div>'+
    PRB.map(function(q,i){var a=prbA[i],h=a!==undefined;
      return '<div class="ex-item"><div class="ex-prompt">'+q.q+'</div><div class="mc-choices">'+q.ch.map(function(ch,ci){var c='mc-choice';if(h){c+=' mc-dis';if(ci===q.c)c+=' mc-correct';else if(ci===a)c+=' mc-wrong';}return '<div class="'+c+'" onclick="aPrb('+i+','+ci+')"><div class="mc-letter">'+'ABCD'[ci]+'</div><div>'+ch+'</div></div>';}).join('')+'</div><div class="mc-fb'+(h?' show':'')+'">'+(h?((a===q.c?'âœ“ Correct! ':'âœ— Incorrect. ')+q.fb):'')+'</div></div>';
    }).join('');
}
function aPrb(i,v){if(prbA[i]!==undefined)return;prbA[i]=v;renderPrb();}
renderPrb();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXERCISE 4: Misleading Stats
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const MIS=[
  {q:'A news article says: "Students who drink coffee score 15% higher on tests" and recommends coffee before exams.',opts:['Correlation treated as causation','Sample too small','Data is fabricated','No issue'],c:0,fb:'Observational finding. Coffee drinkers may differ in other ways. Only an experiment could show causation.'},
  {q:'A survey of 50 math club members found 90% enjoy math. The paper reports: "90% of students enjoy math."',opts:['Biased (non-random) sample','Too many participants','Wrong percentage','Margin of error too small'],c:0,fb:'Math club members aren\'t representative of all students. Biased sample â†’ can\'t generalize.'},
  {q:'Average salary at a company is $95,000. A new hire expects ~$95K. But 90% earn $50Kâ€“$70K while the CEO earns $2M.',opts:['Mean pulled by outlier','Median is wrong','Sample too small','Data is outdated'],c:0,fb:'The CEO\'s salary (outlier) pulls the mean way up. Median salary would be ~$60K â€” much more representative.'},
  {q:'A study of 25 people found a supplement improved memory by 3%. Researchers call it "a breakthrough."',opts:['Sample too small for reliable conclusions','Effect is too large','Should use median','Study is well-designed'],c:0,fb:'25 participants is too few. A 3% difference could easily be random variation. Need a much larger sample.'},
];
var misA={};
function renderMis(){
  document.getElementById('misleadEx').innerHTML='<h3>ğŸ” Spot the Problem</h3><div class="exercise-sub">What makes each claim misleading?</div>'+
    MIS.map(function(q,i){var a=misA[i],h=a!==undefined;
      return '<div class="ex-item"><div class="ex-prompt">'+q.q+'</div><div class="classify-opts">'+q.opts.map(function(o,oi){var c='classify-opt';if(h){c+=' cl-dis';if(oi===q.c)c+=' cl-correct';else if(oi===a)c+=' cl-wrong';}return '<div class="'+c+'" onclick="aMis('+i+','+oi+')">'+o+'</div>';}).join('')+'</div><div class="ex-fb'+(h?' show':'')+(h?(a===q.c?' correct':' wrong'):'')+'">'+((h)?((a===q.c?'âœ“ ':'âœ— ')+q.fb):'')+'</div></div>';
    }).join('');
}
function aMis(i,v){if(misA[i]!==undefined)return;misA[i]=v;renderMis();}
renderMis();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXERCISE 5: Study Design
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const STD=[
  {q:'Researchers randomly assign 100 patients to a new drug or placebo, then measure blood pressure after 8 weeks.',opts:['Observational','Experiment','Survey'],c:1,fb:'Random assignment â†’ experiment â†’ CAN establish causation.'},
  {q:'A university surveys 500 randomly selected alumni about career satisfaction.',opts:['Observational','Experiment','Survey'],c:2,fb:'Just asking questions â†’ survey. Random selection â†’ results generalize to all alumni.'},
  {q:'Researchers track 1,000 people for 10 years, recording exercise habits and heart disease rates.',opts:['Observational','Experiment','Survey'],c:0,fb:'No intervention â†’ observational. Can show correlation but NOT causation.'},
  {q:'A teacher puts half the class in quiet rooms and half in noisy rooms, then compares test scores.',opts:['Observational','Experiment','Survey'],c:1,fb:'Assigned conditions â†’ experiment. Can show whether noise causes score changes.'},
  {q:'A newspaper finds cities with more ice cream shops have higher crime rates.',opts:['Observational','Experiment','Survey'],c:0,fb:'Analyzing existing data â†’ observational. Confounding variable: population size (or temperature).'},
];
var stdA={};
function renderStd(){
  document.getElementById('studyEx').innerHTML='<h3>ğŸ”¬ Classify the Study</h3><div class="exercise-sub">What type and what can we conclude?</div>'+
    STD.map(function(q,i){var a=stdA[i],h=a!==undefined;
      return '<div class="ex-item"><div class="ex-prompt">'+q.q+'</div><div class="classify-opts">'+q.opts.map(function(o,oi){var c='classify-opt';if(h){c+=' cl-dis';if(oi===q.c)c+=' cl-correct';else if(oi===a)c+=' cl-wrong';}return '<div class="'+c+'" onclick="aStd('+i+','+oi+')">'+o+'</div>';}).join('')+'</div><div class="ex-fb'+(h?' show':'')+(h?(a===q.c?' correct':' wrong'):'')+'">'+((h)?((a===q.c?'âœ“ ':'âœ— ')+q.fb):'')+'</div></div>';
    }).join('');
}
function aStd(i,v){if(stdA[i]!==undefined)return;stdA[i]=v;renderStd();}
renderStd();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TIMED PRACTICE WITH CONFIDENCE & ERROR ANALYSIS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const PST=[
  {t:1,tp:'4A',q:'A car travels 180 miles in 3 hours. What is its average speed?',ch:['45 mph','54 mph','60 mph','90 mph'],c:2,fb:'180 Ã· 3 = 60 mph.',
   trap:null,trapAnswer:3,trapDesc:'90mph would be 180Ã·2 hours, not Ã·3'},
  {t:1,tp:'4A',q:'What is 15% of 240?',ch:['24','36','48','60'],c:1,fb:'0.15 Ã— 240 = 36.',
   trap:null,trapAnswer:0,trapDesc:'24 is 10% of 240 â€” used wrong percentage'},
  {t:1,tp:'4B',q:'The median of {3, 7, 9, 12, 15} is:',ch:['7','9','9.2','12'],c:1,fb:'5 values â†’ middle (3rd) value = 9.',
   trap:null,trapAnswer:2,trapDesc:'9.2 is the mean, not the median'},
  {t:1,tp:'4A',q:'If boys to girls is 3:5 and there are 24 boys, how many girls?',ch:['30','35','40','45'],c:2,fb:'3/5 = 24/g â†’ g = 40.',
   trap:null,trapAnswer:2,trapDesc:'Cross-multiply correctly: 3g=5Ã—24=120, g=40 is correct'},
  {t:2,tp:'4A',q:'A store raises prices 20% then gives 20% off. Compared to original, the final price is:',ch:['The same','4% less','4% more','20% less'],c:1,fb:'$100 â†’ $120 â†’ $96. 4% less.',
   trap:'percent_spiral',trapAnswer:0,trapDesc:'Assumed +20% then âˆ’20% cancel out â€” The Percent Spiral'},
  {t:2,tp:'4B',q:'Data set A: SD = 3.2. Data set B: SD = 8.7. Which has more spread?',ch:['A','B','Equal','Cannot tell'],c:1,fb:'Higher SD = more spread. B is more variable.',
   trap:null,trapAnswer:0,trapDesc:'Picked A (lower SD) â€” SD means spread, higher = more spread'},
  {t:2,tp:'4C',q:'A negative linear association in a scatterplot means:',ch:['As x increases, y increases','As x increases, y decreases','No relationship','y is always negative'],c:1,fb:'Negative association: x up â†’ y down.',
   trap:null,trapAnswer:0,trapDesc:'Confused positive and negative association'},
  {t:2,tp:'4C',q:'P(plays sports | female) = 40/60 means:',ch:['40% of all students play sports','40 of 60 females play sports','60 of 40 play sports','40% are female'],c:1,fb:'Given female (60 total), 40 play sports.',
   trap:'conditional_swap',trapAnswer:3,trapDesc:'Misread the conditional â€” The Conditional Swap'},
  {t:3,tp:'4D',q:'A study finds countries with more doctors have lower infant mortality. Valid conclusion:',ch:['More doctors cause lower mortality','More doctors are associated with lower mortality','Infant mortality causes fewer doctors','No relationship'],c:1,fb:'Observational â†’ association only. Wealth may explain both.',
   trap:null,trapAnswer:0,trapDesc:'Claimed causation from observational data'},
  {t:3,tp:'4D',q:'A survey of 400 voters finds 52% support a policy (margin of error Â±4%). Best interpretation:',ch:['Exactly 52% of all voters agree','Between 48%â€“56% of all voters likely agree','Survey is unreliable','52% is the exact population value'],c:1,fb:'52% Â± 4% â†’ true value likely between 48% and 56%.',
   trap:null,trapAnswer:0,trapDesc:'Treated sample statistic as exact population parameter'},
];

let pstA = {};
let pstConf = {};
let pstTime = {};
let pstStartTime = null;

// Timer system
let timerEnabled = false;
let timerInterval = null;
let timerSeconds = 0;
const SECS_PER_Q = 95;
let totalTimerSecs = PST.length * SECS_PER_Q;

function toggleTimer() {
  timerEnabled = !timerEnabled;
  const btn = document.getElementById('timerToggle');
  btn.textContent = timerEnabled ? 'â± Timer ON' : 'â± Timer OFF';
  btn.classList.toggle('active', timerEnabled);
  if (!timerEnabled && timerInterval) {
    clearInterval(timerInterval);
    timerInterval = null;
    document.getElementById('timerDisplay').textContent = '--:--';
    document.getElementById('timerFill').style.width = '100%';
  } else if (timerEnabled && currentScreen === 3) {
    startTimer();
  }
}

function startTimer() {
  if (timerInterval) clearInterval(timerInterval);
  timerSeconds = totalTimerSecs;
  updateTimerDisplay();
  timerInterval = setInterval(() => {
    timerSeconds--;
    updateTimerDisplay();
    if (timerSeconds <= 0) {
      clearInterval(timerInterval);
      timerInterval = null;
    }
  }, 1000);
  pstStartTime = Date.now();
}

function updateTimerDisplay() {
  const disp = document.getElementById('timerDisplay');
  const fill = document.getElementById('timerFill');
  const mins = Math.floor(timerSeconds / 60);
  const secs = timerSeconds % 60;
  disp.textContent = `${mins}:${secs.toString().padStart(2, '0')}`;

  const pct = (timerSeconds / totalTimerSecs) * 100;
  fill.style.width = pct + '%';

  disp.className = 'timer-display';
  fill.className = 'timer-fill';
  if (pct < 15) { disp.classList.add('danger'); fill.classList.add('danger'); }
  else if (pct < 35) { disp.classList.add('warning'); fill.classList.add('warning'); }
}

function renderPST() {
  const answered = Object.keys(pstA).length;
  const TRAP_NAMES = {'percent_spiral':'ğŸŒ€ Percent Spiral','wrong_target':'ğŸ¯ Wrong Target','scale_mirage':'ğŸ“Š Scale Mirage','conditional_swap':'ğŸ”€ Conditional Swap'};

  document.getElementById('qDots').innerHTML = PST.map((_, i) => {
    let cls = 'q-dot';
    if (pstA[i] !== undefined) cls += pstA[i] === PST[i].c ? ' correct' : ' wrong';
    return `<div class="${cls}"></div>`;
  }).join('');

  document.getElementById('psatPractice').innerHTML = PST.map((q, i) => {
    const a = pstA[i], h = a !== undefined;
    const conf = pstConf[i];
    const tierLabel = q.t === 1 ? 'Easy' : q.t === 2 ? 'Medium' : 'Hard';
    const trapName = q.trap ? TRAP_NAMES[q.trap] || '' : '';

    return `<div class="ex-item" style="border-color:${q.t===1?'var(--algebra)':q.t===2?'var(--math)':'var(--advanced)'}">
      <div style="margin-bottom:6px;display:flex;align-items:center;gap:8px;flex-wrap:wrap">
        <span class="tier tier-${q.t}">${tierLabel}</span>
        <span style="font-size:.75rem;color:var(--muted)">Topic ${q.tp}</span>
        ${trapName && h ? `<span style="font-size:.72rem;color:var(--accent)">Trap: ${trapName}</span>` : ''}
      </div>
      <div class="ex-prompt">${q.q}</div>
      ${!h ? `<div class="confidence-row">
        <div class="conf-tag ${conf==='guessing'?'selected':''}" data-conf="guessing" onclick="setConf(${i},'guessing')">Guessing</div>
        <div class="conf-tag ${conf==='unsure'?'selected':''}" data-conf="unsure" onclick="setConf(${i},'unsure')">Unsure</div>
        <div class="conf-tag ${conf==='confident'?'selected':''}" data-conf="confident" onclick="setConf(${i},'confident')">Confident</div>
      </div>` : `<div style="font-size:.72rem;color:var(--muted);margin-bottom:6px">Confidence: ${conf || 'not tagged'}</div>`}
      <div class="mc-choices">${q.ch.map((ch, ci) => {
        let c = 'mc-choice';
        if (h) { c += ' mc-dis'; if (ci === q.c) c += ' mc-correct'; else if (ci === a) c += ' mc-wrong'; }
        return `<div class="${c}" onclick="aPST(${i},${ci})"><div class="mc-letter">${'ABCD'[ci]}</div><div>${ch}</div></div>`;
      }).join('')}</div>
      <div class="mc-fb${h ? ' show' : ''}">${h ? (a === q.c ? 'âœ“ Correct! ' : 'âœ— Incorrect. ') + q.fb + (a !== q.c && a === q.trapAnswer ? '<br><span style="color:var(--psda)">âš ï¸ ' + q.trapDesc + '</span>' : '') : ''}</div>
    </div>`;
  }).join('');

  if (answered === PST.length) {
    if (timerInterval) { clearInterval(timerInterval); timerInterval = null; }
    document.getElementById('practiceNav').style.display = 'block';
    showPracticeResults();
  }
}

function setConf(i, level) {
  if (pstA[i] !== undefined) return;
  pstConf[i] = level;
  renderPST();
}

function aPST(i, v) {
  if (pstA[i] !== undefined) return;
  pstA[i] = v;
  if (pstStartTime) {
    pstTime[i] = Date.now() - pstStartTime;
    pstStartTime = Date.now();
  }
  renderPST();
}

function showPracticeResults() {
  const total = PST.length;
  const correct = Object.entries(pstA).filter(([i, v]) => v === PST[i].c).length;

  const byDiff = {1:{cor:0,tot:0},2:{cor:0,tot:0},3:{cor:0,tot:0}};
  PST.forEach((q, i) => {
    byDiff[q.t].tot++;
    if (pstA[i] === q.c) byDiff[q.t].cor++;
  });

  const matrix = {};
  ['guessing','unsure','confident'].forEach(conf => {
    matrix[conf] = {correct:[], wrong:[]};
  });
  PST.forEach((q, i) => {
    const conf = pstConf[i] || 'unsure';
    const isCorrect = pstA[i] === q.c;
    matrix[conf][isCorrect ? 'correct' : 'wrong'].push(i);
  });

  const errors = {content_gap:[], trap_answer:[], careless:[], calibration:[]};
  PST.forEach((q, i) => {
    if (pstA[i] === q.c) return;
    const conf = pstConf[i] || 'unsure';
    if (pstA[i] === q.trapAnswer) {
      errors.trap_answer.push({i, desc:q.trapDesc, topic:q.tp});
    } else {
      errors.content_gap.push({i, topic:q.tp});
    }
    if (conf === 'confident') {
      if (q.t === 1) errors.careless.push({i, topic:q.tp});
      errors.calibration.push({i, topic:q.tp});
    }
  });

  let html = `<div class="results-section">
    <h3>ğŸ“Š Practice Results: ${correct}/${total}</h3>

    <div style="margin-bottom:20px">
      <div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:8px">By Difficulty</div>
      <div class="difficulty-bars">
        <div class="diff-row">
          <span class="diff-label" style="color:var(--algebra)">Easy</span>
          <div class="diff-track"><div class="diff-fill" style="width:${byDiff[1].tot?byDiff[1].cor/byDiff[1].tot*100:0}%;background:var(--algebra)"></div></div>
          <span class="diff-val" style="color:var(--algebra)">${byDiff[1].cor}/${byDiff[1].tot}</span>
        </div>
        <div class="diff-row">
          <span class="diff-label" style="color:var(--math)">Medium</span>
          <div class="diff-track"><div class="diff-fill" style="width:${byDiff[2].tot?byDiff[2].cor/byDiff[2].tot*100:0}%;background:var(--math)"></div></div>
          <span class="diff-val" style="color:var(--math)">${byDiff[2].cor}/${byDiff[2].tot}</span>
        </div>
        <div class="diff-row">
          <span class="diff-label" style="color:var(--advanced)">Hard</span>
          <div class="diff-track"><div class="diff-fill" style="width:${byDiff[3].tot?byDiff[3].cor/byDiff[3].tot*100:0}%;background:var(--advanced)"></div></div>
          <span class="diff-val" style="color:var(--advanced)">${byDiff[3].cor}/${byDiff[3].tot}</span>
        </div>
      </div>
    </div>`;

  html += `<div style="margin-bottom:20px">
    <div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:8px">Confidence Ã— Accuracy Matrix</div>
    <div class="results-grid">
      <div class="results-grid-header"></div>
      <div class="results-grid-header">Guessing</div>
      <div class="results-grid-header">Unsure</div>
      <div class="results-grid-header">Confident</div>

      <div class="results-grid-header" style="writing-mode:horizontal-tb">âœ“ Correct</div>
      <div class="results-grid-cell">
        <div class="cell-label">Lucky</div>
        <div class="cell-dots">${matrix.guessing.correct.map(()=>`<div class="cell-dot" style="background:var(--psda)"></div>`).join('')}</div>
        <div style="font-size:.7rem;color:var(--muted)">${matrix.guessing.correct.length}</div>
      </div>
      <div class="results-grid-cell">
        <div class="cell-label">Developing</div>
        <div class="cell-dots">${matrix.unsure.correct.map(()=>`<div class="cell-dot" style="background:var(--math)"></div>`).join('')}</div>
        <div style="font-size:.7rem;color:var(--muted)">${matrix.unsure.correct.length}</div>
      </div>
      <div class="results-grid-cell">
        <div class="cell-label">Solid</div>
        <div class="cell-dots">${matrix.confident.correct.map(()=>`<div class="cell-dot" style="background:var(--correct)"></div>`).join('')}</div>
        <div style="font-size:.7rem;color:var(--muted)">${matrix.confident.correct.length}</div>
      </div>

      <div class="results-grid-header" style="writing-mode:horizontal-tb">âœ— Wrong</div>
      <div class="results-grid-cell">
        <div class="cell-label">Expected</div>
        <div class="cell-dots">${matrix.guessing.wrong.map(()=>`<div class="cell-dot" style="background:var(--muted)"></div>`).join('')}</div>
        <div style="font-size:.7rem;color:var(--muted)">${matrix.guessing.wrong.length}</div>
      </div>
      <div class="results-grid-cell">
        <div class="cell-label">Needs work</div>
        <div class="cell-dots">${matrix.unsure.wrong.map(()=>`<div class="cell-dot" style="background:var(--psda)"></div>`).join('')}</div>
        <div style="font-size:.7rem;color:var(--muted)">${matrix.unsure.wrong.length}</div>
      </div>
      <div class="results-grid-cell danger-cell">
        <div class="cell-label" style="color:var(--wrong);font-weight:700">âš ï¸ DANGER</div>
        <div class="cell-dots">${matrix.confident.wrong.map(()=>`<div class="cell-dot" style="background:var(--wrong)"></div>`).join('')}</div>
        <div style="font-size:.7rem;color:var(--wrong)">${matrix.confident.wrong.length}</div>
      </div>
    </div>
    ${matrix.confident.wrong.length > 0 ? '<div class="callout" style="border-color:var(--wrong);background:var(--wrong-bg)"><strong style="color:var(--wrong)">Confident + Wrong</strong> is the most dangerous category. These errors persist into test day because you won\'t self-correct what you think you already know.</div>' : ''}
  </div>`;

  const hasErrors = errors.trap_answer.length + errors.content_gap.length > 0;
  if (hasErrors) {
    html += `<div style="margin-bottom:16px">
      <div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:8px">Error Pattern Analysis</div>`;

    if (errors.trap_answer.length > 0) {
      html += `<div class="error-category" style="background:rgba(251,191,36,.08);border:1px solid rgba(251,191,36,.3)">
        <div class="error-label" style="color:var(--psda)">ğŸŸ¡ Trap Answers (${errors.trap_answer.length})</div>
        <div class="error-items">${errors.trap_answer.map(e => e.desc).join(' Â· ')}</div>
      </div>`;
    }
    if (errors.content_gap.length > 0) {
      html += `<div class="error-category" style="background:rgba(239,68,68,.08);border:1px solid rgba(239,68,68,.3)">
        <div class="error-label" style="color:var(--wrong)">ğŸ”´ Content Gaps (${errors.content_gap.length})</div>
        <div class="error-items">Topics: ${[...new Set(errors.content_gap.map(e=>e.topic))].join(', ')}</div>
      </div>`;
    }
    if (errors.careless.length > 0) {
      html += `<div class="error-category" style="background:rgba(96,165,250,.08);border:1px solid rgba(96,165,250,.3)">
        <div class="error-label" style="color:var(--math)">ğŸ”µ Possible Careless Errors (${errors.careless.length})</div>
        <div class="error-items">Confident + wrong on easy questions â€” likely arithmetic mistakes</div>
      </div>`;
    }
    if (errors.calibration.length > 0) {
      html += `<div class="error-category" style="background:rgba(239,68,68,.08);border:1px solid rgba(239,68,68,.3)">
        <div class="error-label" style="color:var(--wrong)">âš ï¸ Calibration Issues (${errors.calibration.length})</div>
        <div class="error-items">You were confident but wrong â€” review these topics carefully</div>
      </div>`;
    }
    html += `</div>`;
  }

  html += `</div>`;
  document.getElementById('practiceResults').style.display = 'block';
  document.getElementById('practiceResults').innerHTML = html;

  document.getElementById('completePracticeStats').innerHTML = `
    <div style="background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:16px 20px;margin-bottom:24px;max-width:500px;width:100%;text-align:left">
      <div style="font-size:.78rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin-bottom:8px">Practice Results</div>
      <div style="font-family:'JetBrains Mono',monospace;font-size:1.4rem;font-weight:700;color:var(--correct);margin-bottom:8px">${correct}/${total} correct</div>
      <div style="font-size:.82rem;color:var(--muted)">
        Easy: ${byDiff[1].cor}/${byDiff[1].tot} Â· Medium: ${byDiff[2].cor}/${byDiff[2].tot} Â· Hard: ${byDiff[3].cor}/${byDiff[3].tot}
      </div>
    </div>`;
}

renderPST();
</script>
<script src="/translate.js"></script>
</body>
</html>
